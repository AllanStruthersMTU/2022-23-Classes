(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33176,        951]
NotebookOptionsPosition[     30955,        907]
NotebookOutlinePosition[     31410,        925]
CellTagsIndexPosition[     31367,        922]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Krylov Methods for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "x"}], "=", "b"}], TraditionalForm]],ExpressionUUID->
  "1880a565-949b-4695-816a-86206a255fab"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"n", "\[Times]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "c3d8bc88-7a2d-4c17-bace-574f6b4eea7f"],
 "\nNotation from Saad"
}], "Title",
 CellChangeTimes->{{3.8396701006237125`*^9, 3.839670101611764*^9}, {
  3.840102229200081*^9, 3.840102242729333*^9}, {3.8405293276271477`*^9, 
  3.840529378894744*^9}, {3.840622073686349*^9, 3.84062207418674*^9}, {
  3.8732798196159916`*^9, 3.873279897624705*^9}, {3.8738951484624486`*^9, 
  3.8738951506059637`*^9}},ExpressionUUID->"5d4a0142-ee91-4c83-922a-\
c35d53e8e7aa"],

Cell[TextData[{
 "A Krylov space is constructed by repeatedly acting on a n vector v with an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "n"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "08be454d-da14-48f9-8714-0b59d8073cf7"],
 " matrix A. This construction ensures that Krylov spaces are rich in \
eigenvectors associated with large eigenvalues.  It is convenient to have an \
orthogonal basis for any subspace in linear algebra.  Arnoldi is a specific \
algorithm which generates orthogonal bases for nested Krylov spaces: it \
underlies almost all Krylov based algorithms.  The Krylov space means \
polynomials are a very useful analytical tool for Krylov based iterative \
solvers. "
}], "Text",
 CellChangeTimes->{{3.8738951577858505`*^9, 3.87389536992034*^9}, {
  3.873895409399355*^9, 
  3.8738955872220716`*^9}},ExpressionUUID->"b711d88b-e12a-4f68-bc25-\
d265788e57b4"],

Cell[CellGroupData[{

Cell["Krylov", "Section",
 CellChangeTimes->{{3.87389561043328*^9, 
  3.873895612344222*^9}},ExpressionUUID->"9edded53-1c71-466b-a2cd-\
52c8807dede1"],

Cell[TextData[{
 "The Krylov space\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
     RowBox[{"A", ",", "v"}], ")"}], "=", 
    RowBox[{"span", "(", 
     RowBox[{"v", ",", 
      RowBox[{"A", ".", "v"}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SuperscriptBox["A", 
        RowBox[{"m", "-", "1"}]], ".", "v"}]}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "906216f5-0297-45dd-b09e-6a961d8eef6b"],
 "\ndefines a nested ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "0"], "(", 
     RowBox[{"A", ",", "v"}], ")"}], "\[SubsetEqual]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalK]", "1"], "(", 
      RowBox[{"A", ",", "v"}], ")"}], "\[Ellipsis]"}], "\[SubsetEqual]", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", 
      RowBox[{"m", "-", "1"}]], "(", 
     RowBox[{"A", ",", "v"}], ")"}], "\[SubsetEqual]", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
     RowBox[{"A", ",", "v"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "35e4b31f-6ed1-4799-b7f5-c63e5b8a45b6"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"dim", "(", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
      RowBox[{"A", ",", "v"}], ")"}], ")"}], "=", "m"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1eadf4a0-0486-4798-b66e-b7a43f0018c8"],
 " generically.  "
}], "Text",
 CellChangeTimes->{{3.87389562774994*^9, 3.873896119856448*^9}, {
  3.873896174348611*^9, 3.87389619591916*^9}, {3.8738962264290075`*^9, 
  3.8738962569045553`*^9}, {3.8738986107569942`*^9, 
  3.87389863376964*^9}},ExpressionUUID->"78613e2e-868c-436a-9c16-\
64c55e5853af"],

Cell[TextData[{
 "Every ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "k"], "(", 
     RowBox[{"A", ",", "v"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "42c9d56a-9de5-491d-b706-1ecf41e86fd0"],
 " has the representation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     RowBox[{"p", "(", "A", ")"}], ".", "v"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f56e4247-00f3-40ec-aab5-b02b1cb22d9f"],
 " for a polynomial\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", "A", ")"}], "=", 
    RowBox[{
     SubscriptBox["c", "0"], "+", 
     RowBox[{
      SubscriptBox["c", "1"], "A"}], "+", 
     RowBox[{
      SubscriptBox["c", "2"], 
      SuperscriptBox["A", "2"]}], "+", "\[Ellipsis]", "+", 
     RowBox[{
      SubscriptBox["c", 
       RowBox[{"m", "-", "2"}]], 
      SuperscriptBox["A", 
       RowBox[{"m", "-", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["c", 
       RowBox[{"m", "-", "1"}]], 
      SuperscriptBox["A", 
       RowBox[{"m", "-", "1"}]]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7d499bed-c0fc-4343-9b95-a25e2c256760"],
 "\nof degree ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "-", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "26e63dc1-36d3-44de-9cb6-f10c473c9e2f"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.87389562774994*^9, 3.873896119856448*^9}, {
  3.873896174348611*^9, 3.87389619591916*^9}, {3.8738962264290075`*^9, 
  3.873896263688865*^9}, {3.8738986400718145`*^9, 
  3.873898653380474*^9}},ExpressionUUID->"495bce73-3cd7-48e5-99e9-\
0a077a76b700"],

Cell[TextData[{
 "The minimal polynomial of ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0d5eb106-3f2d-4971-8794-447c13aca45d"],
 " is the lowest degree monic (top coefficient equals one) polynomial \
satisfying ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"P", "(", "A", ")"}], ".", "v"}], "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a9ebc0d0-9f47-40cf-a925-4fd748a4e3e2"],
 ". The grade of ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f9a55d6e-a87f-4d41-8e08-09737fbfddd4"],
 " with respect to A is the degree of the minimal polynomial.  "
}], "Text",
 CellChangeTimes->{{3.87389562774994*^9, 3.873896119856448*^9}, {
  3.873896174348611*^9, 3.87389619591916*^9}, {3.8738962264290075`*^9, 
  3.8738963898054657`*^9}, {3.8738986626568937`*^9, 
  3.8738986629211526`*^9}},ExpressionUUID->"60e805b8-2eff-4498-8271-\
627318d03323"],

Cell[TextData[{
 "The zero vector has grade zero.\nEigenvectors have grade 1 since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "-", 
       RowBox[{"\[Lambda]", " ", "I"}]}], ")"}], ".", "v"}], "=", "1"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fb2e32dc-d4c1-45c4-9666-b6998395030e"],
 ".   \nA non-degenerate linear combination ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Alpha]", "1"], 
     SubscriptBox["v", "1"]}], "+", 
    RowBox[{
     SubscriptBox["\[Alpha]", "2"], 
     SubscriptBox["v", "2"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "897e9fa9-f16c-4735-8d3a-15a8a29ba007"],
 " of two eigenvectors has grade 2 since it is zeroed by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", "-", 
      RowBox[{
       SubscriptBox["\[Lambda]", "1"], "I"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"A", "-", 
      RowBox[{
       SubscriptBox["\[Lambda]", "2"], "I"}]}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "48637d63-c9a9-4027-8608-66c2fa5d13c9"],
 ".  "
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8738964323676295`*^9, 3.873896473815857*^9}, {
  3.8738965765254164`*^9, 3.873896667290349*^9}, {3.8738968687060056`*^9, 
  3.8738968804921813`*^9}, {3.873898400479536*^9, 
  3.873898506401352*^9}},ExpressionUUID->"a1373c8e-638f-4f15-a010-\
93478bac2c82"],

Cell[TextData[{
 "Proposition 6.1 and 6.2 says the dimension of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
     RowBox[{"A", ",", "v"}], ")"}], "=", "m"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6ff65e9f-aaf3-4a81-af10-b13bb8cc400a"],
 " until you hit the grade of ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2822be3e-6298-4b91-9d53-27053e62f7d9"],
 " at which point ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
    RowBox[{"A", ",", "v"}], ")"}], TraditionalForm]],ExpressionUUID->
  "183e10ea-d603-442e-a80e-15020b685800"],
 " ceases to change. In symbols.\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"dim", "(", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
      RowBox[{"A", ",", "v"}], ")"}], ")"}], "=", 
    RowBox[{"min", "(", 
     RowBox[{"m", ",", 
      RowBox[{"grade", "(", "v", ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9f854b49-d28f-497c-826e-ba9aaafcbc36"]
}], "Text",
 CellChangeTimes->{{3.8738967219579954`*^9, 3.8738968294909534`*^9}, {
  3.8738968935272183`*^9, 3.873897005982497*^9}, {3.8738985169348955`*^9, 
  3.8738985209770017`*^9}, {3.873898674685619*^9, 
  3.8738987030796247`*^9}},ExpressionUUID->"26e13230-270c-4179-aaa5-\
39492ea86fe8"],

Cell[TextData[{
 "Proposition 6.3 characterizes projections projections onto ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
    RowBox[{"A", ",", "v"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "df1c4bba-ac4f-40f6-913b-0aba19d5953c"],
 " in terms of polynomials.  \nIf ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", "m"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "617888c5-b29d-4ab4-8d52-d1b2165f4bfd"],
 " is a projector onto ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalK]", "m"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "172811b3-ad30-463d-843e-9eaa022a5eb4"],
 " and is the projected action of A on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalK]", "m"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c364a78d-c76c-45f0-ac90-52f7988d6d57"],
 " then for any polynomial ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "54958c6e-2a4d-4781-be15-69dee923b55a"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"deg", "(", "q", ")"}], "\[LessEqual]", 
    RowBox[{"m", "-", "1"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "62b93839-d012-4017-98c0-4fb525654bee"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"q", "(", "A", ")"}], ".", "v"}], "=", 
    RowBox[{
     RowBox[{"q", "(", 
      SubscriptBox["A", "m"], ")"}], ".", "v"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ae1d2fec-c3ab-4fba-8df5-8d919b91876f"],
 "  \nand for any polynomial ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "134ab2ff-cf49-4d36-8959-2b5912757413"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"deg", "(", "q", ")"}], "\[LessEqual]", "m"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6862a310-2c85-478f-a1bd-04fdb2785073"],
 " \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "m"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", "(", "A", ")"}], ".", "v"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"q", "(", 
      SubscriptBox["A", "m"], ")"}], ".", "v"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0fce2368-bf3a-4919-b5da-48689b69aab4"],
 "\nOur book calls the projected action a section. All it means is  \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "m"], "=", 
    RowBox[{
     SubscriptBox["Q", "m"], " ", 
     RowBox[{"(", 
      RowBox[{"A", 
       SubscriptBox["\[VerticalSeparator]", 
        SubscriptBox["\[ScriptCapitalK]", "m"]]}], ")"}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b64f7f2f-fb12-4ab9-829f-4ba8a7587c95"]
}], "Text",
 CellChangeTimes->{{3.873897039462227*^9, 3.8738970596942034`*^9}, {
  3.8738971103277187`*^9, 3.8738971987894735`*^9}, {3.873898722284113*^9, 
  3.873898885359562*^9}, {3.8738989155679927`*^9, 3.8738993350404058`*^9}, {
  3.8738993669813614`*^9, 3.87389939373986*^9}, {3.8738994473620815`*^9, 
  3.873899448669837*^9}, {3.87389949671078*^9, 3.873899539113056*^9}, {
  3.873899733718525*^9, 
  3.873899740911886*^9}},ExpressionUUID->"b53caa47-1f26-4564-a20e-\
032eb40a979b"],

Cell[TextData[{
 "This will be clear once we have an orthogonal basis for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
    RowBox[{"A", ",", "v"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e0bb2bd6-76cd-4a5c-95ca-4ca72c99b8f9"],
 ". It will also be clear what it is good for. "
}], "Text",
 CellChangeTimes->{{3.873897039462227*^9, 3.8738970596942034`*^9}, {
  3.8738971103277187`*^9, 3.8738971987894735`*^9}, {3.873898722284113*^9, 
  3.873898885359562*^9}, {3.8738989155679927`*^9, 3.8738993350404058`*^9}, {
  3.8738993669813614`*^9, 3.87389939373986*^9}, {3.8738994473620815`*^9, 
  3.873899448669837*^9}, {3.87389949671078*^9, 3.873899539113056*^9}, {
  3.873899733718525*^9, 
  3.873899776590184*^9}},ExpressionUUID->"ea690fd0-7758-45bc-a94f-\
be426cd78526"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arnoldi", "Section",
 CellChangeTimes->{{3.8738955955126505`*^9, 
  3.8738955983244567`*^9}},ExpressionUUID->"1e5cd9f5-7e06-45f5-8e45-\
dc15d44e341a"],

Cell[TextData[{
 "Arnoldi builds an orthogonal basis for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "m"], "(", 
     RowBox[{"A", ",", "v"}], ")"}], "=", 
    RowBox[{"span", "(", 
     RowBox[{"v", ",", 
      RowBox[{"A", ".", "v"}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SuperscriptBox["A", 
        RowBox[{"m", "-", "1"}]], ".", "v"}]}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e0a81595-f2fa-4dcd-90ea-7518d3662537"],
 " by starting at the beginning and orthogonalizing.  There are variants \
analogous to the Gram-Schmidt, Modified Gram Schmidt, and Householder \
orthogonalization procedures for QR decompositions.  One possibility is in \
Algorithm 6.1.  Here is a simplified version \n\n\t# first vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "=", 
    RowBox[{
     RowBox[{"v", "/"}], "||", "v", "||"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2521364f-881c-4dda-8add-9fa894515512"],
 "\n\t\n\t# second vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "2"], "=", 
    RowBox[{"A", ".", 
     SubscriptBox["q", "1"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fb26ccde-2727-4db0-a1f9-8758fbb4a076"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "2"], "=", 
    RowBox[{
     SubscriptBox["q", "2"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "2"], ".", 
        SubscriptBox["q", "1"]}], ")"}], 
      SubscriptBox["q", "1"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "92bdcd3a-7ec4-4c1b-906f-5ebd59e71553"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "2"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "/"}], "||", 
     SubscriptBox["q", "2"], "||"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "429a24fc-27fe-4434-9ef6-958242e00dae"],
 "\n\t\n\t# third vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "3"], "=", 
    RowBox[{"A", ".", 
     SubscriptBox["q", "2"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "788bbde1-0f27-447c-bda5-93e21249e11f"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "3"], "=", 
    RowBox[{
     SubscriptBox["q", "3"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "3"], ".", 
        SubscriptBox["q", "1"]}], ")"}], 
      SubscriptBox["q", "1"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dd66dc5f-9585-4e7b-9a17-9780f01e4828"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "3"], "=", 
    RowBox[{
     SubscriptBox["q", "3"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["q", "3"], ".", 
        SubscriptBox["q", "2"]}], ")"}], 
      SubscriptBox["q", "2"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9e8fa38a-de59-4d5f-b7da-f3c7f759ba5f"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "3"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "/"}], "||", 
     SubscriptBox["q", "3"], "||"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9817d9ae-a8c2-411c-a136-f176448dd065"],
 "\n\t\n\t# fourth vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "4"], "=", 
    RowBox[{"A", ".", 
     SubscriptBox["q", "3"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a7b64455-7f18-48f7-ae29-ab378418f484"],
 "\n\tproject out earlier directions then normalize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "4"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "/"}], "||", 
     SubscriptBox["q", "4"], "||"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "71003ff6-db76-46d1-a843-99c67a920242"],
 "\n\t\n\t# fifth vector\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "5"], "=", 
    RowBox[{"A", ".", 
     SubscriptBox["q", "4"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "963c1243-18b4-4f4d-9cf7-c062140e7160"],
 "\n\tproject out earlier directions and normalize.\n\t... \n\nAll Algorithm \
6.1 does is store the coefficients from the orthogonalization coefficients in \
a convenient almost-square. almost-lower-triangular array ",
 Cell[BoxData[
  FormBox["\"\<H\>\"", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cfb54dee-7fa0-4224-bdc4-d3be5a203c51"],
 ", makes it clear that the orthogonalization can be done in parallel, and \
calls the vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a5b0bfcd-ff69-48cc-b858-96a31f2ed39a"],
 ". It writes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "m"], "=", 
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["v", "1"], "|", 
      SubscriptBox["v", "2"], "|", "\[Ellipsis]", "|", 
      SubscriptBox["v", "m"]}], "]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c3e9b48a-ea6e-4301-884e-ff1205f335d3"],
 " and defines the two related H matrices\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "m"], "=", 
    SubscriptBox[
     RowBox[{"[", 
      SubscriptBox["h", 
       RowBox[{"i", ",", "j"}]], "]"}], GridBox[{
       {
        RowBox[{"i", "=", 
         RowBox[{"1", ":", "m"}]}]},
       {
        RowBox[{"j", "=", 
         RowBox[{"1", ":", "m", "   "}]}]}
      }]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d900c9d9-b933-4794-8c12-cc9c588d083a"],
 "and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["H", "~"], "m"], "=", 
    SubscriptBox[
     RowBox[{"[", 
      SubscriptBox["h", 
       RowBox[{"i", ",", "j"}]], "]"}], GridBox[{
       {
        RowBox[{"i", "=", 
         RowBox[{"1", ":", 
          RowBox[{"m", "+", "1"}]}]}]},
       {
        RowBox[{"j", "=", 
         RowBox[{"1", ":", "m", "      "}]}]}
      }]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c60086b6-54fc-49ea-95cc-ffeec5027f13"],
 " \nWritten using these matrices the  6.1 says\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{"A", ".", 
       SubscriptBox["V", "m"]}], "=", 
      RowBox[{
       SubscriptBox["V", "m"], ".", 
       SubscriptBox["H", "m"]}], "+", 
      RowBox[{
       SubscriptBox["w", "m"], " ", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["e", "m"], ")"}], "\[Transpose]"}]}]},
     {" ", "=", 
      RowBox[{
       SubscriptBox["V", 
        RowBox[{"m", "+", "1"}]], "H"}], " ", " "},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["V", "m"], ")"}], "\[Transpose]"}], ".", "A", ".", 
       SubscriptBox["V", "m"]}], "=", 
      SubscriptBox["H", "m"], " ", " "}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3d31d0a9-3b31-4268-9a61-b9ad66b7ba48"],
 " "
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQbfO+6vW02W8cdTgufQHRq/Kv/wLRi/78+g2ivVTL
b8wB0h9V14PpEzsuvcic88aRJeTDOxBdl3v5C4i23fdFMAtI/9sz8d3G228c
lUKPvAfRQdfUv4DoBW+ZujYB6R1eettBtPfE8GsgOsdf5A6IFuPNeQSiZ1R7
at0H0ueK9xqC6LBd681A9CTvalsQrTj39j7TO28cZVdG7AfRb95/XPwASLef
mbUHRDMx/DsAovue+HwF8yUv/AbRNeofwfSxPx8YHgLpgN/VXCBa42ImH4gu
1vGRAtFc50TkQPSZqTPkQfQW39fKIJqNMScdRL8q3pMNoh9N4qwH0QBmb8OO

  "],ExpressionUUID->"8db8a5f6-7547-4811-a12e-acb31275510f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArnoldiBuild", "[", 
   RowBox[{"A_", ",", "v_", ",", "m_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", "HHat", ",", "VBig", ",", 
      "Av", ",", "w", ",", " ", 
      RowBox[{"Tol", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "12"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "Storage"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HHat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"m", "+", "1"}], ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"m", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Normalize", " ", "v"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HHat", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VBig", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"v", "/", 
       RowBox[{"Norm", "[", "v", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Av", "=", 
         RowBox[{"A", ".", 
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HHat", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Dot", "[", 
            RowBox[{"Av", ",", 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}], "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"Av", "-", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"HHat", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HHat", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"j", "+", "1"}], ",", "j"}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Norm", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"HHat", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"j", "+", "1"}], ",", "j"}], "\[RightDoubleBracket]"}], 
           "<", "Tol"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"HHat", ",", "V", ",", "j"}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"VBig", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", 
             RowBox[{"j", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"w", "/", 
            RowBox[{"HHat", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"j", "+", "1"}], ",", "j"}], 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"HHat", ",", "VBig", ",", "m"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8739015737365513`*^9, 3.873902362671464*^9}, {
  3.873902451530815*^9, 3.8739024522339196`*^9}, {3.873902496031283*^9, 
  3.873902518636578*^9}, {3.8739025654860764`*^9, 3.873902604251248*^9}, {
  3.8739026432523365`*^9, 3.8739026542685523`*^9}, {3.873902691981439*^9, 
  3.873902698065825*^9}, {3.8739027579332304`*^9, 3.873902764746222*^9}, {
  3.8739028212552304`*^9, 3.8739028216461596`*^9}, {3.8739028647094836`*^9, 
  3.8739028649661236`*^9}, {3.8739032666988854`*^9, 
  3.8739032910175247`*^9}},ExpressionUUID->"6d798ef0-5640-443f-a3fb-\
5d165a0e3119"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"HHat", ",", "VBig", ",", "m"}], "}"}], "=", 
   RowBox[{"ArnoldiBuild", "[", 
    RowBox[{"A", ",", "v", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "HHat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"VBig", "\[Transpose]"}], ".", "VBig"}], "]"}]}], "Input",
 CellChangeTimes->{{3.873902366138966*^9, 3.873902426155918*^9}, {
  3.87390247946912*^9, 3.8739024836090293`*^9}, {3.8739028041929097`*^9, 
  3.8739028807563*^9}, {3.8739032986647964`*^9, 3.87390333957757*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"74000ecf-d3fb-4297-a651-ce2c302044dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.10009379079920368`"}], 
      RowBox[{"-", "0.09098291905782127`"}]},
     {"0.7903486710103235`", "0.7049161082486752`"},
     {"0", "1.4387224693395153`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.873902396029234*^9, 3.873902427709882*^9}, {
   3.873902458187182*^9, 3.8739025265534973`*^9}, {3.873902584392127*^9, 
   3.8739026096247225`*^9}, 3.8739026632861013`*^9, 3.873902702721904*^9, {
   3.87390279764246*^9, 3.8739028813656855`*^9}, {3.873903316634658*^9, 
   3.8739033400361605`*^9}},
 CellLabel->
  "Out[105]//MatrixForm=",ExpressionUUID->"0d57e3c4-db6e-4277-b9c7-\
b86e584d17a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9999999999999997`", 
      RowBox[{"-", "1.3877787807814457`*^-17"}], "3.469446951953614`*^-18"},
     {
      RowBox[{"-", "1.3877787807814457`*^-17"}], "0.9999999999999999`", 
      RowBox[{"-", "2.3418766925686896`*^-17"}]},
     {"3.469446951953614`*^-18", 
      RowBox[{"-", "2.3418766925686896`*^-17"}], "1.0000000000000002`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.873902396029234*^9, 3.873902427709882*^9}, {
   3.873902458187182*^9, 3.8739025265534973`*^9}, {3.873902584392127*^9, 
   3.8739026096247225`*^9}, 3.8739026632861013`*^9, 3.873902702721904*^9, {
   3.87390279764246*^9, 3.8739028813656855`*^9}, {3.873903316634658*^9, 
   3.8739033400381713`*^9}},
 CellLabel->
  "Out[106]//MatrixForm=",ExpressionUUID->"e026b2d4-8605-48e1-9112-\
e0aaff3f38bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HHat$10305", "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.873902713394162*^9, 3.873902733691545*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"468754f1-5440-4478-8bcf-29ef93464e8c"],

Cell[BoxData["2.2541807935368525`"], "Output",
 CellChangeTimes->{{3.8739027169025574`*^9, 3.8739027342283516`*^9}},
 CellLabel->"Out[59]=",ExpressionUUID->"b88007f2-3aad-44a6-9645-42fea8ff8946"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{979.5, 492.},
WindowMargins->{{Automatic, -1519.5}, {Automatic, -189}},
Magnification->1.25,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"21380304-70eb-457a-8761-1f1d4d30bec1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 839, 21, 199, "Title",ExpressionUUID->"5d4a0142-ee91-4c83-922a-c35d53e8e7aa"],
Cell[1422, 45, 916, 18, 158, "Text",ExpressionUUID->"b711d88b-e12a-4f68-bc25-d265788e57b4"],
Cell[CellGroupData[{
Cell[2363, 67, 150, 3, 83, "Section",ExpressionUUID->"9edded53-1c71-466b-a2cd-52c8807dede1"],
Cell[2516, 72, 1805, 52, 102, "Text",ExpressionUUID->"78613e2e-868c-436a-9c16-64c55e5853af"],
Cell[4324, 126, 1717, 54, 101, "Text",ExpressionUUID->"495bce73-3cd7-48e5-99e9-0a077a76b700"],
Cell[6044, 182, 1002, 26, 72, "Text",ExpressionUUID->"60e805b8-2eff-4498-8271-627318d03323"],
Cell[7049, 210, 1488, 45, 130, "Text",ExpressionUUID->"a1373c8e-638f-4f15-a010-93478bac2c82",
 InitializationCell->True],
Cell[8540, 257, 1437, 40, 101, "Text",ExpressionUUID->"26e13230-270c-4179-aaa5-39492ea86fe8"],
Cell[9980, 299, 3375, 99, 241, "Text",ExpressionUUID->"b53caa47-1f26-4564-a20e-032eb40a979b"],
Cell[13358, 400, 845, 18, 43, "Text",ExpressionUUID->"ea690fd0-7758-45bc-a94f-be426cd78526"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14240, 423, 156, 3, 83, "Section",ExpressionUUID->"1e5cd9f5-7e06-45f5-8e45-dc15d44e341a"],
Cell[14399, 428, 7638, 244, 1087, "Text",ExpressionUUID->"8db8a5f6-7547-4811-a12e-acb31275510f"],
Cell[22040, 674, 4862, 118, 521, "Input",ExpressionUUID->"6d798ef0-5640-443f-a3fb-5d165a0e3119"],
Cell[CellGroupData[{
Cell[26927, 796, 1233, 34, 155, "Input",ExpressionUUID->"74000ecf-d3fb-4297-a651-ce2c302044dc"],
Cell[28163, 832, 1051, 26, 96, "Output",ExpressionUUID->"0d57e3c4-db6e-4277-b9c7-b86e584d17a3"],
Cell[29217, 860, 1208, 28, 149, "Output",ExpressionUUID->"e026b2d4-8605-48e1-9112-e0aaff3f38bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30462, 893, 255, 5, 35, "Input",ExpressionUUID->"468754f1-5440-4478-8bcf-29ef93464e8c"],
Cell[30720, 900, 195, 2, 40, "Output",ExpressionUUID->"b88007f2-3aad-44a6-9645-42fea8ff8946"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

