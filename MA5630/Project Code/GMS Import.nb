(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29017,        690]
NotebookOptionsPosition[     26341,        641]
NotebookOutlinePosition[     26772,        658]
CellTagsIndexPosition[     26729,        655]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Importing GMS file to Mma.", "Title",
 CellChangeTimes->{{3.8637048303114505`*^9, 3.8637048307664013`*^9}, {
  3.890821553149233*^9, 
  3.890821562673831*^9}},ExpressionUUID->"46447238-1fd7-4f26-bfff-\
bbe0b1a5ce95"],

Cell["\<\
My test problem is 
\thttp://www.minlplib.org/alkyl.html
It is relatively small.  The first import format target is the gms file
\thttp://www.minlplib.org/gms/alkyl.gms
The aim is to import and process into matrices, vectors etc.   The second one \
is 
\thttp://www.minlplib.org/gms/ann_compressor_tanh.gms
This one has at least a Tanh in it. \
\>", "Text",
 CellChangeTimes->{{3.890821565882245*^9, 3.890821583677009*^9}, {
  3.890821617703385*^9, 3.8908216663970013`*^9}, {3.890821718831568*^9, 
  3.890821756304463*^9}, {3.890822125257989*^9, 
  3.890822170560253*^9}},ExpressionUUID->"e6d55b36-c37f-4736-8e1f-\
cb03a3985015"],

Cell[CellGroupData[{

Cell["Alkyl", "Section",
 CellChangeTimes->{{3.8908221761297965`*^9, 
  3.8908221772953053`*^9}},ExpressionUUID->"301f2dcb-2b46-4e6c-86ee-\
c18561ac0e02"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ReadList", ",", 
    RowBox[{"RecordSeparators", "->", 
     RowBox[{"{", 
      RowBox[{
      "\"\<;\>\"", ",", " ", "\"\<\\n\>\"", ",", " ", "\"\<\\r\>\"", ",", 
       "\"\<\\r\\n\>\""}], "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LinkName", "=", "\"\<http://www.minlplib.org/gms/alkyl.gms\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FileString", "=", 
    RowBox[{"StringToStream", "[", 
     RowBox[{"ReadString", "[", "LinkName", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Extract", " ", "and", " ", "Print", " ", "Header"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadList", "[", 
   RowBox[{"FileString", ",", "String", ",", "1"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{"FileString", ",", "String", ",", "16"}], "]"}], ",", 
     "\"\<\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "and", " ", "Extract", " ", "variable", " ", "names"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarString", " ", "=", " ", 
   RowBox[{"Find", "[", 
    RowBox[{"FileString", ",", "\"\<Variables\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarList", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"VarString", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Variables\>\"", "->", "\"\<{\>\""}], ",", 
        RowBox[{"\"\<;\>\"", "->", "\"\<}\>\""}]}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "and", " ", "Extract", " ", "positive", " ", "variable", " ", 
    "names"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PosVarString", " ", "=", " ", 
   RowBox[{"Find", "[", 
    RowBox[{"FileString", ",", "\"\<Positive Variables\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PosVarList", "=", 
  RowBox[{"ToExpression", "[", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"PosVarString", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Positive Variables\>\"", "->", "\"\<{\>\""}], ",", 
       RowBox[{"\"\<;\>\"", "->", "\"\<}\>\""}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PosBoundConstraints", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"var", "\[GreaterEqual]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "PosVarList"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "and", " ", "Extract", " ", "equation", " ", "names"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EqString", " ", "=", " ", 
   RowBox[{"Find", "[", 
    RowBox[{"FileString", ",", "\"\<Equations\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EqList", "=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"EqString", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Equations\>\"", "->", "\"\<{\>\""}], ",", 
         RowBox[{"\"\<;\>\"", "->", "\"\<}\>\""}]}], "}"}]}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Find", " ", "and", " ", "build", " ", "equations"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EqList", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"eqString", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "eq", "]"}], ",", "\"\<..\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"Find", "[", 
           RowBox[{"FileString", ",", "eqString"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"eqString", "->", "\"\<\>\""}], ",", 
            RowBox[{"\"\<;\>\"", "->", "\"\<\>\""}], ",", 
            RowBox[{"\"\<=E=\>\"", "->", "\"\<==\>\""}]}], "}"}]}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"eq", ",", "EqList"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "and", " ", "build", " ", "bound", " ", "constraints"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Find", "[", 
  RowBox[{"FileString", ",", "\"\<* set non-default bounds\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundLines", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonZeroBounds", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"ToExpression", ",", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringSplit", "[", " ", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"ReadLine", "[", "FileString", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<=\>\"", "->", "\"\< \>\""}], ",", 
              RowBox[{"\"\<.up\>\"", " ", "->", "\"\<<=\>\""}], ",", 
              RowBox[{"\"\<.lo\>\"", " ", "->", "\"\<>=\>\""}]}], "}"}]}], 
           "]"}], ",", "\"\<;\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "BoundLines", "}"}]}], "]"}], "\[IndentingNewLine]", 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Read", " ", "the", " ", "non"}], "-", 
    RowBox[{"default", " ", 
     RowBox[{"levels", ".", "  ", "I"}], " ", "am", " ", "going", " ", "to", 
     " ", "interopret", " ", "this", " ", "as", " ", "a", " ", "starting", 
     " ", "condition"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Find", "[", 
  RowBox[{"FileString", ",", "\"\<* set non-default levels\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"VarsP", ",", "vars0"}], "}"}], "=", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"ToExpression", "[", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<{\>\"", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"ReadLine", "[", "FileString", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<.l\>\"", "->", "\"\<p\>\""}], ",", 
              RowBox[{"\"\<;\>\"", "->", "\"\<,\>\""}], ",", 
              RowBox[{"\"\<=\>\"", "->", "\"\<,\>\""}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "VarList", "]"}], "-", "1"}], "}"}]}], 
         "]"}], ",", "\"\<}\>\""}], "]"}], "]"}], ",", "2"}], "]"}], 
   "\[Transpose]"}]}]}], "Input",
 CellChangeTimes->{{3.8908215875261445`*^9, 3.89082158954928*^9}, {
   3.890821675485874*^9, 3.890821681048675*^9}, {3.89082176268738*^9, 
   3.890821810393876*^9}, {3.890821866614744*^9, 3.8908219267701693`*^9}, {
   3.8908219706863976`*^9, 3.890822005283523*^9}, {3.890822210172966*^9, 
   3.890822235962015*^9}, {3.8908222787257013`*^9, 3.890822319646041*^9}, {
   3.890822422742833*^9, 3.8908225149015193`*^9}, {3.890822551843607*^9, 
   3.890822559381691*^9}, {3.890822605445099*^9, 3.8908227117381353`*^9}, {
   3.8908228029868593`*^9, 3.890822976350383*^9}, {3.8908230242542133`*^9, 
   3.890823077758992*^9}, {3.890823251757044*^9, 3.8908233571711493`*^9}, {
   3.890823417971775*^9, 3.890823424707432*^9}, {3.890823457437585*^9, 
   3.8908238061054554`*^9}, {3.890823840594097*^9, 3.890823878366311*^9}, {
   3.8908239807675447`*^9, 3.890824335442475*^9}, {3.8908243696742773`*^9, 
   3.8908243720129185`*^9}, {3.8908244162558217`*^9, 
   3.8908244256075697`*^9}, {3.890824458840526*^9, 3.8908245251030903`*^9}, {
   3.890824580807316*^9, 3.8908245834393835`*^9}, {3.890824624595215*^9, 
   3.890824688558085*^9}, {3.890824723503932*^9, 3.89082472508457*^9}, {
   3.8908247653195915`*^9, 3.890824856182819*^9}, {3.890824891796728*^9, 
   3.8908249966754365`*^9}, {3.8908250368949623`*^9, 3.890825125635976*^9}, {
   3.8908251613852215`*^9, 3.8908251621835527`*^9}, {3.89082522539767*^9, 
   3.8908253874941688`*^9}, {3.8908255889333634`*^9, 3.890825626166065*^9}, {
   3.8908262721948004`*^9, 3.8908262727322083`*^9}, 3.890826345684516*^9, {
   3.890826386373171*^9, 3.890826403157124*^9}, {3.8908264535952654`*^9, 
   3.890826467434496*^9}, {3.8908264975773544`*^9, 3.8908265412992754`*^9}, {
   3.8908279416133623`*^9, 3.890827950950194*^9}, {3.8908280993343678`*^9, 
   3.8908283126323743`*^9}, {3.8908298647109437`*^9, 
   3.8908298741902857`*^9}, {3.8908299198875866`*^9, 3.89082996389596*^9}, {
   3.8908304840804167`*^9, 3.890830519872079*^9}, {3.8908307961677437`*^9, 
   3.890831091535859*^9}, {3.890831132806068*^9, 3.890831136125571*^9}, 
   3.890831230117837*^9, {3.8908312615929165`*^9, 3.890831264785551*^9}, {
   3.8908312983629637`*^9, 3.890831307717763*^9}, {3.890831343525297*^9, 
   3.890831362877575*^9}, {3.8908314082586*^9, 3.890831525325201*^9}, {
   3.8908315558110495`*^9, 3.8908315574499245`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[432]:=",ExpressionUUID->"e6bbcc5f-520c-4420-a49c-c3db8bd8754f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "objvar", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", "x7", 
   ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12", ",", "x13", ",", 
   "x14", ",", "x15"}], "}"}]], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.890831560283914*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"74cac7ec-b8c0-4e0b-a2d3-4980bf80c3d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], "}"}]], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.8908315602892303`*^9},
 CellLabel->
  "Out[440]=",ExpressionUUID->"0dfe713d-ed81-41ca-ac0e-91ca69632608"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x2", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"x3", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"x4", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"x5", "\[GreaterEqual]", "0"}], ",", 
   RowBox[{"x6", "\[GreaterEqual]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.890831560294203*^9},
 CellLabel->
  "Out[441]=",ExpressionUUID->"3b253241-fdcc-4511-a00e-fa5c5ada955d"],

Cell[BoxData["\<\"* set non-default bounds\"\>"], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.8908315603003902`*^9},
 CellLabel->
  "Out[445]=",ExpressionUUID->"c4199f94-9b9e-4234-bf62-9846d2e2609b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x2", "\[LessEqual]", "2"}], ",", 
   RowBox[{"x3", "\[LessEqual]", "1.6`"}], ",", 
   RowBox[{"x4", "\[LessEqual]", "1.2`"}], ",", 
   RowBox[{"x5", "\[LessEqual]", "5"}], ",", 
   RowBox[{"x6", "\[LessEqual]", "2"}], ",", 
   RowBox[{"x7", "\[GreaterEqual]", "0.85`"}], ",", 
   RowBox[{"x7", "\[LessEqual]", "0.93`"}], ",", 
   RowBox[{"x8", "\[GreaterEqual]", "0.9`"}], ",", 
   RowBox[{"x8", "\[LessEqual]", "0.95`"}], ",", 
   RowBox[{"x9", "\[GreaterEqual]", "3"}], ",", 
   RowBox[{"x9", "\[LessEqual]", "12"}], ",", 
   RowBox[{"x10", "\[GreaterEqual]", "1.2`"}], ",", 
   RowBox[{"x10", "\[LessEqual]", "4"}], ",", 
   RowBox[{"x11", "\[GreaterEqual]", "1.45`"}], ",", 
   RowBox[{"x11", "\[LessEqual]", "1.62`"}], ",", 
   RowBox[{"x12", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x12", "\[LessEqual]", "1.01010101010101`"}], ",", 
   RowBox[{"x13", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x13", "\[LessEqual]", "1.01010101010101`"}], ",", 
   RowBox[{"x14", "\[GreaterEqual]", "0.9`"}], ",", 
   RowBox[{"x14", "\[LessEqual]", "1.11111111111111`"}], ",", 
   RowBox[{"x15", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x15", "\[LessEqual]", "1.01010101010101`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.890831560311989*^9},
 CellLabel->
  "Out[447]=",ExpressionUUID->"9016759e-7183-447f-95da-76855667157e"],

Cell[BoxData["\<\"* set non-default levels\"\>"], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.890831560322342*^9},
 CellLabel->
  "Out[448]=",ExpressionUUID->"ba131a50-b960-4b89-97e8-5d47b106a563"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "objvarp", ",", "x2p", ",", "x3p", ",", "x4p", ",", "x5p", ",", "x6p", 
     ",", "x7p", ",", "x8p", ",", "x9p", ",", "x10p", ",", "x12p", ",", 
     "x13p", ",", "x14p", ",", "x15p"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9`"}], ",", "1.745`", ",", "1.2`", ",", "1.1`", ",", 
     "3.048`", ",", "1.974`", ",", "0.893`", ",", "0.928`", ",", "8", ",", 
     "3.6`", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8908298145335007`*^9, 3.890829837799527*^9}, {
   3.890829924277922*^9, 3.8908299644275618`*^9}, 3.890830485375722*^9, 
   3.8908305209934807`*^9, {3.8908309096389165`*^9, 3.89083092714075*^9}, {
   3.8908310118699207`*^9, 3.890831047323556*^9}, 3.8908310927102327`*^9, 
   3.890831137586993*^9, 3.8908312370198402`*^9, 3.8908312674061136`*^9, 
   3.890831309382099*^9, {3.8908313523694725`*^9, 3.8908313638785295`*^9}, {
   3.890831423158333*^9, 3.8908314913735*^9}, 3.8908315271066723`*^9, 
   3.8908315603305426`*^9},
 CellLabel->
  "Out[449]=",ExpressionUUID->"fb7f8d50-b873-4271-8734-05f053514f43"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rewrite to some Standard Form", "Section",
 CellChangeTimes->{{3.8908305466991735`*^9, 
  3.890830561174757*^9}},ExpressionUUID->"9131bcd2-e0bc-4e0e-81a2-\
aae299c76b0c"],

Cell["\<\
So I need to isolate the objective function and combine the constraints. \
\>", "Text",
 CellChangeTimes->{{3.8908305726011744`*^9, 
  3.890830589913636*^9}},ExpressionUUID->"7ae80d84-c446-44ce-a096-\
41dfb9c7da15"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"obj", "=", 
  RowBox[{"objvar", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
      "EqList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
      "objvar"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"cons", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"NonZeroBounds", ",", 
    RowBox[{"Drop", "[", 
     RowBox[{"EqList", ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vars", "=", 
  RowBox[{"Drop", "[", 
   RowBox[{"VarList", ",", "1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8908305984866276`*^9, 3.8908307229153757`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"33fa62f9-d197-444f-93ed-e08ec7bc6f2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"5.04`", " ", "x2"}], "+", 
  RowBox[{"0.35`", " ", "x3"}], "+", 
  RowBox[{"1.`", " ", "x4"}], "+", 
  RowBox[{"3.36`", " ", "x6"}], "-", 
  RowBox[{"6.3`", " ", "x5", " ", "x8"}]}]], "Output",
 CellChangeTimes->{{3.890830623799966*^9, 3.8908306464224567`*^9}, 
   3.8908306897104287`*^9, 3.8908307236785135`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"b07782e6-157f-4c0f-bbcd-035ea68b49d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x2", "\[LessEqual]", "2"}], ",", 
   RowBox[{"x3", "\[LessEqual]", "1.6`"}], ",", 
   RowBox[{"x4", "\[LessEqual]", "1.2`"}], ",", 
   RowBox[{"x5", "\[LessEqual]", "5"}], ",", 
   RowBox[{"x6", "\[LessEqual]", "2"}], ",", 
   RowBox[{"x7", "\[GreaterEqual]", "0.85`"}], ",", 
   RowBox[{"x7", "\[LessEqual]", "0.93`"}], ",", 
   RowBox[{"x8", "\[GreaterEqual]", "0.9`"}], ",", 
   RowBox[{"x8", "\[LessEqual]", "0.95`"}], ",", 
   RowBox[{"x9", "\[GreaterEqual]", "3"}], ",", 
   RowBox[{"x9", "\[LessEqual]", "12"}], ",", 
   RowBox[{"x10", "\[GreaterEqual]", "1.2`"}], ",", 
   RowBox[{"x10", "\[LessEqual]", "4"}], ",", 
   RowBox[{"x11", "\[GreaterEqual]", "1.45`"}], ",", 
   RowBox[{"x11", "\[LessEqual]", "1.62`"}], ",", 
   RowBox[{"x12", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x12", "\[LessEqual]", "1.01010101010101`"}], ",", 
   RowBox[{"x13", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x13", "\[LessEqual]", "1.01010101010101`"}], ",", 
   RowBox[{"x14", "\[GreaterEqual]", "0.9`"}], ",", 
   RowBox[{"x14", "\[LessEqual]", "1.11111111111111`"}], ",", 
   RowBox[{"x15", "\[GreaterEqual]", "0.99`"}], ",", 
   RowBox[{"x15", "\[LessEqual]", "1.01010101010101`"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.819672131147541`"}], " ", "x2"}], "+", "x5", "-", 
     RowBox[{"0.819672131147541`", " ", "x6"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"0.98`", " ", "x4"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x4", "+", 
        RowBox[{"0.01`", " ", "x10", " ", "x5"}]}], ")"}], " ", "x7"}]}], 
    "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"10", " ", "x3"}], "+", "x6", "-", 
     RowBox[{"x2", " ", "x9"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x12", " ", "x5"}], "-", 
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1.12`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.13167`", " ", "x9"}], "-", 
        RowBox[{"0.0067`", " ", 
         SuperscriptBox["x9", "2"]}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.325`"}], " ", "x7"}], "+", 
     RowBox[{"x13", " ", "x8"}], "-", 
     RowBox[{"0.01`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.098`", " ", "x9"}], "-", 
        RowBox[{"0.038`", " ", 
         SuperscriptBox["x9", "2"]}]}], ")"}]}]}], "\[Equal]", "0.57425`"}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"22.2`", " ", "x11"}], "+", 
     RowBox[{"x10", " ", "x14"}]}], "\[Equal]", "35.82`"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x11", " ", "x15"}], "-", 
     RowBox[{"3", " ", "x8"}]}], "\[Equal]", 
    RowBox[{"-", "1.33`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.890830623799966*^9, 3.8908306464224567`*^9}, 
   3.8908306897104287`*^9, 3.8908307236899877`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"9c922223-c2de-4b65-8cef-a296ce45d715"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", "x7", ",", "x8", ",",
    "x9", ",", "x10", ",", "x11", ",", "x12", ",", "x13", ",", "x14", ",", 
   "x15"}], "}"}]], "Output",
 CellChangeTimes->{{3.890830623799966*^9, 3.8908306464224567`*^9}, 
   3.8908306897104287`*^9, 3.890830723696076*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"a7057052-1db5-4742-b890-08a5bd49d311"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"3682da40-b7b6-45cd-9bdb-f2701c19259a"],

Cell["Now we can run the thing! ", "Text",
 CellChangeTimes->{{3.8908316699193945`*^9, 
  3.8908316750814495`*^9}},ExpressionUUID->"6a7f0488-c11c-43aa-bdfd-\
675c524d06a9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"min", ",", "sub"}], "}"}], "=", 
  RowBox[{"FindMinimum", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"obj", ",", "cons"}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"obj", ",", "cons", ",", " ", 
    RowBox[{
     RowBox[{"x11", " ", "x15"}], "-", 
     RowBox[{"3", " ", "x8"}], "+", "1.33"}]}], "}"}], "/.", 
  "sub"}]}], "Input",
 CellChangeTimes->{{3.890830732353264*^9, 3.8908307667176924`*^9}, {
  3.8908315424372063`*^9, 3.8908316390196295`*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"94331a52-ccc5-471a-a6db-37452883052f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.764999625148949`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "\[Rule]", "1.703702004574272`"}], ",", 
     RowBox[{"x3", "\[Rule]", "1.5846989901780317`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.5430880698268677`"}], ",", 
     RowBox[{"x5", "\[Rule]", "3.035821247864516`"}], ",", 
     RowBox[{"x6", "\[Rule]", "1.999999917820437`"}], ",", 
     RowBox[{"x7", "\[Rule]", "0.9013199233777488`"}], ",", 
     RowBox[{"x8", "\[Rule]", "0.95`"}], ",", 
     RowBox[{"x9", "\[Rule]", "10.475417542241916`"}], ",", 
     RowBox[{"x10", "\[Rule]", "1.5616362736566902`"}], ",", 
     RowBox[{"x11", "\[Rule]", "1.5353535522139565`"}], ",", 
     RowBox[{"x12", "\[Rule]", "0.9900000346693171`"}], ",", 
     RowBox[{"x13", "\[Rule]", "0.99`"}], ",", 
     RowBox[{"x14", "\[Rule]", "1.111110935409387`"}], ",", 
     RowBox[{"x15", "\[Rule]", "0.99`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.890830767775301*^9, {3.890831564020943*^9, 3.8908316063308105`*^9}, 
   3.8908316423125143`*^9},
 CellLabel->
  "Out[456]=",ExpressionUUID->"01374028-4874-431a-8c51-b5ddf2b5cd6a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.7649996251489473`"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
     "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
     "True", ",", "False", ",", "False", ",", "False", ",", "False", ",", 
     "False", ",", "False", ",", "False"}], "}"}], ",", 
   "1.669181770580508`*^-8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.890830767775301*^9, {3.890831564020943*^9, 3.8908316063308105`*^9}, 
   3.8908316423267994`*^9},
 CellLabel->
  "Out[457]=",ExpressionUUID->"c2d4eb2b-f844-4d2c-840b-1873e19998dc"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8908305406670456`*^9, 
  3.8908305643480463`*^9}},ExpressionUUID->"a44bf667-374e-49f4-bad8-\
5b6a79ae3ac0"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{843, 965},
WindowMargins->{{Automatic, -1723.5}, {26.5, Automatic}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c42bfd28-31a0-4a73-ae12-ae1ef1c633b7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 222, 4, 98, "Title",ExpressionUUID->"46447238-1fd7-4f26-bfff-bbe0b1a5ce95"],
Cell[805, 28, 639, 14, 173, "Text",ExpressionUUID->"e6d55b36-c37f-4736-8e1f-cb03a3985015"],
Cell[CellGroupData[{
Cell[1469, 46, 154, 3, 67, "Section",ExpressionUUID->"301f2dcb-2b46-4e6c-86ee-c18561ac0e02"],
Cell[CellGroupData[{
Cell[1648, 53, 9455, 222, 695, "Input",ExpressionUUID->"e6bbcc5f-520c-4420-a49c-c3db8bd8754f"],
Cell[11106, 277, 863, 15, 32, "Output",ExpressionUUID->"74cac7ec-b8c0-4e0b-a2d3-4980bf80c3d4"],
Cell[11972, 294, 734, 12, 32, "Output",ExpressionUUID->"0dfe713d-ed81-41ca-ac0e-91ca69632608"],
Cell[12709, 308, 922, 17, 32, "Output",ExpressionUUID->"3b253241-fdcc-4511-a00e-fa5c5ada955d"],
Cell[13634, 327, 685, 10, 32, "Output",ExpressionUUID->"c4199f94-9b9e-4234-bf62-9846d2e2609b"],
Cell[14322, 339, 1886, 35, 71, "Output",ExpressionUUID->"9016759e-7183-447f-95da-76855667157e"],
Cell[16211, 376, 683, 10, 32, "Output",ExpressionUUID->"ba131a50-b960-4b89-97e8-5d47b106a563"],
Cell[16897, 388, 1164, 23, 52, "Output",ExpressionUUID->"fb7f8d50-b873-4271-8734-05f053514f43"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18110, 417, 176, 3, 67, "Section",ExpressionUUID->"9131bcd2-e0bc-4e0e-81a2-aae299c76b0c"],
Cell[18289, 422, 225, 5, 35, "Text",ExpressionUUID->"7ae80d84-c446-44ce-a096-41dfb9c7da15"],
Cell[CellGroupData[{
Cell[18539, 431, 761, 20, 67, "Input",ExpressionUUID->"33fa62f9-d197-444f-93ed-e08ec7bc6f2d"],
Cell[19303, 453, 431, 10, 32, "Output",ExpressionUUID->"b07782e6-157f-4c0f-bbcd-035ea68b49d0"],
Cell[19737, 465, 2967, 76, 135, "Output",ExpressionUUID->"9c922223-c2de-4b65-8cef-a296ce45d715"],
Cell[22707, 543, 425, 9, 32, "Output",ExpressionUUID->"a7057052-1db5-4742-b890-08a5bd49d311"]
}, Open  ]],
Cell[23147, 555, 81, 0, 28, "Input",ExpressionUUID->"3682da40-b7b6-45cd-9bdb-f2701c19259a"],
Cell[23231, 557, 172, 3, 35, "Text",ExpressionUUID->"6a7f0488-c11c-43aa-bdfd-675c524d06a9"],
Cell[CellGroupData[{
Cell[23428, 564, 742, 22, 48, "Input",ExpressionUUID->"94331a52-ccc5-471a-a6db-37452883052f"],
Cell[24173, 588, 1156, 24, 52, "Output",ExpressionUUID->"01374028-4874-431a-8c51-b5ddf2b5cd6a"],
Cell[25332, 614, 810, 17, 76, "Output",ExpressionUUID->"c2d4eb2b-f844-4d2c-840b-1873e19998dc"]
}, Open  ]],
Cell[26157, 634, 156, 3, 28, "Input",ExpressionUUID->"a44bf667-374e-49f4-bad8-5b6a79ae3ac0"]
}, Open  ]]
}, Open  ]]
}
]
*)

