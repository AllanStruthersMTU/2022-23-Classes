(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    222486,       5612]
NotebookOptionsPosition[    212736,       5449]
NotebookOutlinePosition[    213191,       5467]
CellTagsIndexPosition[    213148,       5464]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Linearly Constrained GEV", "Title",
 CellChangeTimes->{{3.8914201796896715`*^9, 
  3.8914201906404457`*^9}},ExpressionUUID->"eb397758-b218-461d-bbec-\
a3b78019da81"],

Cell[TextData[{
 "The basic idea is that if I want so solve \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["M", "0"], ".", "v"}], "=", 
    RowBox[{"\[Lambda]", " ", 
     RowBox[{
      SubscriptBox["M", "1"], ".", "v"}]}]}], TraditionalForm]],
  ExpressionUUID->"643eb947-a350-46eb-925d-fba381b8783e"],
 "\nwith ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"G", ".", "v"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "5b4f406f-060d-4718-8c26-34f76194ac34"],
 " then I can build the expanded GEV\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["M", "0"], 
         RowBox[{"G", "\[Transpose]"}]},
        {"G", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{
     RowBox[{"\[Lambda]", "(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["M", "1"], "0"},
        {"0", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "e3e0fd46-fe42-4a9f-b28b-751cab1c9445"],
 "\nand just grab the bits I want.\n\nSlightly different I can put the bits \
on the other side.\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["M", "0"], "0"},
        {"0", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{
     RowBox[{"\[Lambda]", "(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["M", "1"], 
         RowBox[{"G", "\[Transpose]"}]},
        {"G", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "288022b8-e61e-45d8-863b-13524bc51d1c"],
 "\n\t\nSince I am forcing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"G", ".", "v"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "dffe4908-bd5e-44e7-887f-fa68b05102e8"],
 " I can add stuff like  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ".", "G"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f09aff49-05f8-4b2b-938a-4454dbe8ed85"],
 " to the upper diagonal block occupied by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3e9cfb98-9b3f-424b-9308-84d0bed63d50"],
 ".  The obvious thing is to try G\[Transpose].G but I could also draw a \
random X of the appropriate dimension\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          SubscriptBox["M", "0"], "+", 
          RowBox[{
           RowBox[{"G", "\[Transpose]"}], ".", "G"}]}], 
         RowBox[{"G", "\[Transpose]"}]},
        {"G", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{
     RowBox[{"\[Lambda]", "(", "\[NoBreak]", GridBox[{
        {
         SubscriptBox["M", "1"], "0"},
        {"0", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", GridBox[{
        {"v"},
        {"\[Mu]"}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "9a1e5e67-f831-4505-8d16-feb47641cc4d"]
}], "Text",
 CellChangeTimes->{{3.8914201996859536`*^9, 3.8914204136949825`*^9}, {
  3.891722904492426*^9, 3.891722956230608*^9}, {3.891724366685918*^9, 
  3.891724372264162*^9}, {3.891724462245349*^9, 3.891724524412385*^9}, {
  3.891724564703022*^9, 
  3.891724705354085*^9}},ExpressionUUID->"3162fbf9-8516-421d-93aa-\
cf6361954012"],

Cell["Looks fine. ", "Text",
 CellChangeTimes->{{3.89142038814419*^9, 3.891420398762436*^9}, {
  3.891429545762367*^9, 
  3.891429547960451*^9}},ExpressionUUID->"ee09febe-7ac2-4994-918b-\
8cd5948369b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Ambient", " ", "dimension", " ", "m", " ", "and", " ", "c", " ", 
    "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "c"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"12", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "Constraint", " ", "Matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "orth", " ", "basis", " ", "for", " ", "null", " ", 
     "space"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NG", "=", 
     RowBox[{
      RowBox[{"NullSpace", "[", "G", "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Map", "[", 
    RowBox[{"Norm", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", ".", "NG"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"NG", "\[Transpose]"}], ".", "NG"}], "-", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"m", "-", "c"}], "]"}]}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "symmetric", " ", "test", " ", "matrices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"#", "\[Transpose]"}]}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"M0", ",", "M1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "evals", " ", "two", " ", "ways"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Projected", " ", "and", " ", "Embedded"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P\[Lambda]s", ",", "Pvs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M0", ".", "NG"}], ",", 
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M1", ".", "NG"}]}], "}"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroCxC", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E\[Lambda]s", ",", "Evs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M0Hat", ",", "M1Hat"}], "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{"ArrayFlatten", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"M0", 
                RowBox[{"G", "\[Transpose]"}]},
               {"G", "0"}
              }], "\[NoBreak]", ")"}], ",", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"M1", "0"},
               {"0", "ZeroCxC"}
              }], "\[NoBreak]", ")"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sort", ",", 
        RowBox[{"{", 
         RowBox[{"P\[Lambda]s", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"E\[Lambda]s", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "#", "]"}], "<", "\[Infinity]"}], "&"}]}], 
           "]"}]}], "}"}]}], "]"}], "\[Transpose]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Projected\>\"", ",", "\"\<Embedded\>\""}], "}"}]}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891420416474676*^9, 3.8914205185760765`*^9}, {
   3.8914205583234463`*^9, 3.8914206578717747`*^9}, {3.8914207066834865`*^9, 
   3.8914209381748877`*^9}, {3.891421041702095*^9, 3.891421525094863*^9}, 
   3.891723695571877*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"d1d5185a-247c-4fe0-a36b-24a99c3dd57c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.257726190754918`*^-16", ",", "3.829863325990958`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.891420711086454*^9, 3.891420774933097*^9}, {
   3.891420812445137*^9, 3.8914208603116064`*^9}, {3.8914209183075542`*^9, 
   3.8914209388432045`*^9}, {3.8914210927047663`*^9, 3.8914211054201784`*^9}, 
   3.891421329121416*^9, {3.891421382922041*^9, 3.891421404584484*^9}, {
   3.891421456580475*^9, 3.891421525458808*^9}, 3.891723121616415*^9, 
   3.891723696549284*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"6150da7e-3856-4e20-8d28-9442cdaf085c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"Projected\"\>",
       HoldForm], 
      TagBox["\<\"Embedded\"\>",
       HoldForm]},
     {"1", 
      RowBox[{
       RowBox[{"-", "3.1429617288096776`"}], "-", 
       RowBox[{"8.802641895561282`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "3.1429617288096487`"}], "+", 
       RowBox[{"8.802641895561262`", " ", "\[ImaginaryI]"}]}]},
     {"2", 
      RowBox[{
       RowBox[{"-", "3.1429617288096776`"}], "+", 
       RowBox[{"8.802641895561283`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "3.1429617288096487`"}], "-", 
       RowBox[{"8.802641895561264`", " ", "\[ImaginaryI]"}]}]},
     {"3", 
      RowBox[{"-", "2.7582928064715673`"}], 
      RowBox[{"-", "2.758292806471559`"}]},
     {"4", 
      RowBox[{"-", "1.1389757561062746`"}], 
      RowBox[{"-", "1.1389757561062743`"}]},
     {"5", 
      RowBox[{"-", "0.5857587170703185`"}], 
      RowBox[{"-", "0.5857587170703188`"}]},
     {"6", 
      RowBox[{"0.36980937641133765`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9491740478568834`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3698093764113394`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9491740478568829`", " ", "\[ImaginaryI]"}]}]},
     {"7", 
      RowBox[{"0.36980937641133776`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9491740478568834`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.36980937641133943`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9491740478568829`", " ", "\[ImaginaryI]"}]}]},
     {"8", "0.5390769427206333`", "0.5390769427206337`"},
     {"9", "5.05866400479252`", "5.058664004792503`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {Automatic, {"Projected", "Embedded"}}]]]], "Output",
 CellChangeTimes->{{3.891420711086454*^9, 3.891420774933097*^9}, {
   3.891420812445137*^9, 3.8914208603116064`*^9}, {3.8914209183075542`*^9, 
   3.8914209388432045`*^9}, {3.8914210927047663`*^9, 3.8914211054201784`*^9}, 
   3.891421329121416*^9, {3.891421382922041*^9, 3.891421404584484*^9}, {
   3.891421456580475*^9, 3.891421525458808*^9}, 3.891723121616415*^9, 
   3.891723696568595*^9},
 CellLabel->
  "Out[127]//TableForm=",ExpressionUUID->"b2a2226d-04fc-4910-bca2-\
d0b271a52659"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Det", ",", 
   RowBox[{"{", 
    RowBox[{"M0Hat", ",", "M1Hat"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8917237028207006`*^9, 3.8917237352875137`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"033d06dc-ceb7-47fc-8b63-535f94a5ff82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"22250.012277378042`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.89172370749809*^9, 3.891723735796865*^9}},
 CellLabel->
  "Out[129]=",ExpressionUUID->"d030edff-56e0-4625-bd9e-7f0f448043ca"]
}, Open  ]],

Cell["Other way", "Text",
 CellChangeTimes->{{3.891723048537304*^9, 
  3.891723050302065*^9}},ExpressionUUID->"bfcb348e-db0d-419d-ba8e-\
04b38c8dad7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Ambient", " ", "dimension", " ", "m", " ", "and", " ", "c", " ", 
    "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "c"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"12", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "Constraint", " ", "Matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "orth", " ", "basis", " ", "for", " ", "null", " ", 
     "space"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NG", "=", 
     RowBox[{
      RowBox[{"NullSpace", "[", "G", "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Map", "[", 
    RowBox[{"Norm", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", ".", "NG"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"NG", "\[Transpose]"}], ".", "NG"}], "-", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"m", "-", "c"}], "]"}]}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "symmetric", " ", "test", " ", "matrices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"#", "\[Transpose]"}]}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"M0", ",", "M1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "evals", " ", "two", " ", "ways"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Projected", " ", "and", " ", "Embedded"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P\[Lambda]s", ",", "Pvs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M0", ".", "NG"}], ",", 
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M1", ".", "NG"}]}], "}"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroCxC", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tol", "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "7"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E\[Lambda]s", ",", "Evs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M0Hat", ",", "M1Hat"}], "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{"ArrayFlatten", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"M0", "0"},
               {"0", "ZeroCxC"}
              }], "\[NoBreak]", ")"}], ",", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"M1", 
                RowBox[{"G", "\[Transpose]"}]},
               {"G", "0"}
              }], "\[NoBreak]", ")"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sort", ",", 
        RowBox[{"{", 
         RowBox[{"P\[Lambda]s", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"E\[Lambda]s", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "#", "]"}], ">", "Tol"}], "&"}]}], "]"}]}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Projected\>\"", ",", "\"\<Embedded\>\""}], "}"}]}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891420416474676*^9, 3.8914205185760765`*^9}, {
  3.8914205583234463`*^9, 3.8914206578717747`*^9}, {3.8914207066834865`*^9, 
  3.8914209381748877`*^9}, {3.891421041702095*^9, 3.891421525094863*^9}, {
  3.891723082021105*^9, 3.891723107995756*^9}, {3.891723179543005*^9, 
  3.891723282243202*^9}, {3.8917233609053802`*^9, 3.891723372888443*^9}, {
  3.891723495729394*^9, 3.891723522500473*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"ef1fd1d6-b909-42d4-9354-d619b831f7e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.764041140514307`*^-16", ",", "3.193406341113415`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8917231127726097`*^9, 3.891723183945209*^9, {3.8917232470798273`*^9, 
   3.891723283342074*^9}, 3.891723374344584*^9, 3.89172347899257*^9, {
   3.891723512283669*^9, 3.891723523010449*^9}, 3.891723760933429*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"3cda4e91-da62-4e5e-8b27-db12cab7e51d"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"Projected\"\>",
       HoldForm], 
      TagBox["\<\"Embedded\"\>",
       HoldForm]},
     {"1", 
      RowBox[{"-", "5.639095222339112`"}], 
      RowBox[{"-", "5.6390952223390975`"}]},
     {"2", 
      RowBox[{"-", "0.713931439676665`"}], 
      RowBox[{"-", "0.7139314396766652`"}]},
     {"3", 
      RowBox[{
       RowBox[{"-", "0.04189138449831321`"}], "-", 
       RowBox[{"0.20945784624067082`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.04189138449831327`"}], "-", 
       RowBox[{"0.20945784624066843`", " ", "\[ImaginaryI]"}]}]},
     {"4", 
      RowBox[{
       RowBox[{"-", "0.0418913844983132`"}], "+", 
       RowBox[{"0.20945784624067082`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.04189138449831326`"}], "+", 
       RowBox[{"0.20945784624066843`", " ", "\[ImaginaryI]"}]}]},
     {"5", 
      RowBox[{"0.44454774595533003`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7547651977905999`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4445477459553289`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.754765197790599`", " ", "\[ImaginaryI]"}]}]},
     {"6", 
      RowBox[{"0.4445477459553301`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.7547651977906001`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.444547745955329`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.7547651977905988`", " ", "\[ImaginaryI]"}]}]},
     {"7", "0.6871232182590145`", "0.6871232182590151`"},
     {"8", "1.1229455183892003`", "1.1229455183892019`"},
     {"9", "1.8744104254027254`", "1.8744104254027294`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {Automatic, {"Projected", "Embedded"}}]]]], "Output",
 CellChangeTimes->{
  3.8917231127726097`*^9, 3.891723183945209*^9, {3.8917232470798273`*^9, 
   3.891723283342074*^9}, 3.891723374344584*^9, 3.89172347899257*^9, {
   3.891723512283669*^9, 3.891723523010449*^9}, 3.891723760948975*^9},
 CellLabel->
  "Out[140]//TableForm=",ExpressionUUID->"3687a552-c7f7-482e-8f5c-\
e4876a0ba9b9"]
}, Open  ]],

Cell["Once more with feeling.", "Text",
 CellChangeTimes->{{3.891724739368474*^9, 
  3.891724744373261*^9}},ExpressionUUID->"fd010459-636a-47ca-9e4b-\
1dbce9cadc7c"],

Cell["Other way", "Text",
 CellChangeTimes->{{3.891723048537304*^9, 
  3.891723050302065*^9}},ExpressionUUID->"0d4eb160-7df2-42f4-86f2-\
2b9c57fe04e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Ambient", " ", "dimension", " ", "m", " ", "and", " ", "c", " ", 
    "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "c"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"12", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "Constraint", " ", "Matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "orth", " ", "basis", " ", "for", " ", "null", " ", 
     "space"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NG", "=", 
     RowBox[{
      RowBox[{"NullSpace", "[", "G", "]"}], "\[Transpose]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"G", ".", "NG"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "NG"}], "-", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"m", "-", "c"}], "]"}]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Build", " ", "symmetric", " ", "test", " ", "matrices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M0", ",", "M1"}], "}"}], "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "+", 
          RowBox[{"#", "\[Transpose]"}]}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"M0", ",", "M1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "evals", " ", "two", " ", "ways"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Projected", " ", "and", " ", "Embedded"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P\[Lambda]s", ",", "Pvs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M0", ".", "NG"}], ",", 
         RowBox[{
          RowBox[{"NG", "\[Transpose]"}], ".", "M1", ".", "NG"}]}], "}"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroCxC", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "c"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tol", "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "7"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "1"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E\[Lambda]s", ",", "Evs"}], "}"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"M0Hat", ",", "M1Hat"}], "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{"ArrayFlatten", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{"M0", "+", 
                 RowBox[{"\[Eta]", " ", 
                  RowBox[{
                   RowBox[{"G", "\[Transpose]"}], ".", "G"}]}]}], "0"},
               {"0", "ZeroCxC"}
              }], "\[NoBreak]", ")"}], ",", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"M1", 
                RowBox[{"G", "\[Transpose]"}]},
               {"G", "0"}
              }], "\[NoBreak]", ")"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sort", ",", 
        RowBox[{"{", 
         RowBox[{"P\[Lambda]s", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"E\[Lambda]s", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "#", "]"}], ">", "Tol"}], "&"}]}], "]"}]}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Projected\>\"", ",", "\"\<Embedded\>\""}], "}"}]}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891420416474676*^9, 3.8914205185760765`*^9}, {
   3.8914205583234463`*^9, 3.8914206578717747`*^9}, {3.8914207066834865`*^9, 
   3.8914209381748877`*^9}, {3.891421041702095*^9, 3.891421525094863*^9}, {
   3.891723082021105*^9, 3.891723107995756*^9}, {3.891723179543005*^9, 
   3.891723282243202*^9}, {3.8917233609053802`*^9, 3.891723372888443*^9}, {
   3.891723495729394*^9, 3.891723522500473*^9}, {3.891724751537125*^9, 
   3.891724801739609*^9}, 3.891724853821349*^9},
 CellLabel->
  "In[291]:=",ExpressionUUID->"36b8b60b-e950-4998-a064-34c581b4a9c6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"Projected\"\>",
       HoldForm], 
      TagBox["\<\"Embedded\"\>",
       HoldForm]},
     {"1", 
      RowBox[{"-", "1.6367462982639944`"}], 
      RowBox[{"-", "1.6367462982639944`"}]},
     {"2", 
      RowBox[{
       RowBox[{"-", "0.24599916541402744`"}], "-", 
       RowBox[{"1.2061266553579673`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24599916541402775`"}], "-", 
       RowBox[{"1.2061266553579684`", " ", "\[ImaginaryI]"}]}]},
     {"3", 
      RowBox[{
       RowBox[{"-", "0.24599916541402742`"}], "+", 
       RowBox[{"1.2061266553579675`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2459991654140277`"}], "+", 
       RowBox[{"1.206126655357968`", " ", "\[ImaginaryI]"}]}]},
     {"4", 
      RowBox[{"0.3197063821820819`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.507030188549438`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3197063821820727`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.5070301885494377`", " ", "\[ImaginaryI]"}]}]},
     {"5", 
      RowBox[{"0.31970638218208197`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.5070301885494386`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.31970638218207276`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.507030188549438`", " ", "\[ImaginaryI]"}]}]},
     {"6", 
      RowBox[{"0.3435210537493856`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3462149799639906`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.34352105374938563`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3462149799639901`", " ", "\[ImaginaryI]"}]}]},
     {"7", 
      RowBox[{"0.3435210537493856`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.34621497996399064`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3435210537493857`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3462149799639901`", " ", "\[ImaginaryI]"}]}]},
     {"8", 
      RowBox[{"0.6256968176113313`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.5954049469642657`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6256968176113348`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.5954049469642613`", " ", "\[ImaginaryI]"}]}]},
     {"9", 
      RowBox[{"0.6256968176113314`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.5954049469642655`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.6256968176113348`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.5954049469642617`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {Automatic, {"Projected", "Embedded"}}]]]], "Output",
 CellChangeTimes->{3.891724803226853*^9, 3.891724854356325*^9},
 CellLabel->
  "Out[302]//TableForm=",ExpressionUUID->"d9d430ac-a7bc-4bb4-ad04-\
99accb97534a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Det", ",", 
   RowBox[{"{", 
    RowBox[{"M0Hat", ",", "M1Hat"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891723455343411*^9, 3.891723458747257*^9}, {
   3.891723645918872*^9, 3.891723656384965*^9}, 3.891723756288917*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"c66ee199-4746-44a7-816e-beed4b49075d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"-", "3029.5030982827157`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8917234602249813`*^9, {3.89172365117419*^9, 3.891723657306163*^9}, 
   3.8917237679300623`*^9, {3.891724864774569*^9, 3.891724887846599*^9}},
 CellLabel->
  "Out[304]=",ExpressionUUID->"39c038d3-52e6-402d-8061-73e8b8b689a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GEV Idea Test", "Title",
 CellChangeTimes->{{3.8637048303114505`*^9, 3.8637048307664013`*^9}, {
  3.8911579287549715`*^9, 
  3.891157932470579*^9}},ExpressionUUID->"46447238-1fd7-4f26-bfff-\
bbe0b1a5ce95"],

Cell[CellGroupData[{

Cell["\<\
Rebuild and Test of TRS GEV Pencil
2n\[Times]2n\
\>", "Section",
 CellChangeTimes->{{3.891158267260401*^9, 3.891158281623568*^9}, {
  3.8913302977500453`*^9, 
  3.891330302275751*^9}},ExpressionUUID->"d994ab91-81bc-4fe6-894a-\
ddc0e8781b62"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"m", "=", "12"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M0", " ", "=", " ", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "B"}], "A"},
       {"A", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"g", ",", "g"}], "]"}]}], "/", 
         SuperscriptBox["\[CapitalDelta]", "2"]}]}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "B"},
       {"B", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"{", 
         RowBox[{"M0", ",", "M1"}], "}"}], "]"}], "]"}], "\[Transpose]"}], 
     "]"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2"}], "}"}], "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"vs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinGEV", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sign", "[", 
      RowBox[{"g", ".", "y2"}], "]"}]}], " ", "\[CapitalDelta]", " ", 
    FractionBox["y1", 
     SqrtBox[
      RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cons", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", ".", "B", ".", "p"}], "-", 
    SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{
        RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinFM", "=", 
   RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEV"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFM"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<GEV\>\"", ",", "\"\<FindMin\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
  3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
  3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
  3.891159718097969*^9, 3.8911597239419985`*^9}, {3.891201389415576*^9, 
  3.8912014063404417`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"4e533ed1-01f4-4967-874c-5c63b09773d1"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{{3.891159484088401*^9, 3.8911596905619855`*^9}, 
   3.8911597247540092`*^9, {3.8912014009194593`*^9, 3.891201406972322*^9}, 
   3.891332966780595*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"b28bebb3-99b1-4fba-88d4-6416ec5f0872"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"obj\"\>",
       HoldForm], 
      TagBox["\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\[CapitalDelta]\\), \
\\(2\\)]\\)\"\>",
       HoldForm]},
     {
      TagBox["\<\"GEV\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "1.0162894172793466`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "1.3114509478384662`*^-15"}]},
     {
      TagBox["\<\"FindMin\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "1.016289518134475`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], "9.999099666313516`*^-9"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"GEV", "FindMin"}, {
      "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \
\(2\)]\)"}}]]]], "Output",
 CellChangeTimes->{{3.891159484088401*^9, 3.8911596905619855`*^9}, 
   3.8911597247540092`*^9, {3.8912014009194593`*^9, 3.891201406972322*^9}, 
   3.8913329668274274`*^9},
 CellLabel->
  "Out[157]//TableForm=",ExpressionUUID->"f1cfb393-7107-46cf-93aa-\
76d789c6a067"]
}, Open  ]],

Cell["Making functions.", "Text",
 CellChangeTimes->{{3.8911981354478683`*^9, 3.891198139111229*^9}, {
  3.891201352161872*^9, 
  3.8912013564506483`*^9}},ExpressionUUID->"747411c8-14cd-4e8f-8738-\
9c55506493c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TRSMatrices", "[", 
   RowBox[{"A_", ",", "B_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"M0", " ", "and", " ", "M1"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", " ", 
     RowBox[{"ArrayFlatten", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "B"}], "A"},
           {"A", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{"g", ",", "g"}], "]"}]}], "/", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}
          }], "\[NoBreak]", ")"}], ",", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "B"},
           {"B", "0"}
          }], "\[NoBreak]", ")"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TRSMin", "[", 
   RowBox[{"A_", ",", "B_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", "M0", ",", "M1", ",", " ", 
      "\[Lambda]s", ",", "vs", ",", "y1", ",", "y2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M0", ",", "M1"}], "}"}], "=", 
      RowBox[{"TRSMatrices", "[", 
       RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Does", " ", "not", " ", "treat", " ", "or", " ", "test", " ", "the", 
       " ", "hard", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"Eigensystem", "[", 
           RowBox[{"{", 
            RowBox[{"M0", ",", "M1"}], "}"}], "]"}], "]"}], "\[Transpose]"}], 
        "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"vs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "constrained", " ", "argmin"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"g", ".", "y2"}], "]"}], " ", "\[CapitalDelta]", " ", 
       FractionBox["y1", 
        SqrtBox[
         RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891197026175281*^9, 3.8911970537294292`*^9}, {
   3.891198063283886*^9, 3.891198116956263*^9}, {3.891198152400576*^9, 
   3.891198156420858*^9}, {3.8912011092910137`*^9, 3.891201120368774*^9}, {
   3.8912011652902527`*^9, 3.891201341068706*^9}, 3.8912015378256283`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"0f4db8f3-02b3-4fd3-836d-7185279190f4"],

Cell["Testing the function", "Text",
 CellChangeTimes->{{3.891198171438075*^9, 
  3.891198175027*^9}},ExpressionUUID->"0bc700a7-d6ee-4eec-b804-a60f6ac33615"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "\[CapitalDelta]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "0.2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "+", 
      RowBox[{"A", "\[Transpose]"}]}], ",", 
     RowBox[{"B", ".", 
      RowBox[{"B", "\[Transpose]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinGEV", "=", 
   RowBox[{"TRSMin", "[", 
    RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "Cons", ",", "x", ",", "p"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cons", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", ".", "B", ".", "p"}], "-", 
    SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vars", ",", "vars0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"x", ",", "m"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{
        RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}]}], 
    "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinFM", "=", 
   RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEV"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFM"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<GEV\>\"", ",", "\"\<FindMin\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\""}], "}"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8912010509895277`*^9, 3.8912011043852997`*^9}, {
   3.8912014334810133`*^9, 3.891201524871825*^9}, 3.891201555673394*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"df415178-5535-438f-955a-ed17225cf8d0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"obj\"\>",
       HoldForm], 
      TagBox["\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\[CapitalDelta]\\), \
\\(2\\)]\\)\"\>",
       HoldForm]},
     {
      TagBox["\<\"GEV\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "8.418132675074633`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "2.0816681711721685`*^-17"}]},
     {
      TagBox["\<\"FindMin\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "8.418133003490892`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], "1.723395044728182`*^-9"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"GEV", "FindMin"}, {
      "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \
\(2\)]\)"}}]]]], "Output",
 CellChangeTimes->{
  3.8912014898199377`*^9, {3.8912015257440653`*^9, 3.891201556213834*^9}, 
   3.891206582315587*^9, 3.891332966960575*^9},
 CellLabel->
  "Out[170]//TableForm=",ExpressionUUID->"0554cfd3-1bc0-4830-b292-\
535f64d4e395"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Rebuild and Test of TRS GEV Pencil
(2n+1)\[Times](2n+1)\
\>", "Section",
 CellChangeTimes->{{3.891158267260401*^9, 3.891158281623568*^9}, {
  3.8913302977500453`*^9, 
  3.8913303220128174`*^9}},ExpressionUUID->"13907e7d-4868-4b40-b1f1-\
f9bc860a81e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M0", " ", "=", " ", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SuperscriptBox["\[CapitalDelta]", "2"], "0", 
        RowBox[{"{", "g", "}"}]},
       {"0", 
        RowBox[{"-", "B"}], "A"},
       {
        RowBox[{
         RowBox[{"{", "g", "}"}], "\[Transpose]"}], "A", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}], "0", "0"},
       {"0", "0", "B"},
       {"0", "B", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"{", 
         RowBox[{"M0", ",", "M1"}], "}"}], "]"}], "]"}], "\[Transpose]"}], 
     "]"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]Pick", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1y2", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{
     "vs", "\[LeftDoubleBracket]", "\[Lambda]Pick", "\[RightDoubleBracket]"}],
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2"}], "}"}], "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"y1y2", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinGEV", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sign", "[", 
      RowBox[{"g", ".", "y2"}], "]"}]}], " ", "\[CapitalDelta]", " ", 
    FractionBox["y1", 
     SqrtBox[
      RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cons", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", ".", "B", ".", "p"}], "-", 
    SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{
        RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinFM", "=", 
   RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEV"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFM"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<GEV\>\"", ",", "\"\<FindMin\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
  3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
  3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
  3.891159718097969*^9, 3.8911597239419985`*^9}, {3.891201389415576*^9, 
  3.8912014063404417`*^9}, {3.8913303374768305`*^9, 3.8913304062255383`*^9}, {
  3.8913313121452975`*^9, 3.8913313661966763`*^9}, {3.8913314021282344`*^9, 
  3.8913315394907627`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b0c99f22-8da4-4647-adb2-2c65c73cfcd4"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"obj\"\>",
       HoldForm], 
      TagBox["\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\[CapitalDelta]\\), \
\\(2\\)]\\)\"\>",
       HoldForm]},
     {
      TagBox["\<\"GEV\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "1.3679734716846346`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "2.220446049250313`*^-16"}]},
     {
      TagBox["\<\"FindMin\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "1.3679736808071359`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], "9.999565397933452`*^-9"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"GEV", "FindMin"}, {
      "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \
\(2\)]\)"}}]]]], "Output",
 CellChangeTimes->{{3.891159484088401*^9, 3.8911596905619855`*^9}, 
   3.8911597247540092`*^9, {3.8912014009194593`*^9, 3.891201406972322*^9}, 
   3.8913313742437787`*^9, {3.8913315056858425`*^9, 3.891331550127491*^9}, 
   3.891331618546112*^9},
 CellLabel->
  "Out[112]//TableForm=",ExpressionUUID->"5388358a-1219-47c0-9fae-\
114274dec7f3"]
}, Open  ]],

Cell["Making functions.", "Text",
 CellChangeTimes->{{3.8911981354478683`*^9, 3.891198139111229*^9}, {
  3.891201352161872*^9, 
  3.8912013564506483`*^9}},ExpressionUUID->"17fb08b8-5a00-4557-9def-\
27a945f26b1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TRSMatricesBig", "[", 
   RowBox[{"A_", ",", "B_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"M0", " ", "and", " ", "M1"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", " ", 
     RowBox[{"ArrayFlatten", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            SuperscriptBox["\[CapitalDelta]", "2"], "0", 
            RowBox[{"{", "g", "}"}]},
           {"0", 
            RowBox[{"-", "B"}], "A"},
           {
            RowBox[{
             RowBox[{"{", "g", "}"}], "\[Transpose]"}], "A", "0"}
          }], "\[NoBreak]", ")"}], ",", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"{", 
             RowBox[{"{", "0", "}"}], "}"}], "0", "0"},
           {"0", "0", "B"},
           {"0", "B", "0"}
          }], "\[NoBreak]", ")"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TRSMinBig", "[", 
   RowBox[{"A_", ",", "B_", ",", "g_", ",", "\[CapitalDelta]_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", "M0", ",", "M1", ",", " ", 
      "\[Lambda]s", ",", "vs", ",", "y1", ",", "y2", ",", "\[Lambda]Pick"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M0", ",", "M1"}], "}"}], "=", 
      RowBox[{"TRSMatricesBig", "[", 
       RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Does", " ", "not", " ", "treat", " ", "or", " ", "test", " ", "the", 
       " ", "hard", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"Eigensystem", "[", 
           RowBox[{"{", 
            RowBox[{"M0", ",", "M1"}], "}"}], "]"}], "]"}], "\[Transpose]"}], 
        "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "ComplexInfinity", " ", "eigenvalues", " ", "sorst", " ", 
       "to", " ", "the", " ", 
       RowBox[{"back", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "We", " ", "want", " ", "the", " ", "first", " ", "eigenvector"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]Pick", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "bits", " ", "to", " ", "build", " ", "p", " ", "from", " ",
        "y1", " ", "and", " ", "y2", " ", "are", " ", "at", " ", "the", " ", 
       "back"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2"}], "}"}], "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{
          "vs", "\[LeftDoubleBracket]", "\[Lambda]Pick", 
           "\[RightDoubleBracket]"}], ",", "1"}], "]"}], ",", "m"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "constrained", " ", "argmin"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"g", ".", "y2"}], "]"}], " ", "\[CapitalDelta]", " ", 
       FractionBox["y1", 
        SqrtBox[
         RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891197026175281*^9, 3.8911970537294292`*^9}, {
   3.891198063283886*^9, 3.891198116956263*^9}, {3.891198152400576*^9, 
   3.891198156420858*^9}, {3.8912011092910137`*^9, 3.891201120368774*^9}, {
   3.8912011652902527`*^9, 3.891201341068706*^9}, 3.8912015378256283`*^9, {
   3.8913315230026884`*^9, 3.8913315257267094`*^9}, {3.891331596728571*^9, 
   3.891331611920113*^9}, {3.891331730248604*^9, 3.891331874081168*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"dd8bf56a-a2c2-4b9b-8679-9b5b484a2e65"],

Cell["Testing the function", "Text",
 CellChangeTimes->{{3.891198171438075*^9, 
  3.891198175027*^9}},ExpressionUUID->"28d7fae7-96ed-4818-9912-94aecccc808c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "\[CapitalDelta]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "0.2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "+", 
      RowBox[{"A", "\[Transpose]"}]}], ",", 
     RowBox[{"B", ".", 
      RowBox[{"B", "\[Transpose]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinGEV", "=", 
   RowBox[{"TRSMin", "[", 
    RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinGEVBig", "=", 
   RowBox[{"TRSMinBig", "[", 
    RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "Cons", ",", "x", ",", "p"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cons", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", ".", "B", ".", "p"}], "-", 
    SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vars", ",", "vars0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"x", ",", "m"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{
        RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}]}], 
    "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinFM", "=", 
   RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEV"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEVBig"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFM"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<GEV Small\>\"", ",", "\"\<GEV Big\>\"", ",", "\"\<FindMin\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\""}], "}"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8912010509895277`*^9, 3.8912011043852997`*^9}, {
   3.8912014334810133`*^9, 3.891201524871825*^9}, 3.891201555673394*^9, {
   3.8913318848124037`*^9, 3.8913318853969393`*^9}, {3.8913328922846007`*^9, 
   3.8913329486214933`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"0332f1e7-1f64-4bb0-9476-ebc19639e5a5"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"obj\"\>",
       HoldForm], 
      TagBox["\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\[CapitalDelta]\\), \
\\(2\\)]\\)\"\>",
       HoldForm]},
     {
      TagBox["\<\"GEV Small\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "0.7875628171974676`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "1.8041124150158794`*^-16"}]},
     {
      TagBox["\<\"GEV Big\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "0.7875628171974673`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "9.020562075079397`*^-17"}]},
     {
      TagBox["\<\"FindMin\"\>",
       HoldForm], 
      TagBox[
       StyleBox[
        RowBox[{"-", "0.787562795687489`"}],
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], 
      RowBox[{"-", "3.0994043581644704`*^-9"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, 
      "Rows" -> {False, True, {False}, False}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"GEV Small", "GEV Big", "FindMin"}, {
      "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \
\(2\)]\)"}}]]]], "Output",
 CellChangeTimes->{
  3.8912014898199377`*^9, {3.8912015257440653`*^9, 3.891201556213834*^9}, 
   3.891206582315587*^9, 3.8913318866094675`*^9, 3.8913329511569834`*^9, {
   3.891332983319067*^9, 3.89133301255826*^9}},
 CellLabel->
  "Out[218]//TableForm=",ExpressionUUID->"2e0c0bb8-1a4f-4185-bfb2-\
063856c48124"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["KKT Matrix with Equality Constraints", "Section",
 CellChangeTimes->{{3.8912066043517036`*^9, 
  3.891206626627975*^9}},ExpressionUUID->"60a5f5da-15b3-458c-b484-\
5002f49d27d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"13", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "G"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"#", ",", "m"}], "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "c"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KKT", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"A", 
        RowBox[{"G", "\[Transpose]"}]},
       {"G", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p\[Mu]", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"KKT", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"g", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "c"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "\[Mu]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p\[Mu]", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"p\[Mu]", ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"G", ".", "p"}], ",", 
     RowBox[{
      RowBox[{"A", ".", "p"}], "+", 
      RowBox[{
       RowBox[{"G", "\[Transpose]"}], ".", "\[Mu]"}], "-", "g"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.891206629271367*^9, 3.891206991965*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"c276f689-6e62-4542-b296-cb7ad62a0010"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.503339263697051`*^-16", ",", "1.5039322214409698`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.891206921341748*^9, 3.891206933824107*^9}, {
  3.8912069714537363`*^9, 3.891206992550634*^9}},
 CellLabel->
  "Out[156]=",ExpressionUUID->"f8f08a1f-6dad-469d-bbfc-053361f04011"]
}, Open  ]],

Cell[TextData[{
 "The solution does not depend on the \[OpenCurlyDoubleQuote]size\
\[CloseCurlyDoubleQuote] of G.  I get exactly the same answer if I scale ",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", "\[Rule]", 
    RowBox[{"\[Epsilon]", " ", "G"}]}], TraditionalForm]],ExpressionUUID->
  "68ccb88e-0b3d-4887-a15c-04600d434933"],
 ". The p stays the same.  The multipliers \[Mu] get scaled by 1/\[Epsilon].  \
If I make the scaling too small I will get warnings from the condition number \
estimator.   "
}], "Text",
 CellChangeTimes->{{3.8912070488013353`*^9, 3.891207115670437*^9}, {
  3.891207369297389*^9, 
  3.891207480506366*^9}},ExpressionUUID->"9bd83819-5b28-4765-9f2e-\
8a28508f662e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"13", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "G"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"#", ",", "m"}], "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "c"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KKT", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"A", 
        RowBox[{"G", "\[Transpose]"}]},
       {"G", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p\[Mu]", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"KKT", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"g", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "c"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "\[Mu]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p\[Mu]", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"p\[Mu]", ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KKT1", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"A", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"G", "\[Transpose]"}]}]},
       {
        RowBox[{"\[Epsilon]", " ", "G"}], "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p\[Mu]1", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"KKT1", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"g", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "c"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "\[Mu]1"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p\[Mu]1", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"p\[Mu]1", ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "-", "p1"}], ",", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"\[Epsilon]", " ", "\[Mu]1"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891206629271367*^9, 3.891206991965*^9}, {
  3.89120713408731*^9, 3.891207178441345*^9}, {3.89120720887352*^9, 
  3.891207308488881*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"6b710b25-c5a2-42ea-ac74-c4d62b33d551"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.141885466107214`*^-15", ",", "2.2805558275220606`*^-15"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.891207269681637*^9, 3.891207309273129*^9}},
 CellLabel->
  "Out[211]=",ExpressionUUID->"3b99c271-33b3-43c9-b2e8-160ac00fbbc8"]
}, Open  ]],

Cell[TextData[{
 "Minimizing ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", ".", "A", ".", "p"}], TraditionalForm]],ExpressionUUID->
  "48cbbefc-928b-4ed2-b8ec-cbfe46c6e5ba"],
 " is basically the same as minimizing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"p", "\[Mu]"}
      }], ")"}], ".", 
    RowBox[{"(", GridBox[{
       {"A", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"G", "\[Transpose]"}]}]},
       {
        RowBox[{"\[Epsilon]", " ", "G"}], "0"}
      }], ")"}], ".", 
    RowBox[{"(", GridBox[{
       {"p"},
       {"\[Mu]"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "afde1742-14ae-4ca9-a402-0bdf80596e02"],
 " when \[Epsilon] is small and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", ".", "p"}], TraditionalForm]],ExpressionUUID->
  "52c586ef-7af3-46a7-9e95-9726bbf19435"],
 " is small.  The plan is to use the scaled KKT matrix in the objective with \
the extended trust region matrix  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"B", "0"},
      {"0", 
       RowBox[{"\[Gamma]", " ", 
        StyleBox[
         RowBox[{"I", 
          StyleBox["c",
           FontSize->14]}]]}]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "09b13a0d-db4b-488f-9a34-464d08c79080"],
 " for a small \[Gamma].  Essentially as \[Gamma] goes to zero we are turning \
off the penalization on the multiplier \[Mu]."
}], "Text",
 CellChangeTimes->{{3.891207527779192*^9, 3.8912075340269136`*^9}, {
  3.8912075706624203`*^9, 
  3.891208010354651*^9}},ExpressionUUID->"e2b6a685-6a57-4c21-917d-\
f106ce79e2d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extend and Test of TRS GEV Pencil", "Section",
 CellChangeTimes->{{3.891158267260401*^9, 3.891158281623568*^9}, {
  3.8911597070800643`*^9, 3.8911597088850517`*^9}, {3.8914298890053406`*^9, 
  3.8914298946772366`*^9}, {3.891723803978698*^9, 
  3.891723805860125*^9}},ExpressionUUID->"38c93bc3-8c8d-459f-bc0c-\
8370e7573a78"],

Cell[TextData[{
 "I can enforce the constraint ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"G", ".", "p"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "82b8db6d-5a9e-4267-aace-3fedb07e3b66"],
 " and incorporate the multiplier term ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"G", "\[Transpose]"}], ".", "\[Mu]"}], TraditionalForm]],
  ExpressionUUID->"40ede987-25df-47b7-b6f7-75a96adb8d69"],
 " by adding the extra blocks.  I am going to do this for the small envelope \
first."
}], "Text",
 CellChangeTimes->{{3.891333083007651*^9, 3.891333136530443*^9}, {
  3.891429226311514*^9, 3.8914292343762827`*^9}, {3.891429276834447*^9, 
  3.891429300744096*^9}},ExpressionUUID->"f79d02fb-0099-4951-a093-\
04091615c5f4"],

Cell[CellGroupData[{

Cell["Small Envelope", "Subsection",
 CellChangeTimes->{{3.891429327299038*^9, 
  3.8914293307088833`*^9}},ExpressionUUID->"1d2f8529-0d23-4c2c-a23c-\
6b04db16eb4a"],

Cell["Padding on the natural \[Infinity] side!  This is a singular pencil!", \
"Text",
 CellChangeTimes->{{3.891723897636137*^9, 
  3.8917239157874413`*^9}},ExpressionUUID->"f5ed8483-cdb5-4d00-8bd4-\
fa6f608f7cea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Build", " ", "the", " ", "unconstrained", " ", "matrices"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Currently", " ", "as", " ", "dense"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "TRS", " ", "GEV", " ", "matrices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}], "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}], ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0", ",", "M1"}], "}"}], "=", 
   RowBox[{"TRSMatrices", "[", 
    RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M0Pad", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"2", "m"}]}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"2", "m"}]}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"M0", ",", "M1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "equality", " ", "constraint", " ", "matrices"}], 
   " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M0Pad", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "m"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "c"}]}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"G", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M0Pad", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", "m"}], "+", "1"}], ";;", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}]}], ",", " ", 
      RowBox[{"1", ";;", "m"}]}], "\[RightDoubleBracket]"}], "=", "G"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "Singularity"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Det", ",", 
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", "Crap", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 
   3.8911610505945854`*^9}, {3.8911611150059767`*^9, 3.891161122706355*^9}, {
   3.8913332622838755`*^9, 3.8913333554737234`*^9}, {3.8913334579841533`*^9, 
   3.8913339706006355`*^9}, {3.8913340115642605`*^9, 
   3.8913340278461714`*^9}, {3.891334059676729*^9, 3.8913343262946744`*^9}, 
   3.891334864245544*^9, 3.8913351942446156`*^9, {3.8913352897192163`*^9, 
   3.8913353713338547`*^9}, {3.891335474091853*^9, 3.8913355107311273`*^9}, {
   3.8913355431402674`*^9, 3.89133558199076*^9}, {3.891335668003044*^9, 
   3.891335784808885*^9}, {3.891429418170004*^9, 3.891429470959702*^9}, {
   3.8914299055427876`*^9, 3.8914301766536603`*^9}, {3.891431363116091*^9, 
   3.8914315925570087`*^9}, {3.8914318106351852`*^9, 3.891432182639606*^9}, {
   3.891433527764887*^9, 3.891433538585891*^9}, {3.891723822343265*^9, 
   3.891723889126965*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"d9c388c0-3874-445e-bc5a-213f9df8b9b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.9843900829944785`*^-15", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.891432150649175*^9, 3.891432183164728*^9}, {
   3.891433532305456*^9, 3.8914335392358093`*^9}, 3.8917238138664017`*^9, {
   3.8917238453242826`*^9, 3.891723871762931*^9}, 3.891723945508106*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"d02b66f6-9b66-4299-9d1f-cd0f7511efc6"]
}, Open  ]],

Cell["Pad on the other side!  This is also a singular pencil. ", "Text",
 CellChangeTimes->{{3.891723949447689*^9, 3.8917239532702417`*^9}, {
  3.891724329729946*^9, 
  3.891724340801771*^9}},ExpressionUUID->"fad55779-a88b-4fea-85e0-\
c61cff4e0aaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Build", " ", "the", " ", "unconstrained", " ", "matrices"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Currently", " ", "as", " ", "dense"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "TRS", " ", "GEV", " ", "matrices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}], "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}], ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0", ",", "M1"}], "}"}], "=", 
   RowBox[{"TRSMatrices", "[", 
    RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M0Pad", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}], ",", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}], ",", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"M0", ",", "M1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"MatrixPlot", ",", 
    RowBox[{"{", 
     RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "equality", " ", "constraint", " ", "matrices"}], 
   " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "m"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "c"}]}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"G", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "c"}]}], ",", " ", 
     RowBox[{"1", ";;", "m"}]}], "\[RightDoubleBracket]"}], "=", "G"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"MatrixPlot", ",", 
    RowBox[{"{", 
     RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "Singularity"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Det", ",", 
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", "Crap", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 
   3.8911610505945854`*^9}, {3.8911611150059767`*^9, 3.891161122706355*^9}, {
   3.8913332622838755`*^9, 3.8913333554737234`*^9}, {3.8913334579841533`*^9, 
   3.8913339706006355`*^9}, {3.8913340115642605`*^9, 
   3.8913340278461714`*^9}, {3.891334059676729*^9, 3.8913343262946744`*^9}, 
   3.891334864245544*^9, 3.8913351942446156`*^9, {3.8913352897192163`*^9, 
   3.8913353713338547`*^9}, {3.891335474091853*^9, 3.8913355107311273`*^9}, {
   3.8913355431402674`*^9, 3.89133558199076*^9}, {3.891335668003044*^9, 
   3.891335784808885*^9}, {3.891429418170004*^9, 3.891429470959702*^9}, {
   3.8914299055427876`*^9, 3.8914301766536603`*^9}, {3.891431363116091*^9, 
   3.8914315925570087`*^9}, {3.8914318106351852`*^9, 3.891432182639606*^9}, {
   3.891433527764887*^9, 3.891433538585891*^9}, {3.891723822343265*^9, 
   3.891723889126965*^9}, {3.891723967361517*^9, 3.8917239699171143`*^9}, {
   3.891724046358807*^9, 3.891724055954422*^9}, {3.891724146020699*^9, 
   3.891724167155933*^9}, {3.891724200962565*^9, 3.891724201652175*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"418bba3d-91b5-4a91-a490-20c7ba9a22e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1:eJztlH1MzHEcx+/CavKQqDzOuSIdWiRpHt4Sppbotk6KxsnKzUPWAyukRknM
6pLisNxVUyRPhzkipKK5dCrXWHVX3e93v99VpFsrj+Pf7x/3R/+Y7/bd5/Pv
67X35z1LvF+4awSHwxn99//e/7we/J//5lTt3ZpnndMBpyfM3RHuNOYdZvMV
Zxhc2fDY1zmfhU3weLcMpQlMURA/GN1oje7VlAWYkCqZpqgJYVEcYlZzgijY
7q+KXSJtQ6jaYbOK7gJnQZZyp5cRgynCMd4TTPAaEOQVHGYg526c7jalC3M8
qxfZjWVR+dRP5JtpQJ990m6vQi2kwjibZ7x3YERUkuBaG+6njzJUy2hITpg7
Po+thyG/TFzIb0P/wNIHha9oi3n5UmlHeEs7iq8VJC9VGCA7lJl9WW6E2Ltx
VpWOBjfzXKLMnUVkuSYpSmRC3/OG0rd9nVh/XHNrz1ca6ZVu5tkjWaKHLz9C
kh7N/8WL47dlegYuyXNvXXE1YOrNz9YLA1j04vS57NMU/N3tTwxSn1A7T7BL
6tqAkqy01nq3dhyVLs6tjaWJHizlFYZX5H5oa0bn6owoqVkPx23O05zOUrBZ
oltTuakJpaE+zcs99fjgyj1QVEcRPZDywM95nZySpcEFf4/vQ9p2VE2NZkXL
aAhmppbUl6ohtgv1uVvdiJaJLspH6QzRAykPlvJ2hocWOUpMsBdetE14w2JA
bvhYlkoTPZDyQLoLh3i1j/dlCjUM711uAoN1R0rcbSmW6IGUB9JdWMobIWjq
VmaYMKTr15j9TPBtkPSmPzRi+6mwwBiPVnRbqaw9+V2IdNjA9X5CY0rsypUx
awzoVx7Y4XzHiMk54+fo41g0lVMrxkU0Yl2x/Pw+lQ7CCWxMyhdq2PvBUl55
2NVtW4L0uHRGt5mJpzBJ5fJqBY9B8yC3KZHXjB23czca8/Sw4q73W3WDwir/
bz0FRe+RpqizKhTroAjTSmbYkT0Mdz9YyquOesFZu5xBy1rHOFEvi8GXJwN5
tSY82+pxcJlWi4rrC+PF2R34fk8+IFNTRA+kPAx3P1jK+7Yh4WCN+iOG6iYe
exndiX1p7xtHbqKJHkh5IN3FcPeDpbw/AU0alIo=
     "], {{0, 0}, {10, 10}}, {0, 1}],
    
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggmIQGwI+2I/Sw5OeVv7do+nia3u32cp7/255a29yhLXI
edk7+8mT878s6Xtjv9rY4mJG0jP7CM2jZ0+rXbL/s+uu7JPjb+0vPqsX6k9/
bR+mZLK1wuOJ/aL+ZHEP+/f2zo1cOzQT7th/WCXyd7pB8ID7D532XuR2Szjw
rf07k9Sr05e9tP/bdLMmovC+vV+u8YYUnzf2a8zfX/wu+9D+Wqmn9v1p5XB9
D6tE1rk/vAXlMzDgCoeB9h86XZmsfvSgwzt7PaG4+e4Gb+33nshWLnzzwl6j
iWdK+fLX9gsXHrYtzH9kv6CZI8PtyxKc4YArPQy0/9DpJw+W7Q2zf2MfseTT
hhnsT+3XvDyvWbn0JM5wwJUecOWLgfYfvenR8mG0fBgtH2hXPgAAV811TA==

     "], {{0, 0}, {10, 10}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891724030333126*^9, 3.8917240567141457`*^9}, 
   3.891724168016707*^9, 3.8917242029877243`*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"c26659ad-8953-4796-92d4-873f1f6ecaef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1:eJztlH1MzHEcx+/CavKQqDzOuSIdWiRpHt4Sppbotk6KxsnKzUPWAyukRknM
6pLisNxVUyRPhzkipKK5dCrXWHVX3e93v99VpFsrj+Pf7x/3R/+Y7/bd5/Pv
67X35z1LvF+4awSHwxn99//e/7we/J//5lTt3ZpnndMBpyfM3RHuNOYdZvMV
Zxhc2fDY1zmfhU3weLcMpQlMURA/GN1oje7VlAWYkCqZpqgJYVEcYlZzgijY
7q+KXSJtQ6jaYbOK7gJnQZZyp5cRgynCMd4TTPAaEOQVHGYg526c7jalC3M8
qxfZjWVR+dRP5JtpQJ990m6vQi2kwjibZ7x3YERUkuBaG+6njzJUy2hITpg7
Po+thyG/TFzIb0P/wNIHha9oi3n5UmlHeEs7iq8VJC9VGCA7lJl9WW6E2Ltx
VpWOBjfzXKLMnUVkuSYpSmRC3/OG0rd9nVh/XHNrz1ca6ZVu5tkjWaKHLz9C
kh7N/8WL47dlegYuyXNvXXE1YOrNz9YLA1j04vS57NMU/N3tTwxSn1A7T7BL
6tqAkqy01nq3dhyVLs6tjaWJHizlFYZX5H5oa0bn6owoqVkPx23O05zOUrBZ
oltTuakJpaE+zcs99fjgyj1QVEcRPZDywM95nZySpcEFf4/vQ9p2VE2NZkXL
aAhmppbUl6ohtgv1uVvdiJaJLspH6QzRAykPlvJ2hocWOUpMsBdetE14w2JA
bvhYlkoTPZDyQLoLh3i1j/dlCjUM711uAoN1R0rcbSmW6IGUB9JdWMobIWjq
VmaYMKTr15j9TPBtkPSmPzRi+6mwwBiPVnRbqaw9+V2IdNjA9X5CY0rsypUx
awzoVx7Y4XzHiMk54+fo41g0lVMrxkU0Yl2x/Pw+lQ7CCWxMyhdq2PvBUl55
2NVtW4L0uHRGt5mJpzBJ5fJqBY9B8yC3KZHXjB23czca8/Sw4q73W3WDwir/
bz0FRe+RpqizKhTroAjTSmbYkT0Mdz9YyquOesFZu5xBy1rHOFEvi8GXJwN5
tSY82+pxcJlWi4rrC+PF2R34fk8+IFNTRA+kPAx3P1jK+7Yh4WCN+iOG6iYe
exndiX1p7xtHbqKJHkh5IN3FcPeDpbw/AU0alIo=
     "], {{0, 0}, {10, 10}}, {0, 1}],
    
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggmIQe7vZEQ7JvHf2eix/aubcfmv/m/k7u/iqV/aCbWen
6Fq+s3fyvqa6RPitPfNv/fDPC1/Ye0l6Ty5ieGJ//k/eyseeL+1XxKxfLsT2
xj4qJkxu77U39r86Rd+vn/vcfsJxz9uX/l2zZwCDD4OGXtcu9uuj6Rv70rCi
6JZ7T+z5gmcyhyadsJfq19rwpeCt/VJ+ww5e+Vf2JfX1B/9/fGD/zfFC/PGO
N/bnhRaZH/J4Zp/1cnnHi4MX7V1YeCIS5t2z70o/Hfxg0TP7jw+WLOkpejXg
/kOnL/X7XZc+/sb+Qec64Yv27+yN1oXuO/zjnb34rPaJZ7+9tl/kMys++dRj
ewnPu+LlZ/bbp7/9uW/+6rf23b/8N+z788o+Mv3p7MVGj+2faW1xyK9+b9+1
fULp8he37S+Y2FaUpXkNuP/QaY8GgwhDlbf277UcHdI/vLAPafYt5TS+Y59d
0dk0leWtvYeSW87/tAf2f6IMywUZi+H6HlaJrHN/eAvKZ2DAFQ4D7T90Okdp
l9t6rnf2OXvZ0r4kv7G3EVPo+nnjmX3MqpjwGIM39u+n2M27YPnQvrL8dmCL
ZwXOcMCVHgbaf+h05Dfbcyz7X9v3BV86l3/tkX1D3Z/U+nMbcIYDrvSAK18M
tP/oTdO6fMBVTg5UfUHr8gFXfYGr3qS1f2ldPuCqN3G1H2jtX1qXD7jaD7ja
UQDOkPpC
     "], {{0, 0}, {10, 10}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891724030333126*^9, 3.8917240567141457`*^9}, 
   3.891724168016707*^9, 3.8917242030323772`*^9},
 CellLabel->
  "Out[273]=",ExpressionUUID->"7973e418-6d8a-4106-8f9f-3648a922b4fe"]
}, Open  ]],

Cell["Add the M0 perturbation", "Text",
 CellChangeTimes->{{3.891724915867634*^9, 
  3.891724923411972*^9}},ExpressionUUID->"dfa05c36-080f-42aa-8ae7-\
86785686a4db"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Build", " ", "the", " ", "unconstrained", " ", "matrices"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Currently", " ", "as", " ", "dense"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "TRS", " ", "GEV", " ", "matrices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}], "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}], ",", 
       RowBox[{
        RowBox[{"2", "m"}], "+", "c"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M0", ",", "M1"}], "}"}], "=", 
   RowBox[{"TRSMatrices", "[", 
    RowBox[{
     RowBox[{"A", "+", 
      RowBox[{"\[Eta]", " ", 
       RowBox[{
        RowBox[{"G", "\[Transpose]"}], ".", "G"}]}]}], ",", "B", ",", "g", 
     ",", "\[CapitalDelta]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M0Pad", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}], ",", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}], ",", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"M0", ",", "M1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"MatrixPlot", ",", 
    RowBox[{"{", 
     RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Insert", " ", "equality", " ", "constraint", " ", "matrices"}], 
   " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", "m"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "c"}]}]}], "\[RightDoubleBracket]"}], "=", 
   RowBox[{"G", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1Pad", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "c"}]}], ",", " ", 
     RowBox[{"1", ";;", "m"}]}], "\[RightDoubleBracket]"}], "=", "G"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{"MatrixPlot", ",", 
    RowBox[{"{", 
     RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "Singularity"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Det", ",", 
   RowBox[{"{", 
    RowBox[{"M0Pad", ",", "M1Pad"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", "Crap", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 
   3.8911610505945854`*^9}, {3.8911611150059767`*^9, 3.891161122706355*^9}, {
   3.8913332622838755`*^9, 3.8913333554737234`*^9}, {3.8913334579841533`*^9, 
   3.8913339706006355`*^9}, {3.8913340115642605`*^9, 
   3.8913340278461714`*^9}, {3.891334059676729*^9, 3.8913343262946744`*^9}, 
   3.891334864245544*^9, 3.8913351942446156`*^9, {3.8913352897192163`*^9, 
   3.8913353713338547`*^9}, {3.891335474091853*^9, 3.8913355107311273`*^9}, {
   3.8913355431402674`*^9, 3.89133558199076*^9}, {3.891335668003044*^9, 
   3.891335784808885*^9}, {3.891429418170004*^9, 3.891429470959702*^9}, {
   3.8914299055427876`*^9, 3.8914301766536603`*^9}, {3.891431363116091*^9, 
   3.8914315925570087`*^9}, {3.8914318106351852`*^9, 3.891432182639606*^9}, {
   3.891433527764887*^9, 3.891433538585891*^9}, {3.891723822343265*^9, 
   3.891723889126965*^9}, {3.891723967361517*^9, 3.8917239699171143`*^9}, {
   3.891724046358807*^9, 3.891724055954422*^9}, {3.891724146020699*^9, 
   3.891724167155933*^9}, {3.891724200962565*^9, 3.891724201652175*^9}, {
   3.891724942405727*^9, 3.8917250326324883`*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"354a7923-bd47-4388-9df5-19feedc8513f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1:eJztlH1Qy3Ecx6PTPOs5onlo56LLLblzxbwjjUIPJPNwzEPRkN1xNasuRJxO
OBtDiEM0V1NEnoo6D1HKQ9e1W1Y2tv1+vxW5lszmHP9+/9gf/eN87773+fz7
et378564YcfSJGcnJ6ehf//v/c/rwv/5b06OvS5T42qARXppn1VO4bjbfPbx
jQxSEht9kt4yWPsoeT3rBIXeXfKkw5U6HD3VXf5knhrlP98tZkr1WPGlUhTY
YYQywxBcsIWBYY07f7/diBihJqf3ghYao2dd4SEKAWucV8gM7dAGshTI2QtZ
SPc1+YQGhJTqbVOmaMH+mj6Q40PhYW7TG218I6JS+e7cXS3IspfNWLaAxre+
ZSM9e15jj26UmnFtxVlan+A/hHaYtzbV1iB+0YHLg7Iu+5wxoPqYXXX6HIV4
cY1cms9A6reuvSDfhDxbmFeQZwcGcK8HiUoY8PoWCqJZFMrG3LniFvOR6GGT
PsBiCaUhbk+LjuS2I4W39W7UcAlybxdzV/IasDB0iC42oA3VH8OLErZSmDp+
X3GTshEbXAWht543Q+3Bqbh/kCZ6cJQ32/JSM26mGZm50yObhzFYlSpUXT1i
gJuvNUtYZESzip1Zm0Fj9HW+nU0zRA+kPHiroqUL5tMoesvPC/HTY7jJZe62
2DqoV1vmiTRv4JIqS9s/qAPSiwXPVmebiB5IeXCUV/04sZAfRaFYEsazbmbQ
FziZvUdiJnog5YF0F5S4sfV8dT3qptmklXEfwC0W3FbOoYgeSHkg3YWjvBaP
G9X+vQweWBfd0/rReG+qMZRN+oQyxQ/KuU+LyNhgFkf2Gd++ZxxmBlAIUhoS
Wn3MSBf0VFXIaZRU6L03r/qMuO7QbTxZC7j+VQ/kTToIlAdY088a+70fHOUV
zl6n4LozeKrYXjhXZIbviLSlVrdOHDM/HZyw0gzX5FvGCUcYcB4qxnVrjDix
82bniLw2dM0qF4jOfYKk3qN1yQ4T0UN/94OjvGETT3qMyjbj/BPr1/KxZgSH
C8NfxVHgR4yNSLTr4bzb+6BSZEKMLT5ddZMmeiDlob/7wWHevdu9IpJ1WJ4l
uSrOMcL7Q/1UfgBN9EDKA+ku+rsfHOX9BZ2knjM=
     "], {{0, 0}, {10, 10}}, {0, 1}],
    
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggmIQGwI+2I/Sw5O25bAJPOt12V7UabatgPUje+ZrJ1l9
8l7Zr9N9lbam77W91JmFvnm3Htp3vVjr9dK/xn59V8fK2C9X7bWO3JXf1PHY
PsylcdJf5ldw8x5Wiaxzf3gLyoeBgfcnjJ6y4O7WJVzv7K24eSvPJL+x591X
s2HijWf2e9pvrvSfcdve+/RlQekTT+0jWJfc6/zw0v7nqYZ16YJv7fPlOv47
RT2wXxFf8T1mfRHBcBgstIvEp6WS+s/tvVxdo+PFXts7S/9p2iX+1v6cj1DD
621v7OPTnst3CT23f2D2+HDn7Ss4wwFXehho/6HTNQ9eH7X1fmOveODMvqXW
T+2vJp3Mem13Gmc44EoPuPLFQPuP3vRo+TBaPoyWD7QrHwAAEWjS
     "], {{0, 0}, {10, 
     10}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8917249709530582`*^9, 3.89172498641924*^9}, 
   3.891725033162685*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"6ecccce5-7554-4788-8550-a60e33f5f3d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[RasterBox[CompressedData["
1:eJztlH1Qy3Ecx6PTPOs5onlo56LLLblzxbwjjUIPJPNwzEPRkN1xNasuRJxO
OBtDiEM0V1NEnoo6D1HKQ9e1W1Y2tv1+vxW5lszmHP9+/9gf/eN87773+fz7
et378564YcfSJGcnJ6ehf//v/c/rwv/5b06OvS5T42qARXppn1VO4bjbfPbx
jQxSEht9kt4yWPsoeT3rBIXeXfKkw5U6HD3VXf5knhrlP98tZkr1WPGlUhTY
YYQywxBcsIWBYY07f7/diBihJqf3ghYao2dd4SEKAWucV8gM7dAGshTI2QtZ
SPc1+YQGhJTqbVOmaMH+mj6Q40PhYW7TG218I6JS+e7cXS3IspfNWLaAxre+
ZSM9e15jj26UmnFtxVlan+A/hHaYtzbV1iB+0YHLg7Iu+5wxoPqYXXX6HIV4
cY1cms9A6reuvSDfhDxbmFeQZwcGcK8HiUoY8PoWCqJZFMrG3LniFvOR6GGT
PsBiCaUhbk+LjuS2I4W39W7UcAlybxdzV/IasDB0iC42oA3VH8OLErZSmDp+
X3GTshEbXAWht543Q+3Bqbh/kCZ6cJQ32/JSM26mGZm50yObhzFYlSpUXT1i
gJuvNUtYZESzip1Zm0Fj9HW+nU0zRA+kPHiroqUL5tMoesvPC/HTY7jJZe62
2DqoV1vmiTRv4JIqS9s/qAPSiwXPVmebiB5IeXCUV/04sZAfRaFYEsazbmbQ
FziZvUdiJnog5YF0F5S4sfV8dT3qptmklXEfwC0W3FbOoYgeSHkg3YWjvBaP
G9X+vQweWBfd0/rReG+qMZRN+oQyxQ/KuU+LyNhgFkf2Gd++ZxxmBlAIUhoS
Wn3MSBf0VFXIaZRU6L03r/qMuO7QbTxZC7j+VQ/kTToIlAdY088a+70fHOUV
zl6n4LozeKrYXjhXZIbviLSlVrdOHDM/HZyw0gzX5FvGCUcYcB4qxnVrjDix
82bniLw2dM0qF4jOfYKk3qN1yQ4T0UN/94OjvGETT3qMyjbj/BPr1/KxZgSH
C8NfxVHgR4yNSLTr4bzb+6BSZEKMLT5ddZMmeiDlob/7wWHevdu9IpJ1WJ4l
uSrOMcL7Q/1UfgBN9EDKA+ku+rsfHOX9BZ2knjM=
     "], {{0, 0}, {10, 10}}, {0, 1}],
    
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggmIQu97xNWOi/jv777LdT+a8e2N/q1T59yLHF/Yxx1hS
3U++st9yZHn7Ivm39rqen7gbfd/ZM3K9qtg8/ba98wWBt++OP7W/MPHKovwP
L+11OW9LbU5+Zx9/883ewC1v7XmEk2MfO7+yZwCDD4OGvnbtiJJo3Fv7yL0L
w/Zcf2n/Yfp6i3qLB/bm17das759a+93tLfszufX9gd0eD9kbH1qP6nmJuu6
8Ef2W/V3fT0Z+cJez5v3VlL5a3sb5c8TWma9sRc5YJwdOu2ZvcLiKC/Wz5cG
3H/o9AuGo9IBGy7br3T05jyY88j+U5HdgbK4V/b23q7uwXVv7N+d2fom9s0D
e7YczSOrIsrsTW5kThbxvGrfctW276bJY/sTi7Sfb5FDxOPDKpF17g9vQfkw
MPD+hNFPDA/vE1rx1n76wg/ngt+/sv/PmGqwl/+xfdts2eB8oRv2c0UUXbkn
PbEvvSwvVLj+pf3LSD+Dg11v7U/Xay7LO3zfXnTWxmP8IfkEw2Gw0Je7m2WP
nHxm33bB+6H43Vf2C9il/Td8fWPPvXdzjxbTG/sL1RnbRP48tvexM7yskHsQ
ZzjgSg8D7T8M//qsDuQ4/No+zXWjw9/nj+wVtr3uWfJoI85wwJUecOWLgfYf
vWlalw+4ysmBqi9oXT7gqi9w1Zu09i+tywdc9Sau9gPN/Uvj8gFX+wFXOwoA
bgn4sg==
     "], {{0, 0}, {10, 10}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}, {{9.5, 
         FormBox["1", TraditionalForm]}, {8.5, 
         FormBox["2", TraditionalForm]}, {7.5, 
         FormBox["3", TraditionalForm]}, {6.5, 
         FormBox["4", TraditionalForm]}, {5.5, 
         FormBox["5", TraditionalForm]}, {4.5, 
         FormBox["6", TraditionalForm]}, {3.5, 
         FormBox["7", TraditionalForm]}, {2.5, 
         FormBox["8", TraditionalForm]}, {1.5, 
         FormBox["9", TraditionalForm]}, {0.5, 
         FormBox["10", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}, {7.5, 
         FormBox["8", TraditionalForm]}, {8.5, 
         FormBox["9", TraditionalForm]}, {9.5, 
         FormBox["10", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8917249709530582`*^9, 3.89172498641924*^9}, 
   3.891725033206147*^9},
 CellLabel->
  "Out[348]=",ExpressionUUID->"48e68e1d-3a8b-42da-923c-4e54134124c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8917249709530582`*^9, 3.89172498641924*^9}, 
   3.891725033219902*^9},
 CellLabel->
  "Out[349]=",ExpressionUUID->"08b3870d-2054-4170-851c-2d4756c480fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Big Envelope", "Subsection",
 CellChangeTimes->{{3.8914293076563573`*^9, 
  3.8914293136087465`*^9}},ExpressionUUID->"656d64e7-8640-4666-a533-\
f9bd9e7dad3b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"B", "=", 
   RowBox[{"B", ".", 
    RowBox[{"B", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Build", " ", "the", " ", "unconstrained", " ", "matrices"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M0Big", ",", "M1Big"}], "}"}], "=", 
    RowBox[{"TRSMatricesBig", "[", 
     RowBox[{"A", ",", "B", ",", "g", ",", "\[CapitalDelta]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Initialize", " ", "the", " ", "expanded", " ", "Equality", " ", 
    "Constrained", " ", "Matrices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M0Eq", "=", 
     RowBox[{"M1Eq", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "m"}], "+", "1", "+", "c"}], ",", 
          RowBox[{
           RowBox[{"2", "m"}], "+", "1", "+", "c"}]}], "}"}]}], "]"}]}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Dense", " ", "for", " ", "testing"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M0Eq", "=", 
    RowBox[{"M1Eq", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "m"}], "+", "1", "+", "c"}], ",", 
         RowBox[{
          RowBox[{"2", "m"}], "+", "1", "+", "c"}]}], "}"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Copy", " ", "the", " ", "old", " ", "bits", " ", "in"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M0Eq", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}]}], ",", 
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
   "M0Big"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1Eq", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}]}], ",", 
     RowBox[{"1", ";;", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
   "M1Big"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"MatrixPlot", ",", 
     RowBox[{"{", 
      RowBox[{"M0Eq", ",", "M1Eq"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "the", " ", "new", " ", "bits"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M0Eq", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{"1", "+", 
       RowBox[{"2", "m"}], "+", "c"}]}], ",", 
     RowBox[{"2", ";;", 
      RowBox[{"m", "+", "1"}]}]}], "\[RightDoubleBracket]"}], "=", "G"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M0Eq", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"m", "+", "1"}]}], ",", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"2", "m"}], "+", "1"}], ";;", 
       RowBox[{"1", "+", 
        RowBox[{"2", "m"}], "+", "c"}]}]}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"G", "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Try", " ", "a", " ", "regularization", " ", "\[Epsilon]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"0.0", " ", "1.0", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M1Eq", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], ";;", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"-", "c"}], ";;", 
       RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{"IdentityMatrix", "[", "c", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "reference", " ", "solution", " ", "using", " ", 
    "FindMin"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "Cons", ",", "x", ",", "p"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cons", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", ".", "B", ".", "p"}], "-", 
    SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vars", ",", "vars0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"x", ",", "m"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
          SuperscriptBox["\[CapitalDelta]", "2"]}], ",", 
         RowBox[{
          RowBox[{"G", ".", "vars"}], "==", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "c"}], "]"}]}]}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}]}], 
    "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pMinFMEq", "=", 
    RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Test", " ", "new", " ", "code"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"{", 
          RowBox[{"M0Eq", ",", "M1Eq"}], "}"}], "]"}], "]"}], 
       "\[Transpose]"}], "]"}], "\[Transpose]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "ComplexInfinity", " ", "eigenvalues", " ", "sorst", " ", "to",
     " ", "the", " ", 
    RowBox[{"back", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"We", " ", "want", " ", "the", " ", "first", " ", "eigenvector"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{"vs", ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]Pick", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\[Lambda]s", "\[LeftDoubleBracket]", "\[Lambda]Pick", 
    "\[RightDoubleBracket]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1y2\[Mu]", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{
     "vs", "\[LeftDoubleBracket]", "\[Lambda]Pick", "\[RightDoubleBracket]"}],
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y1", ",", "y2"}], "}"}], ",", "\[Mu]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"y1y2\[Mu]", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", 
         RowBox[{"2", "m"}]}], "\[RightDoubleBracket]"}], ",", "m"}], "]"}], 
     ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"y1y2\[Mu]", ",", 
       RowBox[{"1", "m"}]}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pMinGEVEq", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sign", "[", 
       RowBox[{"g", ".", "y2"}], "]"}]}], " ", "\[CapitalDelta]", " ", 
     FractionBox["y1", 
      SqrtBox[
       RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"compare", " ", "answers"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}], ",", 
        RowBox[{"G", ".", "p"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFMEq"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"Cons", "[", "p", "]"}], ",", 
        RowBox[{"G", ".", "p"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEVEq"}]}]}], "\[IndentingNewLine]", "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<FindMin\>\"", ",", "\"\<GEV+\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\"", ",", "\"\<cons: G.p\>\""}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 
   3.8911610505945854`*^9}, {3.8911611150059767`*^9, 3.891161122706355*^9}, {
   3.8913332622838755`*^9, 3.8913333554737234`*^9}, {3.8913334579841533`*^9, 
   3.8913339706006355`*^9}, {3.8913340115642605`*^9, 
   3.8913340278461714`*^9}, {3.891334059676729*^9, 3.8913343262946744`*^9}, 
   3.891334864245544*^9, 3.8913351942446156`*^9, {3.8913352897192163`*^9, 
   3.8913353713338547`*^9}, {3.891335474091853*^9, 3.8913355107311273`*^9}, {
   3.8913355431402674`*^9, 3.89133558199076*^9}, {3.891335668003044*^9, 
   3.891335784808885*^9}},
 CellLabel->
  "In[1098]:=",ExpressionUUID->"2426f0da-c824-4a8f-a71f-b09a1202ade2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "8.950258324399753`"}], "-", 
  RowBox[{"14.757430394855673`", " ", "\[ImaginaryI]"}]}]], "Print",
 CellChangeTimes->{
  3.89133572716551*^9, {3.891335760364188*^9, 3.891335785874089*^9}},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"f6e34982-51ce-4aa7-961e-48f25192c61c"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0.`\\\"]\\) \
encountered.\"", 2, 1125, 25, 31966805988732491345, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.891335785874089*^9},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"7fa2e638-8f73-4fe8-9a5b-4e2b7c42d2ee"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 1125, 26, 
   31966805988732491345, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8913357858897257`*^9},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"a7017223-93da-4c96-a9cd-a8feb89acc3f"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 1125, 27, 
   31966805988732491345, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8913357859053335`*^9},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"af9c8e70-599f-4256-a6d9-9959e3ba8778"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 1125, 28, 
   31966805988732491345, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8913357859053335`*^9},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"73006b84-6010-4c67-b563-62c7181c726c"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Infinity\\\", \
\\\"::\\\", \\\"indet\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 1125, 29, 31966805988732491345, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8913357859209538`*^9},
 CellLabel->
  "During evaluation of \
In[1098]:=",ExpressionUUID->"8bbc2e9e-42fc-4816-875e-4ecf2d109d3e"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {"\<\"\"\>", "\<\"obj\"\>", "\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\
\[CapitalDelta]\\), \\(2\\)]\\)\"\>", "\<\"cons: G.p\"\>"},
    {"\<\"FindMin\"\>", 
     TagBox[
      StyleBox[
       RowBox[{"-", "0.3213020234746587`"}],
       ShowSpecialCharacters->False,
       ShowStringCharacters->True,
       NumberMarks->True],
      FullForm], 
     RowBox[{"-", "1.0330738861585864`*^-8"}], GridBox[{
       {
        RowBox[{"-", "1.6479873021779667`*^-16"}]},
       {"4.85722573273506`*^-17"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}]},
    {"\<\"GEV+\"\>", 
     TagBox[
      StyleBox["Indeterminate",
       ShowSpecialCharacters->False,
       ShowStringCharacters->True,
       NumberMarks->True],
      FullForm], "Indeterminate", GridBox[{
       {"Indeterminate"},
       {"Indeterminate"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}]}
   },
   GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  TableForm[{{
     FullForm[-0.3213020234746587], -1.0330738861585864`*^-8, \
{-1.6479873021779667`*^-16, 4.85722573273506*^-17}}, {
     FullForm[Indeterminate], Indeterminate, {Indeterminate, Indeterminate}}},
    TableHeadings -> {{"FindMin", "GEV+"}, {
     "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)", 
      "cons: G.p"}}]]], "Output",
 CellChangeTimes->{{3.8913341009130983`*^9, 3.891334124932065*^9}, {
   3.8913342168801765`*^9, 3.8913342684707174`*^9}, {3.891334314652765*^9, 
   3.8913343432021294`*^9}, {3.891335427403569*^9, 3.891335476188092*^9}, 
   3.8913355123165107`*^9, {3.891335544892027*^9, 3.891335583539667*^9}, 
   3.89133567481701*^9, 3.89133572716551*^9, {3.89133576037981*^9, 
   3.8913357859366083`*^9}},
 CellLabel->
  "Out[1126]//TableForm=",ExpressionUUID->"a860c518-6c9c-41bd-908f-\
74723c801b3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "vs", "]"}]], "Input",
 CellEvaluationLanguage->"Python",
 CellChangeTimes->{{3.891333301659644*^9, 3.891333316560957*^9}, {
  3.8913358029185553`*^9, 3.891335806860419*^9}},
 CellLabel->
  "In[1127]:=",ExpressionUUID->"4b2a9006-57c9-40f8-b72e-2e7ecb3841d8"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztmfk3VX37x0WGNCkqVEijEkIqQ++oDKHSrQxpImVKd4ZCcUvImEiaVKjc
lSiphAbJkBQyz85xjuOcffbeaJBCnvOs7/P9/gH3eta3u3vZa5312medH861
1/Van+t9rT3P8fA2ZxEhIaHZ//n8+/5/rj6McYz/TdosU5DvzCLhLZP1wqaX
g4rh1HfyVnVojWnR92P2QkdVJa13biv2xh98Pmq15KfXO8Z/Jp+FN9jeeUSi
yiKv/I5EDxxuL/oj+1Ed/I0PKTzr64VPrcLtK6MtKAz6t4eyP73eMf4z+Zl5
5oJ3Pgmn0OK6oXk9YGzNWGEqW/9/vzMDZLJMmC3/+f6/18+ve4z/LC4xMGkw
KCTBLajqtNTrweJv6uyO42MejvH/l1GT1pp/XNyE5vs3hhOS2ej8IKY08x4P
ryMk2tNdq5G/uMVrhUgTainX03a25E+vd4z/TFqss195anwT9qu5XdKNZsOg
cs1QcvaYh/9tXth9dN8nNoWiGsP5u+v5iNJQF5E90I3vG13poh4SKSoimvO4
PdhqaHz86vwmSAwM0CwFwf6oYTqU7c9GgKbJlLVmJXhb5DWdm05BV1RGi08Q
mMIJS9w4ngUj82jO3ngKh8/t4cRfIqC9bo1apkYXXt720F/Op1BTrsVlk3z8
eU/9ldmNbozLWvn6Xk09vnDWLNL2Y+Ga5ev6tRMIiHYcqo0bpPBYonW2vyIJ
q5zSBc2LBPsrjNqOvOfi6eeK0kQhEn90Wn/jpVHYUZmZFlpDwWhlrE5uHB9N
UeEG5AM2JnBfndt4gUJjqtD7hvsENi2Tz73k1oVDA1oRdWktsGtoGM0L6cYa
/zt1m8t42B7CKhByImFQm2geJ6jvasnHT1a/V2JWkrlD8kAVREcC6DtTW3A/
ZlTZesKYh3+V88kW81kXacgdyhrYFEBjap37hXpjErYcTZvv7zl4FCNj599J
wNm+Plj+K4nI9TFzhYeZsNXqyBlcyAXnsdD5C7Z8rPSdQBRokVihyGI31bFh
Uf9y/4aZb8ArnK3TK1WPmmS19F1yLKwKtSw7uphAItsqKSWKQnW39aSpwQQ0
Ppl1WtFMrKibsynhA4mwY94TZp3uQWrtecWPtxrwtPKKfgmnHRbWKyYPe3LQ
dVpr+pPfCEhNYnxmhVI40vCH3z43AgrGDv30YyY8Y3X0l9fx4TwxOGJAkwWP
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
   "], {{0, 0}, {27, 
   27}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{26.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["27", TraditionalForm]}}, {{26.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["27", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {26.5, 
       FormBox["27", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {26.5, 
       FormBox["27", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.8913333045319605`*^9, 3.891333317434104*^9}, 
   3.8913358073144913`*^9},
 CellLabel->
  "Out[1127]=",ExpressionUUID->"16cfb199-3730-46d0-a092-42169a84b84a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M0Big", " ", "=", " ", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Placeholder]", "\[Placeholder]", "0"},
       {"\[Placeholder]", "\[Placeholder]", "0"},
       {"0", "0", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "c"}], "}"}]}], "]"}]}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1Big", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "B", 
        RowBox[{"G", "\[Transpose]"}]},
       {"B", "0", "0"},
       {"G", "0", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]s", ",", "vs"}], "}"}], " ", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"{", 
         RowBox[{"M0Big", ",", "M1Big"}], "}"}], "]"}], "]"}], 
      "\[Transpose]"}], "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", "\[Lambda]s"}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
  3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
  3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
  3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
  3.8911608479937553`*^9}, {3.8911608987257805`*^9, 3.8911610505945854`*^9}, {
  3.8911611150059767`*^9, 3.891161122706355*^9}, {3.8913332622838755`*^9, 
  3.891333297683409*^9}},ExpressionUUID->"bb860915-db85-4ee8-ad6a-\
fb1523443126"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.8359872215112554`"}], ",", 
   RowBox[{
    RowBox[{"-", "2.0190977614550945`"}], "+", 
    RowBox[{"0.2248678611595409`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.0190977614550945`"}], "-", 
    RowBox[{"0.22486786115954094`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.130949031239055`"}], "-", 
    RowBox[{"2.306591391534587`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1309490312390549`"}], "+", 
    RowBox[{"2.3065913915345866`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.4185305714353619`"}], "-", 
    RowBox[{"0.08425675219936322`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.4185305714353619`"}], "+", 
    RowBox[{"0.08425675219936322`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.32351057089545837`"}], "+", 
    RowBox[{"0.22945378485129156`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3235105708954583`"}], "-", 
    RowBox[{"0.2294537848512916`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1468438512975131`"}], "+", 
    RowBox[{"5.337860085251038`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1468438512975131`"}], "-", 
    RowBox[{"5.337860085251039`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.08791002553368382`"}], "-", 
    RowBox[{"0.027189276751300877`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.08791002553368381`"}], "+", 
    RowBox[{"0.027189276751300874`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"-", "0.0665248395547953`"}], ",", 
   RowBox[{"-", "2.3764792834049333`*^-8"}], ",", "2.3764797373868795`*^-8", 
   ",", 
   RowBox[{"0.15930218475474725`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.03130063311065055`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.15930218475474725`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.03130063311065055`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.20431608946137622`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.196460665557991`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.20431608946137622`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.19646066555799102`", " ", "\[ImaginaryI]"}]}], ",", 
   "0.25652461409090366`", ",", "0.8059659622489143`", ",", 
   "1.2950447284841522`", ",", "1.7263484890503635`", ",", 
   "2.7508709723457803`", ",", "ComplexInfinity", ",", "ComplexInfinity"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.891161123245805*^9},
 CellLabel->
  "Out[915]=",ExpressionUUID->"aa42f0ff-0468-4552-831a-0e7fe1999c4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2"}], "}"}], "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"vs", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", 
       RowBox[{"1", ";;", 
        RowBox[{"2", "m"}]}]}], "\[RightDoubleBracket]"}], ",", "m"}], 
    "]"}]}], ";", 
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"vs", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ";;", 
      RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Dimensions", ",", 
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2", ",", "\[Lambda]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 3.8911609747307034`*^9}, 
   3.8911611071085033`*^9, {3.8911611446012783`*^9, 3.891161189845758*^9}},
 CellLabel->
  "In[928]:=",ExpressionUUID->"ed009157-c7da-4112-82f3-77749a497cdf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "12", "}"}], ",", 
   RowBox[{"{", "12", "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8911611700802593`*^9, 3.891161190464594*^9}},
 CellLabel->
  "Out[929]=",ExpressionUUID->"e6846b94-ac2f-47d9-b309-801d5932a28a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"NewV", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"{", 
      RowBox[{"M0Big", ",", "M1Big"}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"NewV", "\[LeftDoubleBracket]", 
    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"vv", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"{", 
   RowBox[{"M0Big", ",", "M1Big"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8911612022684555`*^9, 3.891161245387888*^9}, {
  3.891161280542579*^9, 3.891161503079666*^9}, {3.891161672561303*^9, 
  3.891161690398555*^9}},
 CellLabel->
  "In[960]:=",ExpressionUUID->"7e0f526d-cd35-414d-a78f-455d46fdf184"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1: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
5Bs=
   "], {{0, 0}, {27, 27}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{26.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["27", TraditionalForm]}}, {{26.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["27", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {26.5, 
       FormBox["27", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {26.5, 
       FormBox["27", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.8911613630127473`*^9, 3.8911615039107227`*^9}, 
   3.8911616910705376`*^9},
 CellLabel->
  "Out[960]=",ExpressionUUID->"d318e3cd-36af-458d-aadb-2b4d5f8e1d55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ComplexInfinity", ",", "ComplexInfinity", ",", 
   RowBox[{
    RowBox[{"-", "0.1468438512975131`"}], "-", 
    RowBox[{"5.337860085251039`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1468438512975131`"}], "+", 
    RowBox[{"5.337860085251038`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3.8359872215112554`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.7508709723457803`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.130949031239055`"}], "-", 
    RowBox[{"2.306591391534587`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1309490312390549`"}], "+", 
    RowBox[{"2.3065913915345866`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.0190977614550945`"}], "+", 
    RowBox[{"0.2248678611595409`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.0190977614550945`"}], "-", 
    RowBox[{"0.22486786115954094`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.7263484890503635`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.2950447284841522`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.8059659622489143`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.4185305714353637`"}], "-", 
    RowBox[{"0.08425675219935086`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.41853057143536365`"}], "+", 
    RowBox[{"0.08425675219935086`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3235105708954578`"}], "+", 
    RowBox[{"0.22945378485129422`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.32351057089545776`"}], "-", 
    RowBox[{"0.22945378485129422`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.2043160894613767`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.19646066555798924`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.20431608946137667`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.19646066555798924`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.25652461409090394`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1593021847547471`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.031300633110650525`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.15930218475474708`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.031300633110650525`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.08791002553368378`"}], "-", 
    RowBox[{"0.027189276751300846`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.08791002553368375`"}], "+", 
    RowBox[{"0.027189276751300846`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.0665248395547953`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.376502513988377`*^-8", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.3765020601308273`*^-8"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8911613630127473`*^9, 3.8911615039107227`*^9}, 
   3.8911616910894747`*^9},
 CellLabel->
  "Out[963]=",ExpressionUUID->"f9601368-c208-40f8-8375-c123fb8248c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pMinGEV", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sign", "[", 
      RowBox[{"g", ".", "y2"}], "]"}]}], " ", "\[CapitalDelta]", " ", 
    FractionBox["y1", 
     SqrtBox[
      RowBox[{"y1", ".", "B", ".", "y1"}]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "p_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", 
    RowBox[{"p", ".", "A", ".", "p"}]}], " ", "+", " ", 
   RowBox[{"g", ".", "p"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECons", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{"p", ".", "B", ".", "p"}], "-", 
   SuperscriptBox["\[CapitalDelta]", "2"], " "}]}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, {3.8911608987257805`*^9, 3.8911609747307034`*^9}, 
   3.8911611071085033`*^9, 3.8911611446012783`*^9},
 CellLabel->
  "In[930]:=",ExpressionUUID->"94f6ce39-04d0-44a7-86fb-12e15e82b471"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0.`\\\"]\\) \
encountered.\"", 2, 930, 25, 31965676770374066680, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8911609560084023`*^9, {3.8911611319449687`*^9, 3.8911611530186872`*^9}, 
   3.8911611936016192`*^9},
 CellLabel->
  "During evaluation of \
In[930]:=",ExpressionUUID->"fa73fa59-1e9a-4a2e-b754-123a47d58929"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 930, 26, 
   31965676770374066680, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8911609560084023`*^9, {3.8911611319449687`*^9, 3.8911611530186872`*^9}, 
   3.891161193617445*^9},
 CellLabel->
  "During evaluation of \
In[930]:=",ExpressionUUID->"62e9a27a-a241-4d23-84c6-bca46b1e594e"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 930, 27, 
   31965676770374066680, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8911609560084023`*^9, {3.8911611319449687`*^9, 3.8911611530186872`*^9}, 
   3.8911611936309423`*^9},
 CellLabel->
  "During evaluation of \
In[930]:=",ExpressionUUID->"bf2a7a55-f409-46a4-81e2-5a62c3f7ba8c"],

Cell[BoxData[
 TemplateBox[{
  "Infinity", "indet", 
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"", 2, 930, 28, 
   31965676770374066680, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8911609560084023`*^9, {3.8911611319449687`*^9, 3.8911611530186872`*^9}, 
   3.891161193640122*^9},
 CellLabel->
  "During evaluation of \
In[930]:=",ExpressionUUID->"fc7c29cc-dd42-4bc9-a9a4-b4165bbc1202"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Infinity\\\", \
\\\"::\\\", \\\"indet\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 930, 29, 31965676770374066680, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8911609560084023`*^9, {3.8911611319449687`*^9, 3.8911611530186872`*^9}, 
   3.8911611936491327`*^9},
 CellLabel->
  "During evaluation of \
In[930]:=",ExpressionUUID->"6b9c80c9-2254-4476-bd5a-b2517f9f152b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FMVal", ",", "FMinSub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"0.5", " ", 
         RowBox[{"vars", ".", "A", ".", "vars"}]}], " ", "+", " ", 
        RowBox[{"g", ".", "vars"}]}], ",", 
       RowBox[{
        RowBox[{"vars", ".", "B", ".", "vars"}], "<=", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "vars0"}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pMinFM", "=", 
   RowBox[{"vars", "/.", "FMinSub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"ECons", "[", "p", "]"}], ",", 
        RowBox[{"G", ".", "p"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinGEV"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FullForm", "[", 
         RowBox[{"f", "[", "p", "]"}], "]"}], ",", 
        RowBox[{"ECons", "[", "p", "]"}]}], "}"}], "/.", 
      RowBox[{"p", "->", "pMinFM"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<GEV\>\"", ",", "\"\<FindMin\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<obj\>\"", ",", 
        "\"\<cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \(2\)]\)\>\
\""}], "}"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891157943494712*^9, 3.8911583374915676`*^9}, {
   3.8911584767949595`*^9, 3.891158564891435*^9}, {3.8911587793984823`*^9, 
   3.8911593927644067`*^9}, {3.8911594282288585`*^9, 3.891159641275349*^9}, {
   3.8911597999668646`*^9, 3.8911598225984945`*^9}, {3.891160735254941*^9, 
   3.8911608479937553`*^9}, 
   3.8911608987257805`*^9},ExpressionUUID->"c6514092-9aff-4d1c-a395-\
f7137ec33805"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {"\<\"\"\>", "\<\"obj\"\>", "\<\"cons: p.B.p-\\!\\(\\*SuperscriptBox[\\(\
\[CapitalDelta]\\), \\(2\\)]\\)\"\>", "\<\"\"\>"},
    {"\<\"GEV\"\>", 
     TagBox[
      StyleBox[
       RowBox[{"-", "0.0037792862236048367`"}],
       ShowSpecialCharacters->False,
       ShowStringCharacters->True,
       NumberMarks->True],
      FullForm], 
     RowBox[{"-", "6.938893903907228`*^-18"}], GridBox[{
       {
        RowBox[{"-", "0.07042592623187173`"}]},
       {"0.09406812177509752`"},
       {"0.14742566065456095`"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.1]}, 
          Offset[0.2]}}]},
    {"\<\"FindMin\"\>", 
     TagBox[
      StyleBox[
       RowBox[{"-", "0.2819151495540593`"}],
       ShowSpecialCharacters->False,
       ShowStringCharacters->True,
       NumberMarks->True],
      FullForm], "9.997908244352427`*^-9", "\<\"\"\>"}
   },
   GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  TableForm[{{
     FullForm[-0.0037792862236048367`], -6.938893903907228*^-18, \
{-0.07042592623187173, 0.09406812177509752, 0.14742566065456095`}}, {
     FullForm[-0.2819151495540593], 9.997908244352427*^-9}}, 
   TableHeadings -> {{"GEV", "FindMin"}, {
     "obj", "cons: p.B.p-\!\(\*SuperscriptBox[\(\[CapitalDelta]\), \
\(2\)]\)"}}]]], "Output",
 CellChangeTimes->{{3.891159484088401*^9, 3.8911596905619855`*^9}, {
  3.891160791045274*^9, 3.891160810372386*^9}},
 CellLabel->
  "Out[837]//TableForm=",ExpressionUUID->"6d962995-8560-4ddd-af51-\
c3f4b0424c6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Partition"}]], "Input",
 CellChangeTimes->{{3.8911608510584693`*^9, 3.8911608542743483`*^9}},
 CellLabel->
  "In[838]:=",ExpressionUUID->"6592a3e4-c749-499c-a767-d5fc0b075ee3"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{26., {8., 18.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{26., {8., 18.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Partition",
              ButtonNote->"paclet:ref/Partition"],
             "\"paclet:ref/Partition\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) partitions \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\
\\\"]\\) into nonoverlapping sublists of length \\!\\(\\*StyleBox[\\\"n\\\", \
\\\"TI\\\"]\\). \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"], \\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) \
generates sublists with offset \\!\\(\\*StyleBox[\\\"d\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\
\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}]}], \\\"]\\\"}]\\) partitions a nested list into blocks of size \
\\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\
\"TR\\\"]]\\)\[Times]\\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]\\)\[Times]\[Ellipsis].\\n\\!\\(\\*RowBox[{\\\
\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"n\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"d\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}]}], \\\"]\\\"}]\\) uses offset \\!\\(\\*SubscriptBox[StyleBox[\\\"d\\\", \
\\\"TI\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]\\) at level \
\\!\\(\\*StyleBox[\\\"i\\\", \\\"TI\\\"]\\) in \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) specifies \
that the first element of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) \
should appear at position \\!\\(\\*SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"L\\\", \\\"TI\\\"]]\\) in the first sublist, and \
the last element of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) should \
appear at or after position \\!\\(\\*SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"R\\\", \\\"TI\\\"]]\\) in the last sublist. If \
additional elements are needed, Partition fills them in by treating \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) as cyclic. \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) pads if necessary by \
repeating the element \\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\
\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) pads if \
necessary by cyclically repeating the elements \
\\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \\\
\"TI\\\"]]\\). \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"], \\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"L\\\", \\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"]\\\"}]\\) uses no padding, and so can \
yield sublists of different lengths. \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \
\\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\
\"nlist\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"dlist\\\", \\\"TI\\\"], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"klist\\\", \\\
\"TI\\\"], StyleBox[\\\"L\\\", \\\"TI\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"klist\\\", \\\"TI\\\"], StyleBox[\\\"R\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"padlist\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) specifies alignments and padding in a nested \
list. \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/Partition", 
                    "paclet:ref/Partition", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/Partition.\
html"], None}, "http://reference.wolfram.com/language/ref/Partition.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`Partition\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{20., {3., 17.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{20., {3., 17.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{13., {4., 9.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{13., {4., 9.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Partition",
              ButtonNote->"paclet:ref/Partition"],
             "\"paclet:ref/Partition\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) partitions \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\
\\\"]\\) into nonoverlapping sublists of length \\!\\(\\*StyleBox[\\\"n\\\", \
\\\"TI\\\"]\\). \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"], \\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) \
generates sublists with offset \\!\\(\\*StyleBox[\\\"d\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\
\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}]}], \\\"]\\\"}]\\) partitions a nested list into blocks of size \
\\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\
\"TR\\\"]]\\)\[Times]\\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]\\)\[Times]\[Ellipsis].\\n\\!\\(\\*RowBox[{\\\
\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"n\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"d\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}]}], \\\"]\\\"}]\\) uses offset \\!\\(\\*SubscriptBox[StyleBox[\\\"d\\\", \
\\\"TI\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]\\) at level \
\\!\\(\\*StyleBox[\\\"i\\\", \\\"TI\\\"]\\) in \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) specifies \
that the first element of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) \
should appear at position \\!\\(\\*SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"L\\\", \\\"TI\\\"]]\\) in the first sublist, and \
the last element of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) should \
appear at or after position \\!\\(\\*SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"R\\\", \\\"TI\\\"]]\\) in the last sublist. If \
additional elements are needed, Partition fills them in by treating \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) as cyclic. \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"x\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) pads if necessary by \
repeating the element \\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"L\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\
\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) pads if \
necessary by cyclically repeating the elements \
\\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \\\
\"TI\\\"]]\\). \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"], \\\",\\\", StyleBox[\\\"d\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], \
StyleBox[\\\"L\\\", \\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"R\\\", \\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", \\\"}\\\"}]}], \\\"]\\\"}]\\) uses no padding, and so can \
yield sublists of different lengths. \\n\\!\\(\\*RowBox[{\\\"Partition\\\", \
\\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\
\"nlist\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"dlist\\\", \\\"TI\\\"], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"klist\\\", \\\
\"TI\\\"], StyleBox[\\\"L\\\", \\\"TI\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"klist\\\", \\\"TI\\\"], StyleBox[\\\"R\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"padlist\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) specifies alignments and padding in a nested \
list. \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {3., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"Partition\", \"[\", RowBox[{StyleBox[\"list\", \"TI\"], \
\",\", StyleBox[\"n\", \"TI\"]}], \"]\"}]\) partitions \
\!\(\*StyleBox[\"list\", \"TI\"]\) into nonoverlapping sublists of length \
\!\(\*StyleBox[\"n\", \"TI\"]\). \n\!\(\*RowBox[{\"Partition\", \"[\", \
RowBox[{StyleBox[\"list\", \"TI\"], \",\", StyleBox[\"n\", \"TI\"], \",\", \
StyleBox[\"d\", \"TI\"]}], \"]\"}]\) generates sublists with offset \
\!\(\*StyleBox[\"d\", \"TI\"]\). \n\!\(\*RowBox[{\"Partition\", \"[\", \
RowBox[{StyleBox[\"list\", \"TI\"], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\"2\", \"TR\"]], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}]}], \"]\"}]\) partitions a nested \
list into blocks of size \!\(\*SubscriptBox[StyleBox[\"n\", \"TI\"], \
StyleBox[\"1\", \"TR\"]]\)\[Times]\!\(\*SubscriptBox[StyleBox[\"n\", \"TI\"], \
StyleBox[\"2\", \"TR\"]]\)\[Times]\[Ellipsis].\n\!\(\*RowBox[{\"Partition\", \
\"[\", RowBox[{StyleBox[\"list\", \"TI\"], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\"2\", \"TR\"]], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"2\", \"TR\"]], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}]}], \"]\"}]\) uses offset \
\!\(\*SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"i\", \"TI\"]]\) at \
level \!\(\*StyleBox[\"i\", \"TI\"]\) in \!\(\*StyleBox[\"list\", \"TI\"]\). \
\n\!\(\*RowBox[{\"Partition\", \"[\", RowBox[{StyleBox[\"list\", \"TI\"], \",\
\", StyleBox[\"n\", \"TI\"], \",\", StyleBox[\"d\", \"TI\"], \",\", \
RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"L\", \
\"TI\"]], \",\", SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"R\", \
\"TI\"]]}], \"}\"}]}], \"]\"}]\) specifies that the first element of \
\!\(\*StyleBox[\"list\", \"TI\"]\) should appear at position \
\!\(\*SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"L\", \"TI\"]]\) in the \
first sublist, and the last element of \!\(\*StyleBox[\"list\", \"TI\"]\) \
should appear at or after position \!\(\*SubscriptBox[StyleBox[\"k\", \
\"TI\"], StyleBox[\"R\", \"TI\"]]\) in the last sublist. If additional \
elements are needed, Partition fills them in by treating \
\!\(\*StyleBox[\"list\", \"TI\"]\) as cyclic. \n\!\(\*RowBox[{\"Partition\", \
\"[\", RowBox[{StyleBox[\"list\", \"TI\"], \",\", StyleBox[\"n\", \"TI\"], \
\",\", StyleBox[\"d\", \"TI\"], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"L\", \"TI\"]], \
\",\", SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"R\", \"TI\"]]}], \
\"}\"}], \",\", StyleBox[\"x\", \"TI\"]}], \"]\"}]\) pads if necessary by \
repeating the element \!\(\*StyleBox[\"x\", \"TI\"]\). \n\
\!\(\*RowBox[{\"Partition\", \"[\", RowBox[{StyleBox[\"list\", \"TI\"], \
\",\", StyleBox[\"n\", \"TI\"], \",\", StyleBox[\"d\", \"TI\"], \",\", \
RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"L\", \
\"TI\"]], \",\", SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"R\", \
\"TI\"]]}], \"}\"}], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"2\", \"TR\"]], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}]}], \"]\"}]\) pads if necessary \
by cyclically repeating the elements \!\(\*SubscriptBox[StyleBox[\"x\", \
\"TI\"], StyleBox[\"i\", \"TI\"]]\). \n\!\(\*RowBox[{\"Partition\", \"[\", \
RowBox[{StyleBox[\"list\", \"TI\"], \",\", StyleBox[\"n\", \"TI\"], \",\", \
StyleBox[\"d\", \"TI\"], \",\", RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\
\"k\", \"TI\"], StyleBox[\"L\", \"TI\"]], \",\", SubscriptBox[StyleBox[\"k\", \
\"TI\"], StyleBox[\"R\", \"TI\"]]}], \"}\"}], \",\", RowBox[{\"{\", \
\"}\"}]}], \"]\"}]\) uses no padding, and so can yield sublists of different \
lengths. \n\!\(\*RowBox[{\"Partition\", \"[\", RowBox[{StyleBox[\"list\", \
\"TI\"], \",\", StyleBox[\"nlist\", \"TI\"], \",\", StyleBox[\"dlist\", \
\"TI\"], \",\", RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"klist\", \
\"TI\"], StyleBox[\"L\", \"TI\"]], \",\", SubscriptBox[StyleBox[\"klist\", \
\"TI\"], StyleBox[\"R\", \"TI\"]]}], \"}\"}], \",\", StyleBox[\"padlist\", \
\"TI\"]}], \"]\"}]\) specifies alignments and padding in a nested list. ", 
    "Documentation" -> <|
     "Local" -> "paclet:ref/Partition", "Web" -> 
      "http://reference.wolfram.com/language/ref/Partition.html"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, "Attributes" -> {Protected}, 
    "FullName" -> "System`Partition"|>, False]]], "Output",
 CellChangeTimes->{3.8911608548241873`*^9},
 CellLabel->
  "Out[838]=",ExpressionUUID->"cb39e1a4-af35-42bd-9603-9495c9db48e6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1138.8, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>2. Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c42bfd28-31a0-4a73-ae12-ae1ef1c633b7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 194, "Title",ExpressionUUID->"eb397758-b218-461d-bbec-a3b78019da81"],
Cell[754, 27, 3873, 125, 705, "Text",ExpressionUUID->"3162fbf9-8516-421d-93aa-cf6361954012"],
Cell[4630, 154, 202, 4, 69, "Text",ExpressionUUID->"ee09febe-7ac2-4994-918b-8cd5948369b2"],
Cell[CellGroupData[{
Cell[4857, 162, 5005, 149, 923, "Input",ExpressionUUID->"d1d5185a-247c-4fe0-a36b-24a99c3dd57c"],
Cell[9865, 313, 595, 11, 95, "Output",ExpressionUUID->"6150da7e-3856-4e20-8d28-9442cdaf085c"],
Cell[10463, 326, 2837, 70, 392, "Output",ExpressionUUID->"b2a2226d-04fc-4910-bca2-d0b271a52659"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13337, 401, 291, 7, 81, "Input",ExpressionUUID->"033d06dc-ceb7-47fc-8b63-535f94a5ff82"],
Cell[13631, 410, 241, 5, 89, "Output",ExpressionUUID->"d030edff-56e0-4625-bd9e-7f0f448043ca"]
}, Open  ]],
Cell[13887, 418, 151, 3, 69, "Text",ExpressionUUID->"bfcb348e-db0d-419d-ba8e-04b38c8dad7b"],
Cell[CellGroupData[{
Cell[14063, 425, 5307, 155, 964, "Input",ExpressionUUID->"ef1fd1d6-b909-42d4-9354-d619b831f7e0"],
Cell[19373, 582, 439, 9, 95, "Output",ExpressionUUID->"3cda4e91-da62-4e5e-8b27-db12cab7e51d"],
Cell[19815, 593, 2646, 66, 392, "Output",ExpressionUUID->"3687a552-c7f7-482e-8f5c-e4876a0ba9b9"]
}, Open  ]],
Cell[22476, 662, 165, 3, 69, "Text",ExpressionUUID->"fd010459-636a-47ca-9e4b-1dbce9cadc7c"],
Cell[22644, 667, 151, 3, 69, "Text",ExpressionUUID->"0d4eb160-7df2-42f4-86f2-2b9c57fe04e6"],
Cell[CellGroupData[{
Cell[22820, 674, 5756, 167, 1005, "Input",ExpressionUUID->"36b8b60b-e950-4998-a064-34c581b4a9c6"],
Cell[28579, 843, 3270, 77, 392, "Output",ExpressionUUID->"d9d430ac-a7bc-4bb4-ad04-99accb97534a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31886, 925, 359, 8, 81, "Input",ExpressionUUID->"c66ee199-4746-44a7-816e-beed4b49075d"],
Cell[32248, 935, 361, 8, 100, "Output",ExpressionUUID->"39c038d3-52e6-402d-8061-73e8b8b689a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32658, 949, 211, 4, 194, "Title",ExpressionUUID->"46447238-1fd7-4f26-bfff-bbe0b1a5ce95"],
Cell[CellGroupData[{
Cell[32894, 957, 251, 7, 210, "Section",ExpressionUUID->"d994ab91-81bc-4fe6-894a-ddc0e8781b62"],
Cell[CellGroupData[{
Cell[33170, 968, 5494, 167, 978, "Input",ExpressionUUID->"4e533ed1-01f4-4967-874c-5c63b09773d1"],
Cell[38667, 1137, 282, 5, 70, "Output",ExpressionUUID->"b28bebb3-99b1-4fba-88d4-6416ec5f0872"],
Cell[38952, 1144, 1823, 56, 70, "Output",ExpressionUUID->"f1cfb393-7107-46cf-93aa-76d789c6a067"]
}, Open  ]],
Cell[40790, 1203, 212, 4, 69, "Text",ExpressionUUID->"747411c8-14cd-4e8f-8738-9c55506493c0"],
Cell[41005, 1209, 3326, 88, 720, "Input",ExpressionUUID->"0f4db8f3-02b3-4fd3-836d-7185279190f4",
 InitializationCell->True],
Cell[44334, 1299, 157, 2, 69, "Text",ExpressionUUID->"0bc700a7-d6ee-4eec-b804-a60f6ac33615"],
Cell[CellGroupData[{
Cell[44516, 1305, 3975, 124, 679, "Input",ExpressionUUID->"df415178-5535-438f-955a-ed17225cf8d0"],
Cell[48494, 1431, 1793, 56, 70, "Output",ExpressionUUID->"0554cfd3-1bc0-4830-b292-535f64d4e395"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[50336, 1493, 261, 7, 178, "Section",ExpressionUUID->"13907e7d-4868-4b40-b1f1-f9bc860a81e5"],
Cell[CellGroupData[{
Cell[50622, 1504, 5976, 179, 1135, "Input",ExpressionUUID->"b0c99f22-8da4-4647-adb2-2c65c73cfcd4"],
Cell[56601, 1685, 1897, 57, 167, "Output",ExpressionUUID->"5388358a-1219-47c0-9fae-114274dec7f3"]
}, Open  ]],
Cell[58513, 1745, 212, 4, 69, "Text",ExpressionUUID->"17fb08b8-5a00-4557-9def-27a945f26b1b"],
Cell[58728, 1751, 4400, 112, 929, "Input",ExpressionUUID->"dd8bf56a-a2c2-4b9b-8679-9b5b484a2e65",
 InitializationCell->True],
Cell[63131, 1865, 157, 2, 69, "Text",ExpressionUUID->"28d7fae7-96ed-4818-9912-94aecccc808c"],
Cell[CellGroupData[{
Cell[63313, 1871, 4593, 140, 869, "Input",ExpressionUUID->"0332f1e7-1f64-4bb0-9476-ebc19639e5a5"],
Cell[67909, 2013, 2220, 69, 207, "Output",ExpressionUUID->"2e0c0bb8-1a4f-4185-bfb2-063856c48124"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[70178, 2088, 183, 3, 102, "Section",ExpressionUUID->"60a5f5da-15b3-458c-b484-5002f49d27d2"],
Cell[CellGroupData[{
Cell[70386, 2095, 2235, 74, 321, "Input",ExpressionUUID->"c276f689-6e62-4542-b296-cb7ad62a0010"],
Cell[72624, 2171, 321, 7, 69, "Output",ExpressionUUID->"f8f08a1f-6dad-469d-bbfc-053361f04011"]
}, Open  ]],
Cell[72960, 2181, 694, 15, 204, "Text",ExpressionUUID->"9bd83819-5b28-4765-9f2e-8a28508f662e"],
Cell[CellGroupData[{
Cell[73679, 2200, 3306, 105, 510, "Input",ExpressionUUID->"6b710b25-c5a2-42ea-ac74-c4d62b33d551"],
Cell[76988, 2307, 270, 6, 69, "Output",ExpressionUUID->"3b99c271-33b3-43c9-b2e8-160ac00fbbc8"]
}, Open  ]],
Cell[77273, 2316, 1586, 50, 342, "Text",ExpressionUUID->"e2b6a685-6a57-4c21-917d-f106ce79e2d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[78896, 2371, 330, 5, 102, "Section",ExpressionUUID->"38c93bc3-8c8d-459f-bc0c-8370e7573a78"],
Cell[79229, 2378, 737, 19, 159, "Text",ExpressionUUID->"f79d02fb-0099-4951-a093-04091615c5f4"],
Cell[CellGroupData[{
Cell[79991, 2401, 164, 3, 107, "Subsection",ExpressionUUID->"1d2f8529-0d23-4c2c-a23c-6b04db16eb4a"],
Cell[80158, 2406, 214, 4, 69, "Text",ExpressionUUID->"f5ed8483-cdb5-4d00-8bd4-fa6f608f7cea"],
Cell[CellGroupData[{
Cell[80397, 2414, 5441, 152, 820, "Input",ExpressionUUID->"d9c388c0-3874-445e-bc5a-213f9df8b9b8"],
Cell[85841, 2568, 397, 7, 95, "Output",ExpressionUUID->"d02b66f6-9b66-4299-9d1f-cd0f7511efc6"]
}, Open  ]],
Cell[86253, 2578, 249, 4, 69, "Text",ExpressionUUID->"fad55779-a88b-4fea-85e0-c61cff4e0aaf"],
Cell[CellGroupData[{
Cell[86527, 2586, 5906, 162, 902, "Input",ExpressionUUID->"418bba3d-91b5-4a91-a490-20c7ba9a22e9"],
Cell[92436, 2750, 7196, 150, 422, "Output",ExpressionUUID->"c26659ad-8953-4796-92d4-873f1f6ecaef"],
Cell[99635, 2902, 7509, 155, 422, "Output",ExpressionUUID->"7973e418-6d8a-4106-8f9f-3648a922b4fe"]
}, Open  ]],
Cell[107159, 3060, 165, 3, 69, "Text",ExpressionUUID->"dfa05c36-080f-42aa-8ae7-86785686a4db"],
Cell[CellGroupData[{
Cell[107349, 3067, 6249, 173, 943, "Input",ExpressionUUID->"354a7923-bd47-4388-9df5-19feedc8513f"],
Cell[113601, 3242, 7168, 150, 422, "Output",ExpressionUUID->"6ecccce5-7554-4788-8550-a60e33f5f3d9"],
Cell[120772, 3394, 7484, 155, 422, "Output",ExpressionUUID->"48e68e1d-3a8b-42da-923c-4e54134124c6"],
Cell[128259, 3551, 253, 6, 89, "Output",ExpressionUUID->"08b3870d-2054-4170-851c-2d4756c480fc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128561, 3563, 164, 3, 107, "Subsection",ExpressionUUID->"656d64e7-8640-4666-a533-f9bd9e7dad3b"],
Cell[CellGroupData[{
Cell[128750, 3570, 11995, 359, 2261, "Input",ExpressionUUID->"2426f0da-c824-4a8f-a71f-b09a1202ade2"],
Cell[140748, 3931, 334, 8, 44, "Print",ExpressionUUID->"f6e34982-51ce-4aa7-961e-48f25192c61c"],
Cell[141085, 3941, 376, 9, 73, "Message",ExpressionUUID->"7fa2e638-8f73-4fe8-9a5b-4e2b7c42d2ee"],
Cell[141464, 3952, 411, 10, 54, "Message",ExpressionUUID->"a7017223-93da-4c96-a9cd-a8feb89acc3f"],
Cell[141878, 3964, 411, 10, 54, "Message",ExpressionUUID->"af9c8e70-599f-4256-a6d9-9959e3ba8778"],
Cell[142292, 3976, 411, 10, 54, "Message",ExpressionUUID->"73006b84-6010-4c67-b563-62c7181c726c"],
Cell[142706, 3988, 460, 10, 54, "Message",ExpressionUUID->"8bbc2e9e-42fc-4816-875e-4ecf2d109d3e"],
Cell[143169, 4000, 2617, 67, 219, "Output",ExpressionUUID->"a860c518-6c9c-41bd-908f-74723c801b3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145823, 4072, 300, 6, 80, "Input",ExpressionUUID->"4b2a9006-57c9-40f8-b72e-2e7ecb3841d8"],
Cell[146126, 4080, 8694, 154, 777, "Output",ExpressionUUID->"16cfb199-3730-46d0-a092-42169a84b84a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154857, 4239, 1691, 42, 321, "Input",ExpressionUUID->"bb860915-db85-4ee8-ad6a-fb1523443126"],
Cell[156551, 4283, 2608, 57, 379, "Output",ExpressionUUID->"aa42f0ff-0468-4552-831a-0e7fe1999c4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159196, 4345, 1270, 31, 133, "Input",ExpressionUUID->"ed009157-c7da-4112-82f3-77749a497cdf"],
Cell[160469, 4378, 308, 8, 64, "Output",ExpressionUUID->"e6846b94-ac2f-47d9-b309-801d5932a28a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160814, 4391, 927, 25, 171, "Input",ExpressionUUID->"7e0f526d-cd35-414d-a78f-455d46fdf184"],
Cell[161744, 4418, 11384, 198, 753, "Output",ExpressionUUID->"d318e3cd-36af-458d-aadb-2b4d5f8e1d55"],
Cell[173131, 4618, 3318, 71, 417, "Output",ExpressionUUID->"f9601368-c208-40f8-8375-c123fb8248c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176486, 4694, 1184, 28, 185, "Input",ExpressionUUID->"94f6ce39-04d0-44a7-86fb-12e15e82b471"],
Cell[177673, 4724, 457, 11, 73, "Message",ExpressionUUID->"fa73fa59-1e9a-4a2e-b754-123a47d58929"],
Cell[178133, 4737, 488, 12, 54, "Message",ExpressionUUID->"62e9a27a-a241-4d23-84c6-bca46b1e594e"],
Cell[178624, 4751, 490, 12, 54, "Message",ExpressionUUID->"bf2a7a55-f409-46a4-81e2-5a62c3f7ba8c"],
Cell[179117, 4765, 488, 12, 54, "Message",ExpressionUUID->"fc7c29cc-dd42-4bc9-a9a4-b4165bbc1202"],
Cell[179608, 4779, 539, 12, 54, "Message",ExpressionUUID->"6b9c80c9-2254-4476-bd5a-b2517f9f152b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180184, 4796, 2539, 71, 382, "Input",ExpressionUUID->"c6514092-9aff-4d1c-a395-f7137ec33805"],
Cell[182726, 4869, 2013, 54, 215, "Output",ExpressionUUID->"6d962995-8560-4ddd-af51-c3f4b0424c6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184776, 4928, 205, 4, 56, "Input",ExpressionUUID->"6592a3e4-c749-499c-a767-d5fc0b075ee3"],
Cell[184984, 4934, 27700, 509, 1019, "Output",ExpressionUUID->"cb39e1a4-af35-42bd-9603-9495c9db48e6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

