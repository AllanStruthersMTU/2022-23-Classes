(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     22954,        626]
NotebookOptionsPosition[     20805,        582]
NotebookOutlinePosition[     21501,        604]
CellTagsIndexPosition[     21458,        601]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rosenbrock Test Functions", "Title",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
   3.84666883912605*^9, 3.846668864267633*^9}, {3.8826172645175605`*^9, 
   3.8826172694218645`*^9}, {3.882619601837344*^9, 3.882619604388424*^9}, 
   3.8838360708844204`*^9, {3.8847012020072985`*^9, 3.88470120638546*^9}, {
   3.8853011939600477`*^9, 3.885301206294773*^9}, {3.885639885267516*^9, 
   3.8856399004839582`*^9}},ExpressionUUID->"bb443c9e-1a1c-437e-b10c-\
400e63a30bb8"],

Cell["\<\
The Rosenbrock function is an analytically simple but computationally \
tortuous optimization test problem.  It is analytic and has computable \
derivatives.\
\>", "Text",
 CellChangeTimes->{{3.8853012122901955`*^9, 3.8853015126331096`*^9}, {
  3.885302613832281*^9, 3.8853026179977818`*^9}, {3.8856399046677446`*^9, 
  3.8856399729918947`*^9}, {3.8856402372258186`*^9, 3.8856402425789804`*^9}, {
  3.8859058812717767`*^9, 
  3.8859059266796827`*^9}},ExpressionUUID->"4327b392-02a7-4b70-9292-\
6621f3b3de2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ")"}], "2"], "+", 
       RowBox[{"100", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
           SuperscriptBox[
            RowBox[{
            "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "2"]}], ")"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", "d1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d1", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             ")"}]}], "-", 
           RowBox[{"400", "*", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              SuperscriptBox[
               RowBox[{
               "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "2"]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "200"}], "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "1"}], "]"}], "]"}], "2"], "-", 
            RowBox[{"x", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d1", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "+=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "200"}], "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "2"], "-", 
           RowBox[{"x", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "d1"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddRosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", "d1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "->", 
         RowBox[{"2", "+", 
          RowBox[{"800", " ", 
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "2"]}], "-", 
          RowBox[{"400", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "2"]}], "+", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}], "->", "200"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"202", "+", 
            RowBox[{"800", " ", 
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "2"]}], "-", 
            RowBox[{"400", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "2"]}], "+", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", 
         RowBox[{
          RowBox[{"-", "400"}], "*", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", 
         RowBox[{
          RowBox[{"-", "400"}], "*", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8856399751912203`*^9, 3.885640210123762*^9}, {
  3.8856402463448515`*^9, 3.8856402488729424`*^9}, {3.885640312842229*^9, 
  3.885640543729668*^9}, {3.8859059367065897`*^9, 3.885905995822169*^9}, {
  3.88590602737516*^9, 3.8859060445044193`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c457afbd-1855-402b-aab0-d68d1241a836"],

Cell["\<\
It is ALWAYS worth checking derivatives.  You can do things analytically \
sometimes in Mathematica.\
\>", "Text",
 CellChangeTimes->{{3.885906161197446*^9, 
  3.8859061920788684`*^9}},ExpressionUUID->"46ff8509-031d-404e-ab6e-\
910820424b00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "xx", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "5"}], ";", 
  RowBox[{"Vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"xx", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Rosen", "[", "Vars", "]"}], ",", 
     RowBox[{"{", "Vars", "}"}]}], "]"}], "-", 
   RowBox[{"dRosen", "[", "Vars", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Rosen", "[", "Vars", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Vars", ",", "2"}], "}"}]}], "]"}], "-", 
   RowBox[{"ddRosen", "[", "Vars", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8859060502244043`*^9, 3.885906154699692*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"12788d0d-595f-46f6-8a66-ab0fbd83c235"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8859060691475697`*^9, 3.8859061551222935`*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"0b76089c-0512-4fda-a7f6-66cf3ee2ff75"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8859060691475697`*^9, 3.8859061551379223`*^9}},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"2acece68-1897-4908-ae8f-\
eb793a268913"]
}, Open  ]],

Cell["You can always check numerically with finite differences. ", "Text",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 
  3.8859064919042144`*^9}},ExpressionUUID->"d9439116-e04f-496e-a15e-\
89e26d0c7c69"],

Cell[CellGroupData[{

Cell["Directional 1st derivatives.", "Subsection",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 
  3.8859064859832945`*^9}},ExpressionUUID->"f3636257-b6a5-4717-9be1-\
7a2d6f2cf698"],

Cell[TextData[{
 "If I pick a point and a direction I can approximate the directional \
derivative by a finite difference and compare it to the analytic formula ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "f"}], ".", "u"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5045810b-f319-46c3-a752-72e05b9aceee"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.8859066249975586`*^9, 
  3.885906703199994*^9}},ExpressionUUID->"03beed8d-cf65-4225-b611-\
8c02b1e28f14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "u"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"Normalize", "[", "u", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Rosen", "[", 
           RowBox[{"x", "+", 
            RowBox[{"\[Epsilon]", " ", "u"}]}], "]"}], "-", 
          RowBox[{"Rosen", "[", "x", "]"}]}], "\[Epsilon]"], "-", 
        RowBox[{
         RowBox[{"dRosen", "[", "x", "]"}], ".", "u"}]}], "]"}]}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", 
      SuperscriptBox["2", 
       RowBox[{"-", 
        RowBox[{"Range", "[", 
         RowBox[{"0.0", ",", "24"}], "]"}]}]]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8859062289493713`*^9, 3.8859064531682987`*^9}, {
  3.885906593946663*^9, 3.8859066020045834`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"3dc05aac-34f8-4a89-be52-34bc5231eddb"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQMFSSFCT2JFHd5b/vrnpPdsv56R9iyb6UJQ/rf9
P08fm8Vxm9+heLW1/aZFDAfamtk7TlRwQeXZDrzPWaX+k4XVIfvEjn2Xd3If
aPbYsYuP5789RL3AgWk5xhYvGb/Yb/wkNb8qQ/hAhadtxs5HD+0h+sUOiK5W
37lE+OB+3cabcdxfJA68m/JT/mb+q/0Q86QPTFyl9tHC78f+lfwz5ObUyx2I
2pX4tHwT4wGI+QoHSvmW/Xhry35AyF87fxqr0gGfS7sSC0/yHIDYp3yAKbJ5
T62W4IGAaVzn406rHFCawVfq8kH4AMR+tQNrTa/+494mdqDv7ks99YnqB6q1
VFZerpY8AHGPxoENkxdVzHWUOXBG5WTf+zCtA9eO3vRKZZc/AHGf9gHdm34T
ZjxTOMCVs+LddhndA9O/WT8866l0AOJevQPTDy05nrZW+YDH5na/hkf6B55l
duts4VeFut/gwK/b+U/qM9UOAADZAMdz
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-17.335899797129468`, -12.501008758858363`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{-17.335899797129468`, 0.}, {-12.501008758858363`, 
   5.34169033660929}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledTicks[{Log, Exp}]}, {{{-16.11809565095832, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "7"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-11.512925464970229`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "5"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.100\"", ShowStringCharacters -> False], 0.1, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 
       0.}}, {-13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-9.210340371976182, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.302585092994046, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.3978952727983707`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.4849066497880004`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}, {{-9.210340371976182, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "4"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.01\"", ShowStringCharacters -> False], 0.01, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 0.}}, {0., 
       FormBox["1", TraditionalForm], {0.01, 0.}}, {4.605170185988092, 
       FormBox["100", TraditionalForm], {0.01, 0.}}, {-13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.3025850929940455`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.302585092994046, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellChangeTimes->{{3.8859063612987432`*^9, 3.8859064539958763`*^9}, {
  3.885906594919127*^9, 3.8859066030355816`*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"a544b85b-a75a-433d-a569-c4dc1133a303"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directional 2nd derivatives.", "Subsection",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 3.8859064859832945`*^9}, {3.885906520476921*^9, 
  3.885906521195574*^9}},ExpressionUUID->"74f3dbf7-bfe2-44fc-be61-\
fe64e7f54fe3"],

Cell[TextData[{
 "If I pick a point and two directions I can approximate the directional \
second derivative by a finite difference and compare it to the analytic \
formula ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Del]", "2"], "f"}], ".", "u", ".", "v"}], "=", 
    RowBox[{"v", ".", 
     RowBox[{
      SuperscriptBox["\[Del]", "2"], "f"}], ".", "u"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c3b2f210-2ff8-4a77-9072-52a42d56066c"],
 ".   "
}], "Text",
 CellChangeTimes->{{3.8859066249975586`*^9, 
  3.885906765762309*^9}},ExpressionUUID->"46cc38ff-8866-4659-9f00-\
75715ee96f85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "u", ",", "v"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Normalize", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{
        FractionBox["\[Placeholder]", "\[Placeholder]"], "-", 
        RowBox[{
         RowBox[{"ddRosen", "[", "x", "]"}], ".", "u", ".", "v"}]}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", 
      SuperscriptBox["2", 
       RowBox[{"-", 
        RowBox[{"Range", "[", 
         RowBox[{"0.0", ",", "24"}], "]"}]}]]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8859062289493713`*^9, 3.8859064531682987`*^9}, {
  3.885906534246142*^9, 
  3.8859065821852345`*^9}},ExpressionUUID->"fe513d08-bbd4-47cf-800f-\
eff709ae1cea"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1078.5, 575.},
WindowMargins->{{Automatic, -1368}, {Automatic, -302}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False, 
  "SlideshowSettings" -> Association["Toolbar" -> True]],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"328aa88a-5c26-4081-9c21-6c541db39509"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 495, 7, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1078, 31, 518, 10, 83, "Text",ExpressionUUID->"4327b392-02a7-4b70-9292-6621f3b3de2b"],
Cell[1599, 43, 6895, 194, 624, "Input",ExpressionUUID->"c457afbd-1855-402b-aab0-d68d1241a836"],
Cell[8497, 239, 252, 6, 83, "Text",ExpressionUUID->"46ff8509-031d-404e-ab6e-910820424b00"],
Cell[CellGroupData[{
Cell[8774, 249, 887, 23, 128, "Input",ExpressionUUID->"12788d0d-595f-46f6-8a66-ab0fbd83c235"],
Cell[9664, 274, 252, 4, 48, "Output",ExpressionUUID->"0b76089c-0512-4fda-a7f6-66cf3ee2ff75"],
Cell[9919, 280, 774, 22, 166, "Output",ExpressionUUID->"2acece68-1897-4908-ae8f-eb793a268913"]
}, Open  ]],
Cell[10708, 305, 253, 4, 50, "Text",ExpressionUUID->"d9439116-e04f-496e-a15e-89e26d0c7c69"],
Cell[CellGroupData[{
Cell[10986, 313, 229, 4, 72, "Subsection",ExpressionUUID->"f3636257-b6a5-4717-9be1-7a2d6f2cf698"],
Cell[11218, 319, 498, 13, 83, "Text",ExpressionUUID->"03beed8d-cf65-4225-b611-8c02b1e28f14"],
Cell[CellGroupData[{
Cell[11741, 336, 1487, 42, 280, "Input",ExpressionUUID->"3dc05aac-34f8-4a89-be52-34bc5231eddb"],
Cell[13231, 380, 5100, 122, 362, "Output",ExpressionUUID->"a544b85b-a75a-433d-a569-c4dc1133a303"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18380, 508, 275, 4, 72, "Subsection",ExpressionUUID->"74f3dbf7-bfe2-44fc-be61-fe64e7f54fe3"],
Cell[18658, 514, 664, 19, 83, "Text",ExpressionUUID->"46cc38ff-8866-4659-9f00-75715ee96f85"],
Cell[19325, 535, 1452, 43, 274, "Input",ExpressionUUID->"fe513d08-bbd4-47cf-800f-eff709ae1cea"]
}, Open  ]]
}, Open  ]]
}
]
*)

