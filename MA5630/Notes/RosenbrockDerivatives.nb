(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28015,        735]
NotebookOptionsPosition[     25870,        691]
NotebookOutlinePosition[     26560,        713]
CellTagsIndexPosition[     26517,        710]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rosenbrock Test Functions", "Title",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
   3.84666883912605*^9, 3.846668864267633*^9}, {3.8826172645175605`*^9, 
   3.8826172694218645`*^9}, {3.882619601837344*^9, 3.882619604388424*^9}, 
   3.8838360708844204`*^9, {3.8847012020072985`*^9, 3.88470120638546*^9}, {
   3.8853011939600477`*^9, 3.885301206294773*^9}, {3.885639885267516*^9, 
   3.8856399004839582`*^9}},ExpressionUUID->"bb443c9e-1a1c-437e-b10c-\
400e63a30bb8"],

Cell["\<\
The Rosenbrock function is an analytically simple but computationally \
tortuous optimization test problem.  It is analytic and has computable \
derivatives.\
\>", "Text",
 CellChangeTimes->{{3.8853012122901955`*^9, 3.8853015126331096`*^9}, {
  3.885302613832281*^9, 3.8853026179977818`*^9}, {3.8856399046677446`*^9, 
  3.8856399729918947`*^9}, {3.8856402372258186`*^9, 3.8856402425789804`*^9}, {
  3.8859058812717767`*^9, 
  3.8859059266796827`*^9}},ExpressionUUID->"4327b392-02a7-4b70-9292-\
6621f3b3de2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ")"}], "2"], "+", 
       RowBox[{"100", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
           SuperscriptBox[
            RowBox[{
            "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "2"]}], ")"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", "d1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d1", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             ")"}]}], "-", 
           RowBox[{"400", "*", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              SuperscriptBox[
               RowBox[{
               "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "2"]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "200"}], "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "1"}], "]"}], "]"}], "2"], "-", 
            RowBox[{"x", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d1", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "+=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "200"}], "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "2"], "-", 
           RowBox[{"x", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "d1"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddRosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", "d1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "->", 
         RowBox[{"2", "+", 
          RowBox[{"800", " ", 
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "2"]}], "-", 
          RowBox[{"400", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "2"]}], "+", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}], "->", "200"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"202", "+", 
            RowBox[{"800", " ", 
             SuperscriptBox[
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "2"]}], "-", 
            RowBox[{"400", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "2"]}], "+", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", 
         RowBox[{
          RowBox[{"-", "400"}], "*", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", 
         RowBox[{
          RowBox[{"-", "400"}], "*", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8856399751912203`*^9, 3.885640210123762*^9}, {
  3.8856402463448515`*^9, 3.8856402488729424`*^9}, {3.885640312842229*^9, 
  3.885640543729668*^9}, {3.8859059367065897`*^9, 3.885905995822169*^9}, {
  3.88590602737516*^9, 3.8859060445044193`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c457afbd-1855-402b-aab0-d68d1241a836"],

Cell["\<\
It is ALWAYS worth checking derivatives.  You can do things analytically \
sometimes in Mathematica.\
\>", "Text",
 CellChangeTimes->{{3.885906161197446*^9, 
  3.8859061920788684`*^9}},ExpressionUUID->"46ff8509-031d-404e-ab6e-\
910820424b00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "xx", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "8"}], ";", 
  RowBox[{"Vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"xx", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Rosen", "[", "Vars", "]"}], ",", 
     RowBox[{"{", "Vars", "}"}]}], "]"}], "-", 
   RowBox[{"dRosen", "[", "Vars", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Rosen", "[", "Vars", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Vars", ",", "2"}], "}"}]}], "]"}], "-", 
   RowBox[{"ddRosen", "[", "Vars", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8859060502244043`*^9, 3.885906154699692*^9}, {
  3.8859093553232*^9, 3.8859093658182516`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"12788d0d-595f-46f6-8a66-ab0fbd83c235"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.8859060691475697`*^9, 3.8859061551222935`*^9}, {
  3.8859093449744215`*^9, 3.8859093664483194`*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"3d1523ea-695b-41ec-b7b0-594642c5daf0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8859060691475697`*^9, 3.8859061551222935`*^9}, {
  3.8859093449744215`*^9, 3.8859093664570813`*^9}},
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"17461d17-1302-4aff-8569-\
15af9803e5a4"]
}, Open  ]],

Cell["You can always check numerically with finite differences. ", "Text",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 
  3.8859064919042144`*^9}},ExpressionUUID->"d9439116-e04f-496e-a15e-\
89e26d0c7c69"],

Cell[CellGroupData[{

Cell["Directional 1st derivatives.", "Subsection",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 
  3.8859064859832945`*^9}},ExpressionUUID->"f3636257-b6a5-4717-9be1-\
7a2d6f2cf698"],

Cell[TextData[{
 "If I pick a point and a direction I can approximate the directional \
derivative by a finite difference and compare it to the analytic formula ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "f"}], ".", "u"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5045810b-f319-46c3-a752-72e05b9aceee"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.8859066249975586`*^9, 
  3.885906703199994*^9}},ExpressionUUID->"03beed8d-cf65-4225-b611-\
8c02b1e28f14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "u"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"Normalize", "[", "u", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"Rosen", "[", 
              RowBox[{"x", "+", 
               RowBox[{"\[Epsilon]", " ", "u"}]}], "]"}], "-", 
             RowBox[{"Rosen", "[", 
              RowBox[{"x", "-", 
               RowBox[{"\[Epsilon]", " ", "u"}]}], "]"}]}], 
            RowBox[{"2", "\[Epsilon]"}]], "-", 
           RowBox[{
            RowBox[{"dRosen", "[", "x", "]"}], ".", "u"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"Range", "[", 
            RowBox[{"0.0", ",", "48"}], "]"}]}]]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"Rosen", "[", 
              RowBox[{"x", "+", 
               RowBox[{"\[Epsilon]", " ", "u"}]}], "]"}], "-", 
             RowBox[{"Rosen", "[", "x", "]"}]}], "\[Epsilon]"], "-", 
           RowBox[{
            RowBox[{"dRosen", "[", "x", "]"}], ".", "u"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"Range", "[", 
            RowBox[{"0.0", ",", "48"}], "]"}]}]]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8859062289493713`*^9, 3.8859064531682987`*^9}, {
  3.885906593946663*^9, 3.8859066020045834`*^9}, {3.885909567400962*^9, 
  3.8859095938731766`*^9}, {3.885909669928048*^9, 3.8859097874775896`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"3dc05aac-34f8-4a89-be52-34bc5231eddb"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxFkH1Ik1EUxucylU1KXUyXMZZ7dW42c24uddo7NC0R/CLse6kkjFSMFhaS
qX+ELYZh0qyUzNVMS5sza6XUe5gp5rdIopTUJmqjUPALXTUr3tu8cLg8nHvP
eZ7f3pzCjFwqhUIR/a1/9/9TYTb7WakM+WKU3REXOkfsUnq06xZoSK8R/lpm
LtWwiaueyfB2HQW4ryIHr7nM4GTfDTrMXSL3UzYir+/1u/E3dEi3f0+eKXAB
8r0XrJ9VDrhe9wTj0u76YiUDvmWrAhnDDCD/M+GXp9fsoxMsEJZPKegrfhDD
TNNLZtlAzvOHBymKjpzIAGjeeZddV8oGZWX7vMCBofkcaAk87L3SzQOf1JBC
7fYAuN17qcGsFqB9XBi/6eifTBVCmpY2ohjAQE/3GsJpYWh/ENgZFm91vggq
p22hvCoerDepfXsehyM/wcDvfyoJSRDDIPahcjFTAPa5G2xzegTyFwLFJ7MK
VFVioOU3LZj2CCGmyMITng5HfkOd+siLipQy6364sGmvD2KHIf9hTh1fIj6G
HRVBa2lm1qE7QpQnHJ6PfNVIu/aBlcOt8DBtaTKfGJINxiej3cFQ/t7H9IMl
gepPn40Ndj7KKwEHZmpeFQYCR0mdH70a4eyT+aVOTdCXmC+/SCHVcFl2vhFD
PA5AuopSHq8JAIXBkngvLhKSoeaiZyIb8dnSvzPGikr0URA/Oa5aobIQr2io
zZzXtkUwoW4NGrM9ZE5N8pNB53RSp3gZg+j7bRMJeTGgdZzR98vdEc9Y+OjP
Gnqr2wZTsQ/dBMOx0FdG3eg7x0B8D0Jvtf7nMMdOXLHcku4Q4cBXY2s6q40g
eePgyzVOHHddJjRmXLyRJIdERo2mdWyAIPnLQbYq6mnh2/A/8nOMog==
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxFkA1IU2EYhcdyJtPUZg7nylbe2lRc6nTplm451CTJGKEVtTCKREVBQaVy
KqESDEOsZSZU1iQx8qdCs+gepWQ2m7qV+TMphRT70dIhOUsq7m1+8PJxeL/v
fc95dpzOU59lMhiM8L/17/5/wuyS0dxFrnIhxrEWL54hDUOSXqmZQ+tlcsqY
lHq3zlNZ0CJXdDQykGQ3B7NT3Oi+K95WaOX8U0xltrHrhfWpOx5Xy3qyElYU
1HtvXE0nRkyOL4r2Rf9b5zN9UFHj/0Cb26eg/nMxv2UyktfykQwtH9O42/2g
KhzsMuUvkdQ8PrxZvpt/6dbIZq+6gIbSAEjYulKLxQXUfAFy6ov5rzRscFJD
8vSsnXhzfKC/8rMXqH2BqO2NYPo94+Cwnj2oMRHYpMWlmTJfUPt349PsdteO
RD9UT86JhTVC+MoVQxc8+KD8iJCjZkWrLNswQPRXL6QFg1c0ZnVJEYDyFwIt
ablmf7gD7Jz7851bQ9EyfuIHmxMIyq8YlbLvx+wFBA48qjpUNr0HLvIgS7lt
F+0/DBkCbfNYnBCqEkk6cSQcsI2ea9KJ6DwRmBju0Rz1CsG0ILDKrTMCtRO2
9juOIDqfBJbVb/GmDSKUv+R0fuVFIuZ54bg6SUTnjURqa5E8q4mAIJM5O3Qx
Ct2Tyd2SJYLOL3X2SfdF7pMPUmef4rHXqTWtU4k34qNxENfzPRIDaD7RELNs
Gfca+PitHi4sMcRANWotsDN5NC8ZbqbN6tuiuGhYRlOGm9w5j+Inh7GMuWI8
4wNZfdtIQvY+6NdOGl4rN9I8Y516LPa2a7B5XVN84xB0mVhunJ4ji6euSD3D
FXhn/SkU739PUrwV6Ks1rJoFDlLXq5CsJCudmuK/rv8A7tSPsQ==
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-34.671799594258935`, -23.436663149787332`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{-34.671799594258935`, 0.}, {-23.436663149787332`, 
   5.736750963374149}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledTicks[{Log, Exp}]}, {{{-34.538776394910684`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "15"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-27.631021115928547`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "12"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-20.72326583694641, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "9"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-13.815510557964274`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "6"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}}, {0., 
       FormBox["1", TraditionalForm], {0.01, 0.}}, {-32.23619130191664, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-29.933606208922594`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-25.328436022934504`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-23.025850929940457`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-18.420680743952367`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-16.11809565095832, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-9.210340371976182, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.3025850929940455`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.302585092994046, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}, {{-18.420680743952367`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "8"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-11.512925464970229`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "5"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
       FormBox[
        TagBox[
         InterpretationBox[
          StyleBox["\"0.01\"", ShowStringCharacters -> False], 0.01, 
          AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 0.}}, {
      2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}}, {-25.328436022934504`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-23.025850929940457`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-20.72326583694641, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-16.11809565095832, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-9.210340371976182, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-2.3025850929940455`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.305650551780507, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.392661928770137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.472704636443673, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.546812608597396, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellChangeTimes->{{3.8859063612987432`*^9, 3.8859064539958763`*^9}, {
   3.885906594919127*^9, 3.8859066030355816`*^9}, {3.8859095463297834`*^9, 
   3.8859095870947104`*^9}, 3.8859096714239626`*^9, 3.8859097435821977`*^9, 
   3.885909788167051*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"4ecae89c-2b1e-42eb-ab37-1b2dc1916fe6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directional 2nd derivatives.", "Subsection",
 CellChangeTimes->{{3.885906195637021*^9, 3.885906223928767*^9}, {
  3.8859064667753334`*^9, 3.8859064859832945`*^9}, {3.885906520476921*^9, 
  3.885906521195574*^9}},ExpressionUUID->"74f3dbf7-bfe2-44fc-be61-\
fe64e7f54fe3"],

Cell[TextData[{
 "If I pick a point and two directions I can approximate the directional \
second derivative by a finite difference and compare it to the analytic \
formula ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Del]", "2"], "f"}], ".", "u", ".", "v"}], "=", 
    RowBox[{"v", ".", 
     RowBox[{
      SuperscriptBox["\[Del]", "2"], "f"}], ".", "u"}]}], TraditionalForm]],
  ExpressionUUID->"c3b2f210-2ff8-4a77-9072-52a42d56066c"],
 ".   "
}], "Text",
 CellChangeTimes->{{3.8859066249975586`*^9, 
  3.885906765762309*^9}},ExpressionUUID->"46cc38ff-8866-4659-9f00-\
75715ee96f85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "u", ",", "v"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Normalize", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{
        FractionBox["\[Placeholder]", "\[Placeholder]"], "-", 
        RowBox[{
         RowBox[{"ddRosen", "[", "x", "]"}], ".", "u", ".", "v"}]}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", 
      SuperscriptBox["2", 
       RowBox[{"-", 
        RowBox[{"Range", "[", 
         RowBox[{"0.0", ",", "24"}], "]"}]}]]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8859062289493713`*^9, 3.8859064531682987`*^9}, {
  3.885906534246142*^9, 
  3.8859065821852345`*^9}},ExpressionUUID->"fe513d08-bbd4-47cf-800f-\
eff709ae1cea"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1078.8, 604.8},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False, 
  "SlideshowSettings" -> Association["Toolbar" -> True]],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"328aa88a-5c26-4081-9c21-6c541db39509"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 495, 7, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1078, 31, 518, 10, 83, "Text",ExpressionUUID->"4327b392-02a7-4b70-9292-6621f3b3de2b"],
Cell[1599, 43, 6895, 194, 624, "Input",ExpressionUUID->"c457afbd-1855-402b-aab0-d68d1241a836"],
Cell[8497, 239, 252, 6, 83, "Text",ExpressionUUID->"46ff8509-031d-404e-ab6e-910820424b00"],
Cell[CellGroupData[{
Cell[8774, 249, 936, 24, 128, "Input",ExpressionUUID->"12788d0d-595f-46f6-8a66-ab0fbd83c235"],
Cell[9713, 275, 341, 7, 48, "Output",ExpressionUUID->"3d1523ea-695b-41ec-b7b0-594642c5daf0"],
Cell[10057, 284, 1043, 26, 244, "Output",ExpressionUUID->"17461d17-1302-4aff-8569-15af9803e5a4"]
}, Open  ]],
Cell[11115, 313, 253, 4, 50, "Text",ExpressionUUID->"d9439116-e04f-496e-a15e-89e26d0c7c69"],
Cell[CellGroupData[{
Cell[11393, 321, 229, 4, 72, "Subsection",ExpressionUUID->"f3636257-b6a5-4717-9be1-7a2d6f2cf698"],
Cell[11625, 327, 498, 13, 83, "Text",ExpressionUUID->"03beed8d-cf65-4225-b611-8c02b1e28f14"],
Cell[CellGroupData[{
Cell[12148, 344, 2745, 73, 531, "Input",ExpressionUUID->"3dc05aac-34f8-4a89-be52-34bc5231eddb"],
Cell[14896, 419, 8531, 193, 381, "Output",ExpressionUUID->"4ecae89c-2b1e-42eb-ab37-1b2dc1916fe6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23476, 618, 275, 4, 72, "Subsection",ExpressionUUID->"74f3dbf7-bfe2-44fc-be61-fe64e7f54fe3"],
Cell[23754, 624, 633, 18, 83, "Text",ExpressionUUID->"46cc38ff-8866-4659-9f00-75715ee96f85"],
Cell[24390, 644, 1452, 43, 274, "Input",ExpressionUUID->"fe513d08-bbd4-47cf-800f-eff709ae1cea"]
}, Open  ]]
}, Open  ]]
}
]
*)

