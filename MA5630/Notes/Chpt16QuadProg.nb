(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30119,        881]
NotebookOptionsPosition[     27679,        831]
NotebookOutlinePosition[     28313,        852]
CellTagsIndexPosition[     28270,        849]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Quad Prog\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"min", " ", "0.5", " ", 
     RowBox[{"x", ".", "G", ".", "x"}]}], "+", 
    RowBox[{"c", ".", "x"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "67d81e0b-a25c-48f8-b64a-f44d6aaf0b64"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "e"], ".", "x"}], "=", 
    SubscriptBox["b", "e"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fc2c1687-96fb-48b1-ac54-072a23f4e4f1"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "i"], ".", "x"}], "\[GreaterEqual]", 
    SubscriptBox["b", "i"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cd50ccc9-5e0b-4571-8bc5-7962fc4e8795"]
}], "Title",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
  3.84666883912605*^9, 3.846668864267633*^9}, {3.8826172645175605`*^9, 
  3.8826172694218645`*^9}, {3.882619601837344*^9, 3.882619604388424*^9}, {
  3.889089536748461*^9, 
  3.8890896265458794`*^9}},ExpressionUUID->"bb443c9e-1a1c-437e-b10c-\
400e63a30bb8"],

Cell["\<\
16.1 did the theory of solving the equality constrained problem by \
introducing the KKT matrix. 16.2 discusses directly solving the KKT system by \
factorizing and the Schur complement. 16.3 discusses iterative solvers for \
the KKT system. 16.4 introduces inequality constraints. 16.5 Discusses Active \
Set methods. 16.6 introduces interior point methods. \
\>", "Text",
 CellChangeTimes->{{3.8890896464362392`*^9, 3.889089848623721*^9}, 
   3.889089929451167*^9},ExpressionUUID->"e2cb5a7d-cbf7-4296-8daa-\
c990e4482d67"],

Cell["\<\
In this notebook I am going to demo building and solving the KKT matrix, \
discuss the drawbacks of Active Set methods, and demo interior point methods.\
\>", "Text",
 CellChangeTimes->{{3.8890898566867127`*^9, 
  3.889089976185543*^9}},ExpressionUUID->"b985af68-2fe8-492c-b9b6-\
40f4a324f59b"],

Cell[CellGroupData[{

Cell[TextData[{
 "16.1,2,3 KKT Matrix for\n\t",
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"min", " ", "0.5", " ", 
     RowBox[{"x", ".", "G", ".", "x"}]}], "+", 
    RowBox[{"c", ".", "x"}]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "df237505-c73c-4257-8d74-682f8213ef4f"], "Subsection"],
 StyleBox["\n  \t\t", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "e"], ".", "x"}], "=", 
    SubscriptBox["b", "e"]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "c4c37296-d536-4aee-8455-aad30a7182a4"], "Subsection"]
}], "Section",
 CellChangeTimes->{{3.88908998257719*^9, 3.889090042589308*^9}, {
  3.889091094669776*^9, 3.88909109945125*^9}, {3.889091561233073*^9, 
  3.88909156642278*^9}},ExpressionUUID->"0a4dd1d1-0a90-47c7-afb1-\
cad8332b0b66"],

Cell[TextData[{
 "The solution of the equality constrained optimization problem is x where\n\t\
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"G", 
         RowBox[{"-", 
          RowBox[{"A", "\[Transpose]"}]}]},
        {"A", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", GridBox[{
        {"x"},
        {"\[Lambda]"}
       }], ")"}]}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "c"}]},
       {
        RowBox[{"  ", "b"}]}
      }], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4bee10fd-fa47-4a75-96e9-f1edb9f113a9"],
 " \nThe vector of Lagrange multipliers ",
 Cell[BoxData[
  FormBox["\[Lambda]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e8e7904e-2ac7-49d1-bac8-990b92cdbd32"],
 " does not have any sign conditions."
}], "Text",
 CellChangeTimes->{{3.8890899909835615`*^9, 3.889089994410087*^9}, {
  3.889090056145438*^9, 
  3.889090196733611*^9}},ExpressionUUID->"2fc864ad-da31-49d5-869a-\
7ef8de3e73d8"],

Cell[TextData[{
 "Equivalently the solution of the equality constrained optimization problem \
is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SubscriptBox["x", "0"], "+", "p"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b4f30a3f-9c8d-471b-88b1-5e23f30e123c"],
 " where\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"G", 
         RowBox[{"A", "\[Transpose]"}]},
        {"A", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"-", "p"}]},
        {"\[Lambda]"}
       }], ")"}]}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"G", ".", 
          SubscriptBox["x", "0"]}], "+", "c"}]},
       {
        RowBox[{"  ", 
         RowBox[{
          RowBox[{"A", ".", 
           SubscriptBox["x", "0"]}], "-", "b"}]}]}
      }], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b00f00a4-7a31-4cb1-9d83-83d9ef49e3a1"],
 " \nAs before, the vector of Lagrange multipliers ",
 Cell[BoxData[
  FormBox["\[Lambda]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0b9a720d-4c4b-47e5-8bca-eb5da8a0e970"],
 " does not have any sign conditions."
}], "Text",
 CellChangeTimes->{{3.8890899909835615`*^9, 3.889089994410087*^9}, {
  3.889090056145438*^9, 
  3.8890902735456343`*^9}},ExpressionUUID->"17fdb964-890f-42e7-8bcf-\
6b136a9b593a"],

Cell[TextData[{
 "The matrix \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"G", 
       RowBox[{"A", "\[Transpose]"}]},
      {"A", "0"}
     }], "\[NoBreak]", ")"}], TraditionalForm]],ExpressionUUID->
  "016d5a18-5b94-4e6c-b683-b47e4d2aacec"],
 "\nis called the KKT matrix. "
}], "Text",
 CellChangeTimes->{{3.8890902884183407`*^9, 
  3.8890903177791667`*^9}},ExpressionUUID->"f9843919-0fd7-4d60-af30-\
ba5434dccb1f"],

Cell["Here is the first form in action", "Text",
 CellChangeTimes->{{3.8890909890185633`*^9, 3.889090997468096*^9}, {
  3.8890910467960496`*^9, 
  3.8890910566238995`*^9}},ExpressionUUID->"29ec6781-aab2-448e-841a-\
8b2748f6086d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"G", "=", 
   RowBox[{"G", "+", 
    RowBox[{"G", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KKT", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"G", 
        RowBox[{"-", 
         RowBox[{"A", "\[Transpose]"}]}]},
       {"A", "0"}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KKTRHS", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"-", "c"}], ",", "b"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x\[Lambda]", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"KKT", ",", "KKTRHS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Lambda]"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x\[Lambda]", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "m"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"x\[Lambda]", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"m", "+", "1"}], ";;", 
       RowBox[{"m", "+", "n"}]}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Norm", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"A", ".", "x"}], "-", "b"}], ",", " ", 
     RowBox[{
      RowBox[{"G", ".", "x"}], "+", "c", "-", 
      RowBox[{
       RowBox[{"A", "\[Transpose]"}], ".", "\[Lambda]"}]}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.889090325737729*^9, 3.889090419866731*^9}, {
   3.8890906516243124`*^9, 3.889091007905017*^9}, 3.8890910399827757`*^9, 
   3.8890910713185587`*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"95f95620-9644-440e-902b-1cdb1388f2f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.335559509131367`*^-16", ",", "9.678699938266253`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.889090918218638*^9, 3.8890909837013335`*^9}, {
   3.889091018435235*^9, 3.889091040729737*^9}, 3.889091072326278*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"131e796e-4f2d-489b-800b-89c1377c1f79"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "16.4  KKT Conditions for \n\t",
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"min", " ", "0.5", " ", 
     RowBox[{"x", ".", "G", ".", "x"}]}], "+", 
    RowBox[{"c", ".", "x"}]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "140d6132-a614-4a25-bf4f-17d7d1ad0bd9"], "Subsection"],
 StyleBox["\n  \t\t", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "e"], ".", "x"}], "=", 
    SubscriptBox["b", "e"]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "e9460508-b622-4872-97ff-dea7d9cdcc03"], "Subsection"],
 StyleBox["  and ", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "i"], ".", "x"}], "\[GreaterEqual]", 
    SubscriptBox["b", "i"]}], TraditionalForm]], "Subsection",ExpressionUUID->
  "31c8b32d-de31-45ba-b646-ba3854c94329"], "Subsection"]
}], "Section",
 CellChangeTimes->{{3.88908998257719*^9, 3.889090042589308*^9}, {
   3.889091094669776*^9, 3.88909109945125*^9}, {3.8890911299152207`*^9, 
   3.8890911758730526`*^9}, 
   3.8890915789045944`*^9},ExpressionUUID->"24f7c6a8-701a-4b11-aab8-\
470dc0a553d3"],

Cell[TextData[{
 "Writing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "e"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9468ddc5-f2a4-4514-ad98-80db454f1d6f"],
 " for the Lagrange multipliers for the equality constraints and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d2af1cb8-5daf-451d-9810-2877f740993f"],
 " for the Lagrange multipliers for the inequality constraints we get the KKT \
conditions \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"G", ".", "x"}], "+", "c", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        SubscriptBox["A", "e"], ")"}], "\[Transpose]"}], ".", 
      SubscriptBox["\[Lambda]", "e"]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        SubscriptBox["A", "i"], ")"}], "\[Transpose]"}], ".", 
      SubscriptBox["\[Lambda]", "i"]}]}], "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5f566040-f214-464c-aa6f-2e15d7817b2a"],
 "\nwith \n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       SubscriptBox["A", "e"], ".", "x"}], "=", 
      SubscriptBox["b", "e"]},
     {
      RowBox[{
       SubscriptBox["A", "i"], ".", "x"}], "\[GreaterEqual]", 
      SubscriptBox["b", "i"]},
     {
      SubscriptBox["\[Lambda]", "i"], "\[GreaterEqual]", "0"}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "46024a50-0711-4c9b-bc22-74a0d97f2b74"],
 " \nThe vector of Lagrange multipliers ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "e"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "65c0ea0a-f424-48da-8663-62bcbca8ee6a"],
 " for the equality constraints does not have any sign conditions."
}], "Text",
 CellChangeTimes->{{3.8890899909835615`*^9, 3.889089994410087*^9}, {
  3.889090056145438*^9, 3.889090196733611*^9}, {3.8890911903740053`*^9, 
  3.8890914425609455`*^9}},ExpressionUUID->"861dacee-1922-413d-926f-\
3fb8611f0a53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "16.5  Active Set methods of\n\t",
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"min", " ", "0.5", " ", 
     RowBox[{"x", ".", "G", ".", "x"}]}], "+", 
    RowBox[{"c", ".", "x"}]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "96c9d86b-e25a-4654-8493-9234451a614d"], "Subsection"],
 StyleBox["\n  \t", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "e"], ".", "x"}], "=", 
    SubscriptBox["b", "e"]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "17ddc670-a01a-41cc-b1d1-ded4d3a6bc21"], "Subsection"],
 StyleBox["  and ", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["A", "i"], ".", "x"}], "\[GreaterEqual]", 
    SubscriptBox["b", "i"]}], TraditionalForm]], "Subsection",ExpressionUUID->
  "b70a1206-c3bc-4439-98bd-0764a8f3836d"], "Subsection"]
}], "Section",
 CellChangeTimes->{{3.88908998257719*^9, 3.889090042589308*^9}, {
  3.889091094669776*^9, 3.88909109945125*^9}, {3.8890911299152207`*^9, 
  3.8890911758730526`*^9}, {3.8890914890453777`*^9, 
  3.8890915184834857`*^9}},ExpressionUUID->"a6869d2e-98ad-4ed0-93f1-\
7bf841af5fc6"],

Cell["\<\
Active set methods work by appending inequality constraints to the equality \
constraints in a systematic manner.  The key observation is that if we knew \
which of the inequality constraints were active at the solution we could \
ignore the inactive inequality constraints and simply solve the KKT system \
with the active constraints.  The problem is that we do not know which \
constraints are active at the solution. Active set methods trek along the \
border of the feasible region switching constraints of and on at corners \
and/or when the multiplier violate sign conditions.  They involve a lot of \
book keeping. They are no longer competitive since the development of \
interior point methods.   \
\>", "Text",
 CellChangeTimes->{{3.8890899909835615`*^9, 3.889089994410087*^9}, {
  3.889090056145438*^9, 3.8890902735456343`*^9}, {3.8890915865932565`*^9, 
  3.889091890307173*^9}},ExpressionUUID->"7edeee54-f3f9-4a6c-802c-\
5fe5cd1a1cea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "16.6  Interior Point methods for\n\t",
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"min", " ", "0.5", " ", 
     RowBox[{"x", ".", "G", ".", "x"}]}], "+", 
    RowBox[{"c", ".", "x"}]}], TraditionalForm]], "Subsection",
  FormatType->TraditionalForm,ExpressionUUID->
  "aeab96b6-9cbf-446a-98d5-ffe54123d558"], "Subsection"],
 StyleBox["\n  \t\t", "Subsection"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", "x"}], "\[GreaterEqual]", "b"}], TraditionalForm]], 
  "Subsection",ExpressionUUID->"be6d8063-183f-4573-b57b-6aca7f7e656c"], 
  "Subsection"]
}], "Section",
 CellChangeTimes->{{3.88908998257719*^9, 3.889090042589308*^9}, {
  3.889091094669776*^9, 3.88909109945125*^9}, {3.8890911299152207`*^9, 
  3.8890911758730526`*^9}, {3.8890914890453777`*^9, 3.8890915184834857`*^9}, {
  3.889091898249199*^9, 3.8890919276552916`*^9}, {3.8890919785618415`*^9, 
  3.8890919888732862`*^9}, {3.8890920406530786`*^9, 
  3.8890920447952757`*^9}},ExpressionUUID->"f3861f25-c493-4f2d-aba6-\
eaec3f367f65"],

Cell[TextData[{
 "For now consider G SPD.  Our KKT conditions are \n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       RowBox[{"G", ".", "x"}], "-", 
       RowBox[{
        RowBox[{"A", "\[Transpose]"}], ".", "\[Lambda]"}], "+", "c"}], "=", 
      SubscriptBox["0", "m"]},
     {
      RowBox[{
       RowBox[{"A", ".", "x"}], "-", "b"}], "\[GreaterEqual]", 
      SubscriptBox["0", "n"]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", ".", "x"}], "-", "b"}], ")"}], "\[SmallCircle]", 
       "\[Lambda]"}], "=", 
      SubscriptBox["0", "n"]},
     {"\[Lambda]", "\[GreaterEqual]", "0"}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6a9bccea-ce79-433c-b3ce-2ee1c0dc1331"],
 "\nEquations are better than inequalities so we introduce the vector of \
slack variables\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"A", ".", "x"}], "-", "b"}], "\[GreaterEqual]", 
     SubscriptBox["0", "n"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "78e946e3-b050-41d9-82e2-207dcc9fea99"],
 "\nso that we have \n \t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       RowBox[{"G", ".", "x"}], "-", 
       RowBox[{
        RowBox[{"A", "\[Transpose]"}], ".", "\[Lambda]"}], "+", "c"}], "=", 
      SubscriptBox["0", "m"]},
     {
      RowBox[{
       RowBox[{"A", ".", "x"}], "-", "y", "-", "b"}], "=", 
      SubscriptBox["0", "n"]},
     {
      RowBox[{"y", "\[SmallCircle]", "\[Lambda]"}], "=", 
      SubscriptBox["0", "n"]},
     {"\[Lambda]", "\[GreaterEqual]", "0"},
     {"y", "\[GreaterEqual]", "0"}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "48f7db01-ab90-4b47-93fd-9b563822adb2"],
 "\n Not surprisingly, the algorithm is iterative.  For a feasible triple ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"x", ",", "y", ",", "\[Lambda]"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "47a1bf17-329c-4489-a18d-b556aef5192f"],
 " define the \[OpenCurlyDoubleQuote]complementary measure\
\[CloseCurlyDoubleQuote]\n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", "=", 
    FractionBox[
     RowBox[{"y", ".", "\[Lambda]"}], "m"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6af1184e-1362-4612-baac-dd39d3b79b61"],
 "\n and consider the perturbed KKT conditions\n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "\[Lambda]"}], "}"}], ";", 
      RowBox[{"\[Sigma]", " ", "\[Mu]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{"G", ".", "x"}], "-", 
          RowBox[{
           RowBox[{"A", "\[Transpose]"}], ".", "\[Lambda]"}], "+", "c"}]},
        {
         RowBox[{
          RowBox[{"A", ".", "x"}], "-", "y", "-", "b"}]},
        {
         RowBox[{
          RowBox[{"Y", ".", "\[CapitalLambda]", ".", "e"}], "-", 
          RowBox[{"\[Sigma]", " ", "\[Mu]", " ", "e"}]}]}
       }], ")"}], "=", 
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["0", "m"]},
        {
         SubscriptBox["0", "n"]},
        {
         SubscriptBox["0", "n"]}
       }], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8ed05f88-02c7-4e85-a1ff-542ac67f0156"],
 "\n where the diagonal matrices ",
 Cell[BoxData[
  FormBox["Y", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5d8286c3-f4ba-487a-9c9e-e8e20cf96c7e"],
 " and \[CapitalLambda] have the vectors y and \[Lambda] on their diagonals, \
the vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"e", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "\[Ellipsis]", ",", "1"}], "}"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "232bf0f0-f49c-4993-9dd3-78f5a745e16a"],
 ", and the scalar ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "137edb24-3812-4c2d-88a4-d19c96b6a673"],
 " satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", "\[Sigma]", "\[LessEqual]", "1"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "17b9fac9-08b0-4973-8d8e-f1e5de8a29b2"],
 ". If we fix ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a7b31717-a604-499b-8f7e-53e4d9498820"],
 " a Newton step from a feasible iterated \n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "k"], ",", 
     SubscriptBox["y", "k"], ",", 
     SubscriptBox["\[Lambda]", "k"]}], "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a55b4832-3e59-4ebf-9cb2-e7b4ff7838f2"],
 "\t\n for the nonlinear system is computed by solving \n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"G", "0", 
         RowBox[{"-", 
          RowBox[{"A", "\[Transpose]"}]}]},
        {"A", 
         RowBox[{"-", 
          SubscriptBox["I", "n"]}], "0"},
        {"0", "\[CapitalLambda]", "Y"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[CapitalDelta]x"},
        {"\[CapitalDelta]y"},
        {"\[CapitalDelta]\[Lambda]"}
       }], "\[NoBreak]", ")"}]}], "=", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"-", 
          SubscriptBox["r", "d"]}]},
        {
         RowBox[{"-", 
          SubscriptBox["r", "p"]}]},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[CapitalLambda]", ".", "Y", ".", "e"}]}], "+", 
          RowBox[{"\[Sigma]", " ", "\[Mu]", " ", "e"}]}]}
       }], "\[NoBreak]", ")"}], "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"G", ".", "x"}], "-", 
          RowBox[{
           RowBox[{"A", "\[Transpose]"}], ".", "\[Lambda]"}], "+", "c"}]},
        {
         RowBox[{
          RowBox[{"A", ".", "x"}], "-", "y", "-", "b"}]},
        {"\[CapitalDelta]\[Lambda]"}
       }], "\[NoBreak]", ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a3636f22-7a77-4792-b9e2-51f2c5eeeddb"],
 "\n The  next iterate \[OpenCurlyDoubleQuote]should\[CloseCurlyDoubleQuote] \
be\n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["x", "+"], ",", 
      SuperscriptBox["y", "+"], ",", 
      SuperscriptBox["\[Lambda]", "+"]}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "k"], ",", 
       SubscriptBox["y", "k"], ",", 
       SubscriptBox["\[Lambda]", "k"]}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", 
       "\[CapitalDelta]\[Lambda]"}], "}"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bdb5764d-def5-423a-8d6e-32b29166e1c1"],
 "\n The problem is that this may violate the conditions\n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "+"], "\[GreaterEqual]", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8227e08f-0fc4-4fcf-9512-7c22c0b403b3"],
 " and/or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Lambda]", "+"], "\[GreaterEqual]", "0"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e957f137-5bcc-4220-b0e9-ee3d306d21f3"],
 ".\n The next iterate is chosen with a line search \n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"k", "+", "1"}]], ",", 
      SubscriptBox["y", 
       RowBox[{"k", "+", "1"}]], ",", 
      SubscriptBox["\[Lambda]", 
       RowBox[{"k", "+", "1"}]]}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "k"], ",", 
       SubscriptBox["y", "k"], ",", 
       SubscriptBox["\[Lambda]", "k"]}], "}"}], "+", 
     RowBox[{"\[Alpha]", 
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", 
        "\[CapitalDelta]\[Lambda]"}], "}"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f2c749aa-994d-48b7-a638-c0e43bf22a60"],
 "\n where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[Element]", 
    RowBox[{"(", 
     RowBox[{"0", ",", "1"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1c87e329-ab54-472c-94e8-47a5fa26bad7"],
 " ensures the next point is feasible! In linear programming different step \
lengths are frequently chosen for the primal (x and y) and dual (\[Lambda]) \
variables i.e. the update is  \n \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"k", "+", "1"}]], ",", 
      SubscriptBox["y", 
       RowBox[{"k", "+", "1"}]], ",", 
      SubscriptBox["\[Lambda]", 
       RowBox[{"k", "+", "1"}]]}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "k"], ",", 
       SubscriptBox["y", "k"], ",", 
       SubscriptBox["\[Lambda]", "k"]}], "}"}], "+", 
     RowBox[{
      SubscriptBox["\[Alpha]", "p"], 
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", "0"}], 
       "}"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Alpha]", "d"], 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[CapitalDelta]\[Lambda]"}], "}"}]}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b284653a-3344-467c-b687-46342620ddb2"],
 "\n This is not always such a good idea in quadratic programming. A common \
choice of a single \[Alpha] is the largest value that preserves all the \
required sign conditions. "
}], "Text",
 CellChangeTimes->{{3.8890899909835615`*^9, 3.889089994410087*^9}, {
  3.889090056145438*^9, 3.8890902735456343`*^9}, {3.8890915865932565`*^9, 
  3.889091890307173*^9}, {3.88909199496808*^9, 3.8890923557175894`*^9}, {
  3.8890923880754423`*^9, 3.8890929133311396`*^9}, {3.8890929438890266`*^9, 
  3.8890936450144815`*^9}, {3.8890936946745787`*^9, 3.889093818826839*^9}, {
  3.889093866217552*^9, 3.8890939524211783`*^9}, {3.889094715311531*^9, 
  3.8890947166702924`*^9}},ExpressionUUID->"b3455be9-471a-4590-add4-\
0035eb551916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "16.6  Interior Point method Implementation\n\t",
 StyleBox["Algorithm 16.4 ", "Subsection"]
}], "Section",
 CellChangeTimes->{{3.88908998257719*^9, 3.889090042589308*^9}, {
  3.889091094669776*^9, 3.88909109945125*^9}, {3.8890911299152207`*^9, 
  3.8890911758730526`*^9}, {3.8890914890453777`*^9, 3.8890915184834857`*^9}, {
  3.889091898249199*^9, 3.8890919276552916`*^9}, {3.8890919785618415`*^9, 
  3.8890919888732862`*^9}, {3.8890920406530786`*^9, 3.8890920447952757`*^9}, {
  3.8890940011711283`*^9, 
  3.8890940306552515`*^9}},ExpressionUUID->"79f396e1-b7f4-4bac-9b69-\
cf2c74efbd70"],

Cell["Coming on Friday!", "Text",
 CellChangeTimes->{{3.8890948890763826`*^9, 
  3.889094892498584*^9}},ExpressionUUID->"bd3e6742-d05c-40ce-aba9-\
0b1a4b40beb1"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1141, 580},
WindowMargins->{{1490.5, Automatic}, {59, Automatic}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"146aed7d-a72c-497d-9f02-e1a96e2e8789"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1137, 34, 370, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1720, 58, 534, 9, 150, "Text",ExpressionUUID->"e2cb5a7d-cbf7-4296-8daa-c990e4482d67"],
Cell[2257, 69, 304, 6, 83, "Text",ExpressionUUID->"b985af68-2fe8-492c-b9b6-40f4a324f59b"],
Cell[CellGroupData[{
Cell[2586, 79, 892, 23, 203, "Section",ExpressionUUID->"0a4dd1d1-0a90-47c7-afb1-cad8332b0b66"],
Cell[3481, 104, 1070, 35, 139, "Text",ExpressionUUID->"2fc864ad-da31-49d5-869a-7ef8de3e73d8"],
Cell[4554, 141, 1469, 48, 140, "Text",ExpressionUUID->"17fdb964-890f-42e7-8bcf-6b136a9b593a"],
Cell[6026, 191, 452, 14, 138, "Text",ExpressionUUID->"f9843919-0fd7-4d60-af30-ba5434dccb1f"],
Cell[6481, 207, 229, 4, 50, "Text",ExpressionUUID->"29ec6781-aab2-448e-841a-8b2748f6086d"],
Cell[CellGroupData[{
Cell[6735, 215, 2794, 90, 326, "Input",ExpressionUUID->"95f95620-9644-440e-902b-1cdb1388f2f7"],
Cell[9532, 307, 343, 7, 52, "Output",ExpressionUUID->"131e796e-4f2d-489b-800b-89c1377c1f79"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9924, 320, 1222, 32, 203, "Section",ExpressionUUID->"24f7c6a8-701a-4b11-aab8-470dc0a553d3"],
Cell[11149, 354, 2041, 59, 269, "Text",ExpressionUUID->"861dacee-1922-413d-926f-3fb8611f0a53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13227, 418, 1245, 32, 203, "Section",ExpressionUUID->"a6869d2e-98ad-4ed0-93f1-7bf841af5fc6"],
Cell[14475, 452, 958, 15, 251, "Text",ExpressionUUID->"7edeee54-f3f9-4a6c-802c-5fe5cd1a1cea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15470, 472, 1050, 24, 203, "Section",ExpressionUUID->"f3861f25-c493-4f2d-aba6-eaec3f367f65"],
Cell[16523, 498, 10320, 308, 1221, "Text",ExpressionUUID->"b3455be9-471a-4590-add4-0035eb551916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26880, 811, 607, 11, 158, "Section",ExpressionUUID->"79f396e1-b7f4-4bac-9b69-cf2c74efbd70"],
Cell[27490, 824, 161, 3, 50, "Text",ExpressionUUID->"bd3e6742-d05c-40ce-aba9-0b1a4b40beb1"]
}, Open  ]]
}, Open  ]]
}
]
*)

