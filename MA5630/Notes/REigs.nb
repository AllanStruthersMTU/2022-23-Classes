(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40053,       1035]
NotebookOptionsPosition[     37549,        983]
NotebookOutlinePosition[     38184,       1004]
CellTagsIndexPosition[     38141,       1001]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Implementing REigs from 
Jia et al\
\>", "Title",
 CellChangeTimes->{{3.8465884180627756`*^9, 3.846588429089326*^9}, {
  3.84666883912605*^9, 3.846668864267633*^9}, {3.8826172645175605`*^9, 
  3.8826172694218645`*^9}, {3.882619601837344*^9, 3.882619604388424*^9}, {
  3.889089536748461*^9, 3.8890896265458794`*^9}, {3.8903050244169965`*^9, 
  3.8903050298508773`*^9}, {3.8903051693341866`*^9, 
  3.890305204738677*^9}},ExpressionUUID->"bb443c9e-1a1c-437e-b10c-\
400e63a30bb8"],

Cell[CellGroupData[{

Cell["Script", "Section",
 CellChangeTimes->{{3.890477517704286*^9, 
  3.890477518776336*^9}},ExpressionUUID->"5717f2be-5676-4cd5-9204-\
1560679d5a37"],

Cell["\<\
Pseudocode is on p11 of https://arxiv.org/ftp/arxiv/papers/2102/2102.09693.pdf
There are some typos.  I am doing this in a script first\
\>", "Text",
 CellChangeTimes->{{3.8903052091472206`*^9, 3.8903052395995073`*^9}, {
  3.8903054516229553`*^9, 
  3.8903054580193157`*^9}},ExpressionUUID->"6d0e01f4-2fd5-4284-9d89-\
125e1e96bc71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"od", "=", 
   RowBox[{"0.1", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B", "=", " ", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", "od"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", "od"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "d"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"B", "=", 
     RowBox[{"IdentityMatrix", "[", "m", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"A", "=", 
    RowBox[{"A", "+", 
     RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Step", " ", "1", " ", "build", " ", "v"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   FractionBox["v", 
    SqrtBox[
     RowBox[{"v", ".", "B", ".", "v"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v0", "=", "v"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Step", " ", "2", " ", "and", " ", "3", " ", "Arnoldi"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k", ",", "p"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "+", "p", "+", "1"}], " ", "\[LessEqual]", " ", "m"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"k", "+", "p", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HBig", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "+", "p", "+", "1"}], ",", 
       RowBox[{"k", "+", "p"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", "v"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"B", ",", 
        RowBox[{"A", ".", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"HBig", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], ".", "B", 
          ".", "v"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"v", "-", 
          RowBox[{
           RowBox[{"HBig", "\[LeftDoubleBracket]", 
            RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"V", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HBig", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], "=", 
      SqrtBox[
       RowBox[{"v", ".", "B", ".", "v"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"v", "/", 
       RowBox[{"HBig", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", "v"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", 
      RowBox[{"k", "+", "p"}]}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"HBig", ",", 
   RowBox[{"PlotLabel", "->", 
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"V", "\[Transpose]"}], ".", "B", ".", "V"}], "-", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"k", "+", "p", "+", "1"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", 
             RowBox[{"k", "+", "p"}]}]}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"B", ".", "V", ".", "HBig"}]}]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8903052474543266`*^9, 3.890305978725906*^9}, {
   3.8903060541337247`*^9, 3.8903063649688406`*^9}, {3.890306407791031*^9, 
   3.8903066085684767`*^9}, {3.890306659907838*^9, 3.890306673017079*^9}, {
   3.8903069454474597`*^9, 3.8903069596564007`*^9}, {3.890307017069908*^9, 
   3.8903070362333565`*^9}, {3.8903070824556837`*^9, 
   3.8903070948423047`*^9}, {3.890307137370654*^9, 3.8903072171173515`*^9}, 
   3.8903072601913776`*^9, {3.890307301349012*^9, 3.8903073447148595`*^9}, {
   3.8903076242235746`*^9, 3.890307650009901*^9}, {3.890307700189498*^9, 
   3.8903077007782993`*^9}, {3.890312845199563*^9, 3.8903128673628902`*^9}, {
   3.8903129459831867`*^9, 3.890312946899002*^9}, {3.890312981621541*^9, 
   3.8903130166349993`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"dd0223d6-3ace-40f3-a3ab-26c77698e3b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "and", " ", "sort", " ", "the", " ", "eigenvalues", " ", 
    "of", " ", "the", " ", "inner", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "=", 
     RowBox[{"HBig", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", 
       RowBox[{"k", "+", "p"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"define", " ", "an", " ", "r"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Lambda]s", "=", 
    RowBox[{"Eigenvalues", "[", "H", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"\[Lambda]s", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]s", "=", 
     RowBox[{"\[Lambda]s", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "p"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]s", ",", "Qs"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Eigensystem", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{"H", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", 
             RowBox[{"k", "+", "p"}]}], "\[RightDoubleBracket]"}], "]"}], 
          "]"}], "\[Transpose]"}], "]"}], "\[Transpose]"}]}], ";"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Id", "=", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"k", "+", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", "Id"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Qj", ",", "Rj"}], "}"}], "=", 
       RowBox[{"QRDecomposition", "[", 
        RowBox[{"H", "-", 
         RowBox[{
          RowBox[{
          "\[Sigma]s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
           " ", "Id"}]}], "]"}]}], ";", 
      RowBox[{"Qj", "=", 
       RowBox[{"Qj", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "Qj", "]"}], ".", "H", ".", 
        "Qj"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Q", ".", "Qj"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "p"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Throw", " ", "away", " ", "stuff", " ", "from", " ", "V", " ", "and", 
     " ", "H"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "=", 
     RowBox[{"H", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"1", ";;", "k"}], ",", 
       RowBox[{"1", ";;", "k"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", " ", "=", 
     RowBox[{
      RowBox[{"V", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"k", "+", "p"}]}]}], "\[RightDoubleBracket]"}], ".", 
      RowBox[{"Q", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"1", ";;", "k"}]}], "\[RightDoubleBracket]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.890307358204649*^9, 3.8903076154879465`*^9}, {
   3.8903077255717707`*^9, 3.8903080335572195`*^9}, {3.8903080647445917`*^9, 
   3.8903081320573344`*^9}, {3.8903081745370197`*^9, 
   3.8903081751152368`*^9}, {3.8903131705393305`*^9, 3.890313176562795*^9}, 
   3.890313260167063*^9, {3.890313842662885*^9, 3.890313845502586*^9}, {
   3.890313948229015*^9, 3.8903139556834955`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"04103e13-e9be-4b9f-a0f9-b9ec2f3e0c52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code", "Section",
 CellChangeTimes->{{3.8904775345474963`*^9, 
  3.8904775349858665`*^9}},ExpressionUUID->"0234204f-84be-4773-9e23-\
8fe97bd55cb9"],

Cell[CellGroupData[{

Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.890477538583513*^9, 
  3.890477542086855*^9}},ExpressionUUID->"da0fb417-77b7-4132-b755-\
8526c5f57112"],

Cell["I am returning the HBig matrix the top bit is H.", "Text",
 CellChangeTimes->{{3.8903052091472206`*^9, 3.8903052395995073`*^9}, {
  3.8903054516229553`*^9, 3.8903054580193157`*^9}, {3.890477758298481*^9, 
  3.8904777980923758`*^9}, {3.890478834900139*^9, 
  3.8904788621433687`*^9}},ExpressionUUID->"0ee2666b-42f4-45c9-a1ab-\
1f9ec494e3f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArnoldiInitialize", "[", 
   RowBox[{"A_", ",", "B_", ",", "v0_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", 
      RowBox[{"v", "=", 
       FractionBox["v0", 
        SqrtBox[
         RowBox[{"v0", ".", "B", ".", "v0"}]]]}], ",", "HBig", ",", "V"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Step", " ", "2", " ", "and", " ", "3", " ", "Arnoldi"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"k", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"HBig", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "+", "1"}], ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", "v"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"B", ",", 
           RowBox[{"A", ".", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"HBig", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], ".", "B", 
             ".", "v"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{"v", "-", 
             RowBox[{
              RowBox[{"HBig", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], " ", 
              RowBox[{"V", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HBig", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], 
         "=", 
         SqrtBox[
          RowBox[{"v", ".", "B", ".", "v"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"v", "/", 
          RowBox[{"HBig", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", "n"}], 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"V", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", "v"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"V", ",", 
       RowBox[{"Chop", "[", "HBig", "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8903052474543266`*^9, 3.890305978725906*^9}, {
   3.8903060541337247`*^9, 3.8903063649688406`*^9}, {3.890306407791031*^9, 
   3.8903066085684767`*^9}, {3.890306659907838*^9, 3.890306673017079*^9}, {
   3.8903069454474597`*^9, 3.8903069596564007`*^9}, {3.890307017069908*^9, 
   3.8903070362333565`*^9}, {3.8903070824556837`*^9, 
   3.8903070948423047`*^9}, {3.890307137370654*^9, 3.8903072171173515`*^9}, 
   3.8903072601913776`*^9, {3.890307301349012*^9, 3.8903073447148595`*^9}, {
   3.8903076242235746`*^9, 3.890307650009901*^9}, {3.890307700189498*^9, 
   3.8903077007782993`*^9}, {3.890312845199563*^9, 3.8903128673628902`*^9}, {
   3.8903129459831867`*^9, 3.890312946899002*^9}, {3.890312981621541*^9, 
   3.8903130166349993`*^9}, {3.890477565911889*^9, 3.890477737760047*^9}, {
   3.8904779421712837`*^9, 3.890477961771611*^9}, {3.890477993353303*^9, 
   3.8904779939137506`*^9}, {3.890478823896062*^9, 3.890478826928193*^9}, {
   3.8904789185153584`*^9, 3.8904789217050357`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"1ca60fd5-80d0-42bb-aa40-e4d0616e3e8e"],

Cell["Testing", "Text",
 CellChangeTimes->{{3.890477818074855*^9, 
  3.890477819831506*^9}},ExpressionUUID->"4ea9e89d-3538-4dc7-88f7-\
07ff0d36f57a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "k"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"23", ",", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}], ",", "m"}], "]"}]}], ";", 
  RowBox[{"od", "=", 
   RowBox[{"0.1", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", "od"}], ",", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", "od"}], ",", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "d"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", ",", "HBig"}], "}"}], "=", 
    RowBox[{"ArnoldiInitialize", "[", 
     RowBox[{"A", ",", "B", ",", "v0", ",", "k"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "residuals", " ", "and", " ", "structure"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"HBig", ",", 
   RowBox[{"PlotLabel", "->", 
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"V", "\[Transpose]"}], ".", "B", ".", "V"}], "-", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "k"}]}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"B", ".", "V", ".", "HBig"}]}]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8903052474543266`*^9, 3.890305978725906*^9}, {
   3.8903060541337247`*^9, 3.8903063649688406`*^9}, {3.890306407791031*^9, 
   3.8903066085684767`*^9}, {3.890306659907838*^9, 3.890306673017079*^9}, {
   3.8903069454474597`*^9, 3.8903069596564007`*^9}, {3.890307017069908*^9, 
   3.8903070362333565`*^9}, {3.8903070824556837`*^9, 
   3.8903070948423047`*^9}, {3.890307137370654*^9, 3.8903072171173515`*^9}, 
   3.8903072601913776`*^9, {3.890307301349012*^9, 3.8903073447148595`*^9}, {
   3.8903076242235746`*^9, 3.890307650009901*^9}, {3.890307700189498*^9, 
   3.8903077007782993`*^9}, {3.890312845199563*^9, 3.8903128673628902`*^9}, {
   3.8903129459831867`*^9, 3.890312946899002*^9}, {3.890312981621541*^9, 
   3.8903130166349993`*^9}, {3.890477565911889*^9, 3.8904776906055136`*^9}, {
   3.890477842369455*^9, 3.890477930082356*^9}, {3.8904780083630295`*^9, 
   3.890478049694578*^9}, {3.890478081731407*^9, 3.8904781726491647`*^9}, {
   3.8904782067703285`*^9, 3.8904782804083786`*^9}, {3.8904784580161257`*^9, 
   3.890478458438693*^9}, {3.8904786501814103`*^9, 3.890478650743802*^9}, {
   3.890478869440321*^9, 3.890478910000404*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"bb274a58-3892-4f70-a466-443c863bad89"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgB2I2IAaxIeCDPb1pE/lF+iH8b+yvnxDpW2L6xL6Ob+6m
N4aHaW5v4prUqtnrXttbdXo/WNX3yH4CyxzbY6dW2B9XbGHxffHSvsBhr0P5
gjf2ZutjZd8xvqO6/Q+rRNa5P7wF5TMwXJW0/KEe/c6+4vgROc4pb+1X3eGO
f/X+JU53kmrfnvIVn27XvbM/V+FiXXrvrn3AntygSzrJ9lOeX5Xtf3HRPlnw
ed6K3of2f7Uj9/YsfYXTnaTaqzZzg+wtkbf2U6cqZl4Le2BvttoxJ3VmkX3U
hTWzzypcsy94sv5w0bzH9merJ5jz/31pL/3eMvW03Xt7ifcRpYqJd+wbIgvn
MdkGk+zfv3blE2fVv7FveycxY5HCM/uTk4Q+SKhctDcu57PYlHXfvuXhC5/5
d57ZM80yvXN3yiv7E4ryq1+FvLEviBL3aRB9aP/f6M7b3oRyqsX3Pq6tjJvO
v7V35N44laf1tf2uxX8W6059gtOd1LIXFw0AEdMb0Q==
   "], {{0, 0}, {6, 7}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{6.5, 
       FormBox["1", TraditionalForm]}, {5.5, 
       FormBox["2", TraditionalForm]}, {4.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {2.5, 
       FormBox["5", TraditionalForm]}, {1.5, 
       FormBox["6", TraditionalForm]}, {0.5, 
       FormBox["7", TraditionalForm]}}, {{6.5, 
       FormBox["1", TraditionalForm]}, {5.5, 
       FormBox["2", TraditionalForm]}, {4.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {2.5, 
       FormBox["5", TraditionalForm]}, {1.5, 
       FormBox["6", TraditionalForm]}, {0.5, 
       FormBox["7", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]},
  PlotLabel->FormBox[
    RowBox[{"{", 
      RowBox[{"9.120134777627697`*^-16", ",", "1.492818924248667`*^-15"}], 
      "}"}], TraditionalForm]]], "Output",
 CellChangeTimes->{
  3.890478460154822*^9, 3.8904786516112833`*^9, {3.890478910490094*^9, 
   3.890478924227854*^9}},
 CellLabel->
  "Out[124]=",ExpressionUUID->"acca5b3f-4aa6-483f-8ec0-2a3aa047375a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Arnoldi Update", "Subsection",
 CellChangeTimes->{{3.890477538583513*^9, 3.890477542086855*^9}, {
  3.890478958393159*^9, 
  3.8904789622092285`*^9}},ExpressionUUID->"f2a08b36-3f8b-4093-92b8-\
be5e7c17ee13"],

Cell["I need to take p more Arnoldi steps", "Text",
 CellChangeTimes->{{3.8903052091472206`*^9, 3.8903052395995073`*^9}, {
  3.8903054516229553`*^9, 3.8903054580193157`*^9}, {3.890477758298481*^9, 
  3.8904777980923758`*^9}, {3.890478834900139*^9, 3.8904788621433687`*^9}, {
  3.890478968614832*^9, 
  3.890478983344343*^9}},ExpressionUUID->"b0ec0370-58d7-4862-8624-\
e7c24cd60293"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArnoldiStep", "[", 
   RowBox[{"A_", ",", "B_", ",", 
    RowBox[{"{", 
     RowBox[{"VIn_", ",", "HIn_"}], "}"}], ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "k", ",", 
      RowBox[{"v", "=", 
       FractionBox["v0", 
        SqrtBox[
         RowBox[{"v0", ".", "B", ".", "v0"}]]]}], ",", "HBig", ",", "V"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "k"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "VIn", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Step", " ", "2", " ", "and", " ", "3", " ", "Arnoldi"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"VIn", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "p"}], "}"}]}], "]"}]}], "}"}], "}"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"HBig", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "+", "p", "+", "1"}], ",", 
          RowBox[{"k", "+", "p"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HBig", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"k", "+", "1"}]}], ",", 
        RowBox[{"1", ";;", "k"}]}], "\[RightDoubleBracket]"}], "=", "HIn"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"B", ",", 
           RowBox[{"A", ".", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"HBig", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], ".", "B", 
             ".", "v"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{"v", "-", 
             RowBox[{
              RowBox[{"HBig", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "n"}], "\[RightDoubleBracket]"}], " ", 
              RowBox[{"V", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HBig", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], 
         "=", 
         SqrtBox[
          RowBox[{"v", ".", "B", ".", "v"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"v", "/", 
          RowBox[{"HBig", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", "n"}], 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"V", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", "v"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "k"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"V", ",", 
       RowBox[{"Chop", "[", "HBig", "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8903052474543266`*^9, 3.890305978725906*^9}, {
   3.8903060541337247`*^9, 3.8903063649688406`*^9}, {3.890306407791031*^9, 
   3.8903066085684767`*^9}, {3.890306659907838*^9, 3.890306673017079*^9}, {
   3.8903069454474597`*^9, 3.8903069596564007`*^9}, {3.890307017069908*^9, 
   3.8903070362333565`*^9}, {3.8903070824556837`*^9, 
   3.8903070948423047`*^9}, {3.890307137370654*^9, 3.8903072171173515`*^9}, 
   3.8903072601913776`*^9, {3.890307301349012*^9, 3.8903073447148595`*^9}, {
   3.8903076242235746`*^9, 3.890307650009901*^9}, {3.890307700189498*^9, 
   3.8903077007782993`*^9}, {3.890312845199563*^9, 3.8903128673628902`*^9}, {
   3.8903129459831867`*^9, 3.890312946899002*^9}, {3.890312981621541*^9, 
   3.8903130166349993`*^9}, {3.890477565911889*^9, 3.890477737760047*^9}, {
   3.8904779421712837`*^9, 3.890477961771611*^9}, {3.890477993353303*^9, 
   3.8904779939137506`*^9}, {3.890478823896062*^9, 3.890478826928193*^9}, {
   3.8904789185153584`*^9, 3.8904789217050357`*^9}, {3.8904789872024326`*^9, 
   3.89047923899557*^9}},ExpressionUUID->"643e6bf9-ddd4-49f7-a364-\
e62af5a983e3"],

Cell["Testing", "Text",
 CellChangeTimes->{{3.890477818074855*^9, 
  3.890477819831506*^9}},ExpressionUUID->"f58ead72-de00-4053-9f49-\
14af821fa15b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "k"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"23", ",", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "10"}], "}"}], ",", "m"}], "]"}]}], ";", 
  RowBox[{"od", "=", 
   RowBox[{"0.1", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", " ", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", "od"}], ",", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", "od"}], ",", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "d"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", ",", "HBig"}], "}"}], "=", 
    RowBox[{"ArnoldiInitialize", "[", 
     RowBox[{"A", ",", "B", ",", "v0", ",", "k"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "residuals", " ", "and", " ", "structure"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"HBig", ",", 
   RowBox[{"PlotLabel", "->", 
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"V", "\[Transpose]"}], ".", "B", ".", "V"}], "-", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"k", "+", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "k"}]}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"B", ".", "V", ".", "HBig"}]}]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8903052474543266`*^9, 3.890305978725906*^9}, {
   3.8903060541337247`*^9, 3.8903063649688406`*^9}, {3.890306407791031*^9, 
   3.8903066085684767`*^9}, {3.890306659907838*^9, 3.890306673017079*^9}, {
   3.8903069454474597`*^9, 3.8903069596564007`*^9}, {3.890307017069908*^9, 
   3.8903070362333565`*^9}, {3.8903070824556837`*^9, 
   3.8903070948423047`*^9}, {3.890307137370654*^9, 3.8903072171173515`*^9}, 
   3.8903072601913776`*^9, {3.890307301349012*^9, 3.8903073447148595`*^9}, {
   3.8903076242235746`*^9, 3.890307650009901*^9}, {3.890307700189498*^9, 
   3.8903077007782993`*^9}, {3.890312845199563*^9, 3.8903128673628902`*^9}, {
   3.8903129459831867`*^9, 3.890312946899002*^9}, {3.890312981621541*^9, 
   3.8903130166349993`*^9}, {3.890477565911889*^9, 3.8904776906055136`*^9}, {
   3.890477842369455*^9, 3.890477930082356*^9}, {3.8904780083630295`*^9, 
   3.890478049694578*^9}, {3.890478081731407*^9, 3.8904781726491647`*^9}, {
   3.8904782067703285`*^9, 3.8904782804083786`*^9}, {3.8904784580161257`*^9, 
   3.890478458438693*^9}, {3.8904786501814103`*^9, 3.890478650743802*^9}, {
   3.890478869440321*^9, 3.890478910000404*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"6dde4154-0f1a-4737-9e72-834e0aa780ab"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgB2I2IAaxIeCDPb1pE/lF+iH8b+yvnxDpW2L6xL6Ob+6m
N4aHaW5v4prUqtnrXttbdXo/WNX3yH4CyxzbY6dW2B9XbGHxffHSvsBhr0P5
gjf2ZutjZd8xvqO6/Q+rRNa5P7wF5TMwXJW0/KEe/c6+4vgROc4pb+1X3eGO
f/X+JU53kmrfnvIVn27XvbM/V+FiXXrvrn3AntygSzrJ9lOeX5Xtf3HRPlnw
ed6K3of2f7Uj9/YsfYXTnaTaqzZzg+wtkbf2U6cqZl4Le2BvttoxJ3VmkX3U
hTWzzypcsy94sv5w0bzH9merJ5jz/31pL/3eMvW03Xt7ifcRpYqJd+wbIgvn
MdkGk+zfv3blE2fVv7FveycxY5HCM/uTk4Q+SKhctDcu57PYlHXfvuXhC5/5
d57ZM80yvXN3yiv7E4ryq1+FvLEviBL3aRB9aP/f6M7b3oRyqsX3Pq6tjJvO
v7V35N44laf1tf2uxX8W6059gtOd1LIXFw0AEdMb0Q==
   "], {{0, 0}, {6, 7}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{6.5, 
       FormBox["1", TraditionalForm]}, {5.5, 
       FormBox["2", TraditionalForm]}, {4.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {2.5, 
       FormBox["5", TraditionalForm]}, {1.5, 
       FormBox["6", TraditionalForm]}, {0.5, 
       FormBox["7", TraditionalForm]}}, {{6.5, 
       FormBox["1", TraditionalForm]}, {5.5, 
       FormBox["2", TraditionalForm]}, {4.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {2.5, 
       FormBox["5", TraditionalForm]}, {1.5, 
       FormBox["6", TraditionalForm]}, {0.5, 
       FormBox["7", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]},
  PlotLabel->FormBox[
    RowBox[{"{", 
      RowBox[{"9.120134777627697`*^-16", ",", "1.492818924248667`*^-15"}], 
      "}"}], TraditionalForm]]], "Output",
 CellChangeTimes->{
  3.890478460154822*^9, 3.8904786516112833`*^9, {3.890478910490094*^9, 
   3.890478924227854*^9}},
 CellLabel->
  "Out[124]=",ExpressionUUID->"4b0afe03-dc38-4c0a-9e94-afed7a392f5c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1141, 605},
WindowMargins->{{1827, Automatic}, {238.5, Automatic}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"11cd1dac-225a-4e38-8896-648fe8d11505"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 486, 10, 281, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[CellGroupData[{
Cell[1091, 36, 151, 3, 97, "Section",ExpressionUUID->"5717f2be-5676-4cd5-9204-1560679d5a37"],
Cell[1245, 41, 342, 7, 83, "Text",ExpressionUUID->"6d0e01f4-2fd5-4284-9d89-125e1e96bc71"],
Cell[1590, 50, 6936, 196, 974, "Input",ExpressionUUID->"dd0223d6-3ace-40f3-a3ab-26c77698e3b9"],
Cell[8529, 248, 3867, 100, 528, "Input",ExpressionUUID->"04103e13-e9be-4b9f-a0f9-b9ec2f3e0c52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12433, 353, 153, 3, 97, "Section",ExpressionUUID->"0234204f-84be-4773-9e23-8fe97bd55cb9"],
Cell[CellGroupData[{
Cell[12611, 360, 162, 3, 72, "Subsection",ExpressionUUID->"da0fb417-77b7-4132-b755-8526c5f57112"],
Cell[12776, 365, 346, 5, 50, "Text",ExpressionUUID->"0ee2666b-42f4-45c9-a1ab-1f9ec494e3f1"],
Cell[13125, 372, 4557, 106, 626, "Input",ExpressionUUID->"1ca60fd5-80d0-42bb-aa40-e4d0616e3e8e",
 InitializationCell->True],
Cell[17685, 480, 149, 3, 50, "Text",ExpressionUUID->"4ea9e89d-3538-4dc7-88f7-07ff0d36f57a"],
Cell[CellGroupData[{
Cell[17859, 487, 4090, 108, 300, "Input",ExpressionUUID->"bb274a58-3892-4f70-a466-443c863bad89"],
Cell[21952, 597, 2819, 62, 673, "Output",ExpressionUUID->"acca5b3f-4aa6-483f-8ec0-2a3aa047375a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[24820, 665, 213, 4, 58, "Subsection",ExpressionUUID->"f2a08b36-3f8b-4093-92b8-be5e7c17ee13"],
Cell[25036, 671, 382, 6, 50, "Text",ExpressionUUID->"b0ec0370-58d7-4862-8624-e7c24cd60293"],
Cell[25421, 679, 4987, 117, 654, "Input",ExpressionUUID->"643e6bf9-ddd4-49f7-a364-e62af5a983e3",
 InitializationCell->True],
Cell[30411, 798, 149, 3, 50, "Text",ExpressionUUID->"f58ead72-de00-4053-9f49-14af821fa15b"],
Cell[CellGroupData[{
Cell[30585, 805, 4090, 108, 300, "Input",ExpressionUUID->"6dde4154-0f1a-4737-9e72-834e0aa780ab"],
Cell[34678, 915, 2819, 62, 673, "Output",ExpressionUUID->"4b0afe03-dc38-4c0a-9e94-afed7a392f5c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

