(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87485,       2510]
NotebookOptionsPosition[     79656,       2382]
NotebookOutlinePosition[     80153,       2400]
CellTagsIndexPosition[     80110,       2397]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Numerical ODE Solvers", "Title",
 CellChangeTimes->{{3.8762157882877216`*^9, 
  3.8762157927291117`*^9}},ExpressionUUID->"cfe02285-7314-4cf7-afc8-\
b2cfe098c8c5"],

Cell[CellGroupData[{

Cell["Design Principle(s)", "Chapter",
 CellChangeTimes->{{3.8762158610603175`*^9, 3.8762158679276686`*^9}, 
   3.8762159021487584`*^9, {3.8762162976755314`*^9, 
   3.8762163058877697`*^9}},ExpressionUUID->"d6141ec4-7b22-4563-abc5-\
619cd38f3e36"],

Cell[TextData[{
 "A good \[OpenCurlyDoubleQuote]black box\[CloseCurlyDoubleQuote] ODE solver \
should automatically efficiently compute accurate approximations to a broad \
range of ODEs.  Most such solvers ODE solvers solve 1st order systems.  As we \
have seen, both Matlab and Python require the user to reduce a general system \
of ODEs to a system of first order ODEs.  We are going to see how some \
families of solvers are defined and implemented.  Our n-dimensional IVP \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "'"}], "=", 
    RowBox[{"f", "(", 
     RowBox[{"t", ",", "y"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7293e16b-d95c-48fc-9e84-db23967ad7a4"],
 "  and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "(", "0", ")"}], "=", 
    SubscriptBox["y", "0"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "871a9fc8-c677-4822-bea4-36e536caacde"],
 "\nis defined by the function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     RowBox[{"\[DoubleStruckCapitalR]", "\[Times]", 
      SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}]}], "\[Rule]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "37dee7b5-4c00-45e8-ae42-b8e59d3f8c29"],
 " and the initial condition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "50939393-4256-4abf-b0dd-10b8f522f19f"],
 ". "
}], "Text",
 CellChangeTimes->{{3.876215874670247*^9, 3.876216293326799*^9}, {
  3.8762172548271713`*^9, 
  3.87621730007905*^9}},ExpressionUUID->"f2a5fa57-86bc-4e20-b6a0-\
fba8bfcb25fc"],

Cell[CellGroupData[{

Cell["Euler\[CloseCurlyQuote]s Method", "Section",
 CellChangeTimes->{{3.8762158348629847`*^9, 3.8762158433281527`*^9}, {
  3.8762163318688674`*^9, 
  3.8762163356437693`*^9}},ExpressionUUID->"23c9e758-370c-4cea-9850-\
b132f79b4c73"],

Cell[TextData[{
 "We learned the simplest ODE solver in Calculus I.   The standard \
presentation is to substitute the approximation \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], 
     RowBox[{"(", "t", ")"}]}], "\[TildeTilde]", 
    FractionBox[
     RowBox[{
      RowBox[{"y", "(", 
       RowBox[{"t", "+", "h"}], ")"}], "-", 
      RowBox[{"y", "(", "t", ")"}]}], "h"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a9b38846-3244-49af-956c-474328dd75a3"],
 "\nfor some small into the ODE to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"y", "(", 
       RowBox[{"t", "+", "h"}], ")"}], "-", 
      RowBox[{"y", "(", "t", ")"}]}], "h"], "=", 
    RowBox[{"f", "(", 
     RowBox[{"t", ",", 
      RowBox[{"y", "(", "t", ")"}]}], ")"}], " "}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a97747fc-f5d4-439b-a488-fefa6dff9a84"],
 "\nand rearrange to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "(", 
     RowBox[{"t", "+", "h"}], ")"}], "\[TildeTilde]", 
    RowBox[{
     RowBox[{"y", "(", "t", ")"}], "+", 
     RowBox[{"h", " ", 
      RowBox[{"f", "(", 
       RowBox[{"t", ",", 
        RowBox[{"y", "(", "t", ")"}]}], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7994ac76-c0cc-4b3e-84d7-58fd4b190039"],
 ".\nWith a fixed small step size ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "75ee25cf-8811-48f9-850f-eb667437848b"],
 " this allows us to generate approximate values of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "k"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "63e36f64-6a2d-4623-b0b5-a7ca772e185b"],
 " at the sequence of equally spaced t-value ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "k"], "=", 
    RowBox[{"k", " ", "h"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0ad0ecee-a47a-4b82-944a-d6712bd6475c"],
 ". "
}], "Text",
 CellChangeTimes->{{3.87621579746796*^9, 3.87621585517399*^9}, {
  3.876216339361863*^9, 
  3.8762166652609024`*^9}},ExpressionUUID->"0ca66a3b-99b1-4f4d-920c-\
716efb9c1d5d"],

Cell["The code is pretty simple! ", "Text",
 CellChangeTimes->{{3.8762169776435566`*^9, 
  3.876216982384988*^9}},ExpressionUUID->"f2f92ad0-0aed-484f-8294-\
6d6d1dd5f1bc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EulerStep", "[", "f_", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "t_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"t", "+", "h"}], ",", 
     RowBox[{"y", "+", 
      RowBox[{"h", " ", 
       RowBox[{"f", "[", 
        RowBox[{"t", ",", "y"}], "]"}]}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", "y"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "0.1"}], ";", " ", 
  RowBox[{"t0", "=", "0.0"}], ";", " ", 
  RowBox[{"y0", "=", "1.0"}], ";", " ", 
  RowBox[{"EulerSteps", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EulerData", "=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{"EulerStep", "[", "f", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "t0", ",", "y0"}], "}"}], ",", "EulerSteps"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{"EulerData", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", 
    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.87621667129237*^9, 3.8762168809169283`*^9}, {
   3.876216920802514*^9, 3.8762169562288313`*^9}, 
   3.876217188365733*^9},ExpressionUUID->"4a31a1d9-0a4e-46a7-9dfa-\
c441d332c84b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.1`", ",", "1.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.2`", ",", "1.2100000000000002`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.30000000000000004`", ",", "1.3310000000000002`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.4`", ",", "1.4641000000000002`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.5`", ",", "1.61051`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.6`", ",", "1.7715610000000002`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7`", ",", "1.9487171`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7999999999999999`", ",", "2.1435888100000002`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.8999999999999999`", ",", "2.357947691`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.9999999999999999`", ",", "2.5937424601`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935606059*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"1d9b0314-3617-4acd-a5da-53a64bd38f10"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{0., 1.}, {0.1, 1.1}, {0.2, 1.2100000000000002`}, {
     0.30000000000000004`, 1.3310000000000002`}, {0.4, 1.4641000000000002`}, {
     0.5, 1.61051}, {0.6, 1.7715610000000002`}, {0.7, 1.9487171}, {
     0.7999999999999999, 2.1435888100000002`}, {0.8999999999999999, 
     2.357947691}, {0.9999999999999999, 2.5937424601}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.9999999999999999}, {0, 2.5937424601}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935649955*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"c5cd2a59-bace-4917-98c0-b4fa6c390d3d"]
}, Open  ]],

Cell["\<\
Fixed step-size Euler does not fit our \[OpenCurlyDoubleQuote]Design \
Principles\[CloseCurlyDoubleQuote] because we have no idea if the answer is \
accurate and we have no idea if we picked a reasonable step size h.  What we \
really want is some way to automatically tune the step size to the solution \
of the ODE.  This is not as hard as it sounds! \
\>", "Text",
 CellChangeTimes->{{3.8762172064040356`*^9, 3.8762172419898663`*^9}, {
  3.876217308102703*^9, 
  3.876217441764271*^9}},ExpressionUUID->"9c9f4187-b15b-4799-8fab-\
619916f54d62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Euler\[CloseCurlyQuote]s Method (Alternate Derivation) and Taylor \
Methods", "Section",
 CellChangeTimes->{{3.8762158348629847`*^9, 3.8762158433281527`*^9}, {
  3.8762163318688674`*^9, 3.8762163356437693`*^9}, {3.876217458590097*^9, 
  3.876217472979748*^9}, {3.87621764731898*^9, 
  3.8762176551499915`*^9}},ExpressionUUID->"9f85497e-0a25-4d0c-a92f-\
da594f2baf02"],

Cell[TextData[{
 "Another way to motivate Euler\[CloseCurlyQuote]s method is to look at the \
ODE\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], 
     RowBox[{"(", "t", ")"}]}], "=", 
    RowBox[{"f", "(", 
     RowBox[{"t", ",", 
      RowBox[{"y", "(", "t", ")"}]}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "185913be-5a1a-4604-addf-73ab0990eeb3"],
 "\nand say use the linear approximation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "(", 
      RowBox[{
       SubscriptBox["t", "k"], "+", "h"}], ")"}], "\[TildeTilde]", 
     RowBox[{
      RowBox[{"y", "(", 
       SubscriptBox["t", "k"], ")"}], "+", 
      RowBox[{"h", " ", 
       RowBox[{"y", "'"}], 
       RowBox[{"(", 
        SubscriptBox["t", "k"], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{"y", "(", 
      SubscriptBox["t", "k"], ")"}], "+", 
     RowBox[{"h", " ", 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["t", "k"], ",", 
        RowBox[{"y", "(", 
         SubscriptBox["t", "k"], ")"}]}], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4cd01267-85eb-4bd9-b60b-6f2a4cc42136"],
 "\nwriting ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["h", "k"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2b0990f8-15f2-4b4c-aa64-c1bf6ed19e50"],
 " for the size of step k, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "k"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5bed00e9-eb7b-4b54-b603-354495336ca9"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "k"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "daad85cf-7aa7-4a9a-b179-8a1657084954"],
 " for the approximation generated this way we have\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      SubscriptBox["t", 
       RowBox[{"k", "+", "1"}]], "=", 
      SubscriptBox["t", "k"], "+", 
      SubscriptBox["h", "k"]},
     {
      SubscriptBox["y", 
       RowBox[{"k", "+", "1"}]], "=", 
      SubscriptBox["y", "k"], "+", 
      RowBox[{
       SubscriptBox["h", "k"], 
       RowBox[{"f", "(", 
        RowBox[{
         SubscriptBox["t", "k"], ",", 
         SubscriptBox["y", "k"]}], ")"}]}]},
     {
      SubscriptBox["h", 
       RowBox[{"k", "+", "1"}]], "=", "?", " ", " "}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1aff5fed-6226-45cb-b32e-6d803c0b39d6"],
 "\nWith some way of choosing the step sizes we would get an approximate \
solution values ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SubscriptBox["y", "k"], "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9d206815-b4e1-4696-86d7-5c7ba01b2e46"],
 " at the points ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SubscriptBox["t", "k"], "}"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "54b8910e-6df4-4bf9-9a01-e5471891ae12"],
 "."
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.87621579746796*^9, 3.87621585517399*^9}, {
  3.876216339361863*^9, 3.8762166652609024`*^9}, {3.8762174810143814`*^9, 
  3.876217956468877*^9}},ExpressionUUID->"eb40bd3e-f6f4-438e-98a8-\
733e39cce0b2"],

Cell[TextData[{
 "The quadratic approximation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "(", 
      RowBox[{
       SubscriptBox["t", "k"], "+", "h"}], ")"}], "\[TildeTilde]", 
     RowBox[{
      RowBox[{"y", "(", 
       SubscriptBox["t", "k"], ")"}], "+", 
      RowBox[{"h", " ", 
       RowBox[{"y", "'"}], 
       RowBox[{"(", 
        SubscriptBox["t", "k"], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["h", "2"], "2"], 
       RowBox[{"y", "''"}], 
       RowBox[{"(", 
        SubscriptBox["t", "k"], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{"y", "(", 
      SubscriptBox["t", "k"], ")"}], "+", 
     RowBox[{"h", " ", 
      RowBox[{"f", "(", 
       RowBox[{
        SubscriptBox["t", "k"], ",", 
        RowBox[{"y", "(", 
         SubscriptBox["t", "k"], ")"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["h", "2"], "2"], "?"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "230ded04-fd22-4e80-9646-3f064cc92959"],
 "\nshould give a better answer if we can work out some way to compute (or \
approximate) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "''"}], 
    RowBox[{"(", 
     SubscriptBox["t", "k"], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e3e1d14c-45b1-4970-9450-0d2690dc9a92"],
 ".  The easiest thing to think about is to just differentiate the ODE\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], 
     RowBox[{"(", "t", ")"}]}], "=", 
    RowBox[{"f", "(", 
     RowBox[{"t", ",", 
      RowBox[{"y", "(", "t", ")"}]}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "669d77ba-edcb-4414-a89c-9175fc20ac9e"],
 "\nto get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], 
     RowBox[{"(", "t", ")"}]}], "=", 
    RowBox[{
     FractionBox["d", "dt"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f", "(", 
        RowBox[{"t", ",", 
         RowBox[{"y", "(", "t", ")"}]}], ")"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["f", "t"], "(", 
          RowBox[{"t", ",", 
           RowBox[{"y", "(", "t", ")"}]}], ")"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["f", "y"], "(", 
            RowBox[{"t", ",", 
             RowBox[{"y", "(", "t", ")"}]}], ")"}], ".", 
           RowBox[{"y", "'"}]}], 
          RowBox[{"(", "t", ")"}]}]}], "=", 
        RowBox[{
         RowBox[{
          SubscriptBox["f", "t"], "(", 
          RowBox[{"t", ",", 
           RowBox[{"y", "(", "t", ")"}]}], ")"}], "+", 
         RowBox[{
          RowBox[{
           SubscriptBox["f", "y"], "(", 
           RowBox[{"t", ",", 
            RowBox[{"y", "(", "t", ")"}]}], ")"}], ".", 
          RowBox[{"f", "(", 
           RowBox[{"t", ",", 
            RowBox[{"y", "(", "t", ")"}]}], ")"}]}]}]}]}]}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4e3b61b9-aba6-4b2c-b84d-5c635aab7ea5"]
}], "Text",
 CellChangeTimes->{{3.876217963159026*^9, 3.876218230550353*^9}, {
  3.8762184751243496`*^9, 
  3.8762184799115915`*^9}},ExpressionUUID->"fc704761-b0a4-44f4-a061-\
50970a93ff5a"],

Cell["The code is not that bad! ", "Text",
 CellChangeTimes->{{3.8762169776435566`*^9, 3.876216982384988*^9}, {
  3.8762189527420607`*^9, 
  3.876218955647626*^9}},ExpressionUUID->"1db8daee-738e-4496-98d8-\
23265f3f9fe4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T2Step", "[", 
     RowBox[{"f_", ",", "ft_", ",", "fy_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "t_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"t", "+", "h"}], ",", 
     RowBox[{"y", "+", 
      RowBox[{"h", " ", 
       RowBox[{"f", "[", 
        RowBox[{"t", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["h", "2"], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ft", "[", 
          RowBox[{"t", ",", "y"}], "]"}], "+", 
         RowBox[{
          RowBox[{"fy", "[", 
           RowBox[{"t", ",", "y"}], "]"}], "*", 
          RowBox[{"f", "[", 
           RowBox[{"t", ",", "y"}], "]"}]}]}], ")"}]}]}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", "y"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fy", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "0.1"}], ";", " ", 
  RowBox[{"t0", "=", "0.0"}], ";", " ", 
  RowBox[{"y0", "=", "1.0"}], ";", " ", 
  RowBox[{"T2Steps", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EulerData", "=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{"T2Step", "[", 
     RowBox[{"f", ",", "ft", ",", "fy"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "t0", ",", "y0"}], "}"}], ",", "T2Steps"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{"EulerData", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", 
    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.87621667129237*^9, 3.8762168809169283`*^9}, {
   3.876216920802514*^9, 3.8762169562288313`*^9}, 3.876217188365733*^9, {
   3.876218255481412*^9, 3.876218400535222*^9}, {3.876218436741312*^9, 
   3.8762185650398083`*^9}, {3.8762186102162256`*^9, 3.876218627354473*^9}, {
   3.876218660821737*^9, 3.876218679549381*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"30a662e8-9a11-4978-9d11-48670079c504"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.1`", ",", "1.105`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.2`", ",", "1.221025`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.30000000000000004`", ",", "1.349232625`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.4`", ",", "1.4909020506250001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.5`", ",", "1.6474467659406251`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.6`", ",", "1.8204286763643909`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7`", ",", "2.011573687382652`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7999999999999999`", ",", "2.2227889245578303`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.8999999999999999`", ",", "2.4561817616364023`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.9999999999999999`", ",", "2.7140808466082245`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935606059*^9, {3.8762185146839466`*^9, 3.876218541589255*^9}, {
   3.876218602149009*^9, 3.876218628184208*^9}, 3.8762186800590944`*^9},
 CellLabel->
  "Out[329]=",ExpressionUUID->"5b08c54b-062a-427e-8b69-27b16d678204"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{0., 1.}, {0.1, 1.105}, {0.2, 1.221025}, {0.30000000000000004`, 
     1.349232625}, {0.4, 1.4909020506250001`}, {0.5, 1.6474467659406251`}, {
     0.6, 1.8204286763643909`}, {0.7, 2.011573687382652}, {0.7999999999999999,
      2.2227889245578303`}, {0.8999999999999999, 2.4561817616364023`}, {
     0.9999999999999999, 2.7140808466082245`}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.9999999999999999}, {0, 2.7140808466082245`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935606059*^9, {3.8762185146839466`*^9, 3.876218541589255*^9}, {
   3.876218602149009*^9, 3.876218628184208*^9}, 3.8762186801156273`*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"28c52614-f9a2-4667-ada6-ed8b357b6f94"]
}, Open  ]],

Cell["\<\
Of course, not everything has such clean derivatives as our simples example!\
\>", "Text",
 CellChangeTimes->{{3.876218689559708*^9, 
  3.8762187246287813`*^9}},ExpressionUUID->"4f957534-85f9-4023-89d0-\
559413617dd5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"y", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"t", " ", "y"}], "]"}]}], "+", " ", 
   RowBox[{"Cos", "[", "y", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox["y", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "y"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fy", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"t", " ", "y", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"t", " ", "y"}], "]"}]}], "-", 
   RowBox[{"Sin", "[", "y", "]"}], "+", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "y"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "0.1"}], ";", " ", 
  RowBox[{"t0", "=", "0.0"}], ";", " ", 
  RowBox[{"y0", "=", "1.0"}], ";", " ", 
  RowBox[{"T2Steps", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EulerData", "=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{"T2Step", "[", 
     RowBox[{"f", ",", "ft", ",", "fy"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "t0", ",", "y0"}], "}"}], ",", "T2Steps"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{"EulerData", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", 
    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.87621667129237*^9, 3.8762168809169283`*^9}, {
   3.876216920802514*^9, 3.8762169562288313`*^9}, 3.876217188365733*^9, {
   3.876218255481412*^9, 3.876218400535222*^9}, {3.876218436741312*^9, 
   3.8762185650398083`*^9}, {3.8762186102162256`*^9, 3.876218627354473*^9}, 
   3.8762195995878773`*^9},ExpressionUUID->"d6d26731-d070-44fd-94c5-\
1445827d06a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.1`", ",", "1.0567569870197497`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.2`", ",", "1.1206349057118012`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.30000000000000004`", ",", "1.193602515213244`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.4`", ",", "1.2779793462694233`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.5`", ",", "1.3763852819589673`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.6`", ",", "1.491430664445235`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7`", ",", "1.6247987026196267`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.7999999999999999`", ",", "1.7751463312794178`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.8999999999999999`", ",", "1.934449495744259`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.9999999999999999`", ",", "2.0844690031311175`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935606059*^9, {3.8762185146839466`*^9, 3.876218541589255*^9}, {
   3.876218602149009*^9, 3.876218628184208*^9}},
 CellLabel->
  "Out[322]=",ExpressionUUID->"313a683e-77a7-4773-9c6a-f8490e1ba130"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{0., 1.}, {0.1, 1.0567569870197497`}, {0.2, 
     1.1206349057118012`}, {0.30000000000000004`, 1.193602515213244}, {0.4, 
     1.2779793462694233`}, {0.5, 1.3763852819589673`}, {0.6, 
     1.491430664445235}, {0.7, 1.6247987026196267`}, {0.7999999999999999, 
     1.7751463312794178`}, {0.8999999999999999, 1.934449495744259}, {
     0.9999999999999999, 2.0844690031311175`}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 0.9999999999999999}, {0, 2.0844690031311175`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8762168321660233`*^9, 3.876216882434457*^9}, 
   3.876216935606059*^9, {3.8762185146839466`*^9, 3.876218541589255*^9}, {
   3.876218602149009*^9, 3.876218628233531*^9}},
 CellLabel->
  "Out[323]=",ExpressionUUID->"63cbfb66-34c0-4524-8a86-c9b83d197a4d"]
}, Open  ]],

Cell[TextData[{
 "To generate the T3 scheme all we need to do is differentiate \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], 
     RowBox[{"(", "t", ")"}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["f", "t"], "(", 
      RowBox[{"t", ",", 
       RowBox[{"y", "(", "t", ")"}]}], ")"}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["f", "y"], "(", 
       RowBox[{"t", ",", 
        RowBox[{"y", "(", "t", ")"}]}], ")"}], ".", 
      RowBox[{"f", "(", 
       RowBox[{"t", ",", 
        RowBox[{"y", "(", "t", ")"}]}], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "68f4d6af-4dc6-4f19-a7a9-b7af71fb9fc2"],
 "\t\nagain to get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "'''"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["d", "dt"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["f", "t"], "+", 
        RowBox[{
         SubscriptBox["f", "y"], "f"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["f", "tt"], "+", 
       RowBox[{
        SubscriptBox["f", "yt"], 
        RowBox[{"y", "'"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["f", "ty"], "+", 
          SubscriptBox["f", "yy"]}], ")"}], "f"}], "+", 
       RowBox[{
        SubscriptBox["f", "y"], 
        FractionBox["d", "dt"], 
        RowBox[{"(", "f", ")"}]}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["f", "tt"], "+", 
        RowBox[{
         SubscriptBox["f", "yt"], 
         RowBox[{"y", "'"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["f", "ty"], "+", 
           SubscriptBox["f", "yy"]}], ")"}], "f"}], "+", 
        RowBox[{
         SubscriptBox["f", "y"], "(", 
         RowBox[{
          SubscriptBox["f", "t"], "+", 
          RowBox[{
           SubscriptBox["f", "y"], 
           RowBox[{"y", "'"}]}]}], ")"}]}], "=", 
       RowBox[{
        SubscriptBox["f", "tt"], "+", 
        RowBox[{
         SubscriptBox["f", "yt"], "f"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["f", "ty"], "+", 
           SubscriptBox["f", "yy"]}], ")"}], "f"}], "+", 
        RowBox[{
         SubscriptBox["f", "y"], "(", 
         RowBox[{
          SubscriptBox["f", "t"], "+", 
          RowBox[{
           SubscriptBox["f", "y"], "f"}]}], ")"}]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f86ddaab-71b8-48a4-81cc-1db7431108f1"],
 "\nthis looks like it is rapidly becoming unwieldy!  High order Taylor \
schemes are rarely used in practice because computing the required higher \
derivatives was problematic. "
}], "Text",
 CellChangeTimes->{{3.876218993157848*^9, 3.8762193107813396`*^9}, {
  3.8762196122550697`*^9, 
  3.8762197259596467`*^9}},ExpressionUUID->"5b556e97-b81d-466f-bfa2-\
2506dde0951f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "Eq", ",", "y", ",", "t"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", 
   RowBox[{"f", "[", 
    RowBox[{"t", ",", 
     RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Eq", "[", "n", "]"}], "=", 
   RowBox[{"D", "[", " ", 
    RowBox[{
     RowBox[{"Eq", "[", 
      RowBox[{"n", "-", "1"}], "]"}], ",", "t"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Eq", "[", "2", "]"}], "/.", 
   RowBox[{"Eq", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Eq", "[", "3", "]"}], "/.", 
    RowBox[{"Eq", "[", "2", "]"}]}], "/.", 
   RowBox[{"Eq", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.876219734123665*^9, 3.876219982843277*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"30df905d-daeb-4f37-b818-62699b093729"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{"f", "[", 
   RowBox[{"t", ",", 
    RowBox[{"y", "[", "t", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.876219788851037*^9, 3.8762199835046883`*^9}},
 CellLabel->
  "Out[392]=",ExpressionUUID->"81daaea4-4727-4383-9405-90db4376e6ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.876219788851037*^9, 3.8762199835046883`*^9}},
 CellLabel->
  "Out[394]=",ExpressionUUID->"d662b1dd-b520-40ef-8fef-d1222c38a27d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", 
    TagBox[
     RowBox[{"(", "3", ")"}],
     Derivative],
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"f", "[", 
      RowBox[{"t", ",", 
       RowBox[{"y", "[", "t", "]"}]}], "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t", ",", 
      RowBox[{"y", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", 
         RowBox[{"y", "[", "t", "]"}]}], "]"}], "2"], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["f", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", 
         RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", 
     RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.876219788851037*^9, 3.8762199835046883`*^9}},
 CellLabel->
  "Out[395]=",ExpressionUUID->"b1c6996f-964f-4f0c-8419-84f30c74da9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Very Clean f: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", 
     RowBox[{"(", 
      RowBox[{"t", ",", "y"}], ")"}]}], "=", "y"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0b1bb662-4936-4056-9368-584e864d4876"],
 "\t"
}], "Subsection",
 CellChangeTimes->{{3.876213901627921*^9, 3.8762139112487593`*^9}, {
  3.8763868315245724`*^9, 
  3.8763868604508047`*^9}},ExpressionUUID->"cf7e6ed3-505e-4b1a-b2ce-\
cc6ff9746232"],

Cell[TextData[{
 "It is clean if ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f896a2a1-70b9-4845-bb0b-e93cc199b89d"],
 " is simple enough! For ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "y", ")"}], "=", "y"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bbb4f6b8-67fa-4b4d-8578-76609dbc3d49"],
 " we have"
}], "Text",
 CellChangeTimes->{{3.876218993157848*^9, 3.8762193107813396`*^9}, {
  3.8762196122550697`*^9, 3.8762197259596467`*^9}, {3.8763867035922327`*^9, 
  3.876386754438986*^9}},ExpressionUUID->"f7b9e2be-ce26-478d-94de-\
1440fc33d0d4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "Eq", ",", "y", ",", "t"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"t_", ",", "y_"}], "]"}], ":=", "y"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", 
   RowBox[{"f", "[", 
    RowBox[{"t", ",", 
     RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Eq", "[", "n", "]"}], "=", 
   RowBox[{"D", "[", " ", 
    RowBox[{
     RowBox[{"Eq", "[", 
      RowBox[{"n", "-", "1"}], "]"}], ",", "t"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Eq", "[", "2", "]"}], "/.", 
   RowBox[{"Eq", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Eq", "[", "3", "]"}], "/.", 
    RowBox[{"Eq", "[", "2", "]"}]}], "/.", 
   RowBox[{"Eq", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8763867698898168`*^9, 3.876386784534796*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a658c606-46cd-456b-86d3-b0c160996f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{"y", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.8763867853178263`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"2f8b722f-9494-4ac1-9ac1-a424af173abd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{"y", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.8763867853491*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"260bdae1-1b4a-4cb7-98d2-68427e1b6e82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["y", 
    TagBox[
     RowBox[{"(", "3", ")"}],
     Derivative],
    MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
  RowBox[{"y", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.8763867853491*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"eb17ea39-4d51-40f5-a835-b9b6dee7519a"]
}, Open  ]],

Cell[TextData[{
 "It is clear that the Taylor Step Method is just building\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["TS", "k"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "0"], "+", 
      RowBox[{"t", " ", 
       SubscriptBox["y", "0"]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["t", "2"], 
        RowBox[{"2", "!"}]], 
       SubscriptBox["y", "0"]}], "+", "\[Ellipsis]", "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["t", "k"], 
        RowBox[{"k", "!"}]], 
       SubscriptBox["y", "0"]}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "(", 
       RowBox[{"1", "+", " ", "t", "+", 
        FractionBox[
         SuperscriptBox["t", "2"], "2"], "+", "\[Ellipsis]", "+", 
        FractionBox[
         SuperscriptBox["t", "k"], 
         RowBox[{"k", "!"}]]}], ")"}], "\[TildeTilde]", 
      RowBox[{
       SubscriptBox["y", "0"], 
       SuperscriptBox["e", "t"], " "}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a0ec0ecc-5ff8-4c9f-b37b-f7ed145f7d97"],
 "\nand we recognize the truncated Taylor polynomial for the exact solution.  \
This is not surprising when you look at how we built the Taylor Step. "
}], "Text",
 CellChangeTimes->{{3.876386803556126*^9, 3.8763868164260178`*^9}, {
  3.8763868630043554`*^9, 
  3.8763871653464103`*^9}},ExpressionUUID->"e69222ec-08b1-484c-a3a4-\
83c418a7fa5e"],

Cell["\<\
In words, the TS method constructs and uses the degree k Taylor polynomial to \
advance the solution.    \
\>", "Text",
 CellChangeTimes->{{3.876387167976647*^9, 
  3.876387220943742*^9}},ExpressionUUID->"c1194f03-f829-47f7-a874-\
5782f21082be"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Taylor Method Summary", "Subsection",
 CellChangeTimes->{{3.876213901627921*^9, 3.8762139112487593`*^9}, {
  3.8763868315245724`*^9, 3.8763868604508047`*^9}, {3.8763872308740826`*^9, 
  3.876387239618515*^9}},ExpressionUUID->"0325c303-24d6-46ed-8a1f-\
2c186e94a620"],

Cell[TextData[{
 "The order k Taylor Step Method builds the truncated Taylor polynomial\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["TS", "k"], "=", 
    RowBox[{
     RowBox[{"y", "(", 
      SubscriptBox["t", "0"], ")"}], "+", 
     RowBox[{"t", " ", 
      RowBox[{"y", "'"}], 
      RowBox[{"(", 
       SubscriptBox["t", "0"], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["t", "2"], 
       RowBox[{"2", "!"}]], 
      RowBox[{"y", "''"}], 
      RowBox[{"(", 
       SubscriptBox["t", "0"], ")"}]}], "+", "\[Ellipsis]", "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["t", "k"], 
       RowBox[{"k", "!"}]], 
      RowBox[{
       SuperscriptBox["y", 
        RowBox[{"(", "k", ")"}]], "(", 
       SubscriptBox["t", "0"], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6ef83a74-f7f2-4d89-96af-463f33c1a426"],
 "\nat the point ",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{"y", "(", 
      SubscriptBox["t", "0"], ")"}], TraditionalForm]],
    FormatType->TraditionalForm,ExpressionUUID->
    "e3ec2877-f63a-4fd9-969b-7b13eb6953b0"]],ExpressionUUID->
    "4a4087fe-a8ad-484b-94b6-6934fcba8090"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1f169110-61c5-4433-bf68-e12e28caf774"],
 "by differentiating the ODE\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "'"}], "=", 
    RowBox[{"f", "(", 
     RowBox[{"t", ",", "y"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6078ad7c-e290-428f-b5f8-69e1c5f3a07b"],
 "\nand repeatedly using the initial condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "(", 
     SubscriptBox["t", "0"], ")"}], "=", 
    SubscriptBox["y", "0"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2f8e8da3-a1f7-4ebf-bafb-b6585ec6a526"],
 ".  If it takes a step of size ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0b163576-e51c-49ad-ad65-69c772f04df2"],
 " then it makes an error\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["y", 
       RowBox[{"(", 
        RowBox[{"k", "+", "1"}], ")"}]], "(", "s", ")"}], 
     RowBox[{"k", "+", "1"}]], 
    SuperscriptBox["h", 
     RowBox[{"k", "+", "1"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d0cbae38-e665-4717-bacd-477481c52c95"],
 "\nfor some value of s satisfying  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", "h"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "95e385a7-b8e6-41b8-bc72-b2e4c9ea551e"],
 ".   "
}], "Text",
 CellChangeTimes->{{3.876386803556126*^9, 3.8763868164260178`*^9}, {
  3.8763868630043554`*^9, 3.8763871653464103`*^9}, {3.876387254930394*^9, 
  3.8763875859506564`*^9}},ExpressionUUID->"e84d5063-7e8f-41c6-be5d-\
d41b4f69c517"],

Cell["\<\
This method is not used very often because it needs all those #$#@ \
derivatives! \
\>", "Text",
 CellChangeTimes->{{3.876386803556126*^9, 3.8763868164260178`*^9}, {
  3.8763868630043554`*^9, 3.8763871653464103`*^9}, {3.876387254930394*^9, 
  3.8763876084670453`*^9}},ExpressionUUID->"a4e3c848-7ab9-4652-9b92-\
c1566a7f8715"],

Cell[TextData[{
 "We call any method with a single step error proportional to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["h", 
    RowBox[{"k", "+", "1"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "75c0d999-6c3a-4be9-b9c2-58d154d5fdb3"],
 " a method of order k!  Can we find methods that do not need derivatives? "
}], "Text",
 CellChangeTimes->{{3.876387167976647*^9, 3.876387220943742*^9}, {
   3.87638753359079*^9, 3.876387535512605*^9}, 3.8763875698871574`*^9, {
   3.876387617595465*^9, 
   3.876387771501175*^9}},ExpressionUUID->"969ddba0-36d1-4173-8da6-\
581cfebded46"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RK Methods (overview)", "Section",
 CellChangeTimes->{{3.8762158348629847`*^9, 3.8762158433281527`*^9}, {
  3.8762163318688674`*^9, 3.8762163356437693`*^9}, {3.876217458590097*^9, 
  3.876217472979748*^9}, {3.87621764731898*^9, 3.8762176551499915`*^9}, {
  3.876387787823845*^9, 3.87638779784788*^9}, {3.8763878957884035`*^9, 
  3.876387899647627*^9}, {3.8763893610589266`*^9, 
  3.8763893690437517`*^9}},ExpressionUUID->"dd0fc674-a039-4fc7-8554-\
9f5c824cf3ff"],

Cell[TextData[{
 "We are going to restrict attention to autonomous ODEs\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "'"}], "=", 
    RowBox[{"f", "(", "y", ")"}]}], TraditionalForm]],ExpressionUUID->
  "694ab388-f39e-4740-85bc-1b0ee6f3186f"],
 " with  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "(", "0", ")"}], "=", 
    SubscriptBox["y", "0"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "65dddf24-5476-4bb5-bc3b-410760ae7206"],
 "\nto keep things tidy. If we are not allowed to differentiate the ODE we \
have to start with Euler. Suppose I take a half step with Euler\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     RowBox[{"1", "/", "2"}]], "=", 
    RowBox[{
     SubscriptBox["y", "0"], "+", 
     RowBox[{"0.5", "h", " ", 
      RowBox[{"f", "(", 
       SubscriptBox["y", "0"], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "109fd71c-d5a3-4a41-9d57-097b8e600520"],
 "\nthen I could take a second Euler step\n\t ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "1"], "=", 
    RowBox[{
     SubscriptBox["y", 
      RowBox[{"1", "/", "2"}]], "+", 
     RowBox[{"0.5", "h", " ", 
      RowBox[{"f", "(", 
       SubscriptBox["y", 
        RowBox[{"1", "/", "2"}]], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "35355091-fc71-4026-b5e8-871d8a649e3a"],
 "\nand get one approximation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "1"], "\[TildeTilde]", 
    RowBox[{"y", "(", "h", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1f972a0a-555e-4eea-98a8-5f9983d65f98"],
 ".  Since I am willing to evaluate ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "66ac6c60-6b4a-41e5-b787-9fc502bb2b64"],
 " twice I have other possibilities. For instance, I could do\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["y", "^"], "1"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "0"], "+", 
      RowBox[{"h", " ", 
       RowBox[{"f", "(", 
        SubscriptBox["y", 
         RowBox[{"1", "/", "2"}]], ")"}]}]}], "\[TildeTilde]", 
     RowBox[{"y", "(", "h", ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6194b34b-7710-48e4-8106-ccdc8fe80a02"],
 ".\nIs one better than the other?  Is some other possibility better than \
either? Would it be better to take more steps? Why go half way? \[Ellipsis]"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.87621579746796*^9, 3.87621585517399*^9}, {
  3.876216339361863*^9, 3.8762166652609024`*^9}, {3.8762174810143814`*^9, 
  3.876217956468877*^9}, {3.876387812154818*^9, 
  3.876388460002104*^9}},ExpressionUUID->"b51b9dec-9e10-4570-b319-\
a044dc621912"],

Cell[TextData[{
 "Explicit RK methods are a family of simple ODE solvers based on this idea.  \
They are specified by a Butcher Tableau \n\t",
 Cell[BoxData[GridBox[{
    {"c", "A"},
    {" ", "b"}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"f1ec04bf-850c-446b-9880-0e647ab23af8"],
 "\t\nwhich tells you what internal steps to take and how to combine them.   \
The column vector ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2330529a-8f42-4b49-beb3-95590703756d"],
 " tells you where in time the internal steps are. The strictly lower \
triangular matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "39ab3479-c069-4b3f-a670-516f48837684"],
 " tells you how to compute the internal slopes. The row vector b tells you \
how to combine the internal slopes at the end. There is a partial list of RK \
methods on Wikipedia\n\t \
https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods. "
}], "Text",
 CellChangeTimes->{{3.876388465272689*^9, 3.8763885583491087`*^9}, {
  3.8763885949548054`*^9, 3.876388614387409*^9}, {3.8763886552663593`*^9, 
  3.8763887100388217`*^9}, {3.8763887596864567`*^9, 3.8763889536429253`*^9}, {
  3.8763890408038344`*^9, 3.876389041771256*^9}, {3.8763892482854395`*^9, 
  3.876389248858822*^9}},ExpressionUUID->"902b5e89-ec9a-4b8b-9941-\
91407fcddc0b"],

Cell[TextData[{
 "A Butcher Tableau \n\t",
 Cell[BoxData[GridBox[{
    {"c", "A"},
    {" ", GridBox[{
       {
        SubscriptBox["b", "1"]},
       {
        SubscriptBox["b", "2"]}
      }]}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"034703ab-b4c9-4c11-8504-86fa83e7bedd"],
 "\t\nwith two row vectors ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f8168a84-3059-4980-bfab-18e1b2e0931e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cee45633-fba2-4747-b648-29e14dea3814"],
 " describes two different methods which use the same internal slopes.  The \
methods are compared to automatically adjust the step size ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a57dcf87-89b0-4112-9a93-c9b7366b37a4"],
 ".  There is a partial list of embedded RK methods further down on the \
Wikipedia page\n\t \
https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Embedded_\
methods."
}], "Text",
 CellChangeTimes->{{3.876388465272689*^9, 3.8763885583491087`*^9}, {
  3.8763885949548054`*^9, 3.876388614387409*^9}, {3.8763886552663593`*^9, 
  3.8763887100388217`*^9}, {3.8763887596864567`*^9, 3.8763891133934956`*^9}, {
  3.8763891507117186`*^9, 3.876389243779575*^9}, {3.8763892757118645`*^9, 
  3.8763892825900717`*^9}},ExpressionUUID->"23938b00-75bf-4a57-b3b1-\
ce71161a47f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple RK Methods (Euler, MidPoint, Heun, Ralston, Generic)", "Section",
 CellChangeTimes->{{3.8762158348629847`*^9, 3.8762158433281527`*^9}, {
  3.8762163318688674`*^9, 3.8762163356437693`*^9}, {3.876217458590097*^9, 
  3.876217472979748*^9}, {3.87621764731898*^9, 3.8762176551499915`*^9}, {
  3.876387787823845*^9, 3.87638779784788*^9}, {3.8763878957884035`*^9, 
  3.876387899647627*^9}, {3.8763893610589266`*^9, 
  3.8763894468928895`*^9}},ExpressionUUID->"41d06ba9-62b7-4273-997c-\
bea60eadc663"],

Cell["The Butcher tables for these are ", "Text",
 CellChangeTimes->{{3.876389464335832*^9, 
  3.876389689227724*^9}},ExpressionUUID->"91343d8c-aaaf-4fc0-a747-\
7f52185c16ee"],

Cell[TextData[{
 "MidPoint:\t",
 Cell[BoxData[GridBox[{
    {GridBox[{
       {"0"},
       {
        RowBox[{"1", "/", "2"}]}
      }], GridBox[{
       {"0", "0"},
       {
        RowBox[{"1", "/", "2"}], "0"}
      }]},
    {" ", GridBox[{
       {"0", "1"}
      }]}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"d899471c-1458-489e-a3ac-7d1c84cee13c"],
 "\t"
}], "Item",
 CellChangeTimes->{{3.876389464335832*^9, 3.876389684153989*^9}, {
  3.876389759637024*^9, 
  3.8763897646251345`*^9}},ExpressionUUID->"dd41ce07-78dd-46b9-9b5b-\
d3898441d61c"],

Cell[TextData[{
 "Heun:\t\t",
 Cell[BoxData[GridBox[{
    {GridBox[{
       {"0"},
       {
        RowBox[{"1", "/", "2"}]}
      }], GridBox[{
       {"0", "0"},
       {
        RowBox[{"1", "/", "2"}], "0"}
      }]},
    {" ", GridBox[{
       {
        RowBox[{"1", "/", "2"}], 
        RowBox[{"1", "/", "2"}]}
      }]}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"c358eb74-d202-4dbc-9b6b-4739f7b086e9"],
 "\t"
}], "Item",
 CellChangeTimes->{{3.876389464335832*^9, 3.8763897234563804`*^9}, {
  3.8763897737070036`*^9, 
  3.8763897851443624`*^9}},ExpressionUUID->"9f72fb84-a132-4510-9bc2-\
944c3e97f2e6"],

Cell[TextData[{
 "Ralston:\t",
 Cell[BoxData[GridBox[{
    {GridBox[{
       {"0"},
       {
        RowBox[{"2", "/", "3"}]}
      }], GridBox[{
       {"0", "0"},
       {
        RowBox[{"2", "/", "3"}], "0"}
      }]},
    {" ", GridBox[{
       {
        RowBox[{"1", "/", "4"}], 
        RowBox[{"3", "/", "4"}]}
      }]}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"7dd8abb3-331e-45b8-8093-5211bd65c85c"],
 "\t"
}], "Item",
 CellChangeTimes->{{3.876389464335832*^9, 3.876389684153989*^9}, {
  3.8763897163334928`*^9, 
  3.8763897554627647`*^9}},ExpressionUUID->"5f2169a2-0f80-453a-83f5-\
4e4f49493d93"],

Cell[TextData[{
 "Generic:\t",
 Cell[BoxData[GridBox[{
    {GridBox[{
       {"0"},
       {"\[Alpha]"}
      }], GridBox[{
       {"0", "0"},
       {"\[Alpha]", "0"}
      }]},
    {" ", GridBox[{
       {
        RowBox[{"1", "-", 
         FractionBox["1", 
          RowBox[{"2", "\[Alpha]"}]]}], 
        FractionBox["1", 
         RowBox[{"2", " ", "\[Alpha]"}]]}
      }]}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"cd345605-0196-4cb2-8863-a266f706850f"],
 "\t"
}], "Item",
 CellChangeTimes->{{3.876389464335832*^9, 3.876389684153989*^9}, {
  3.8763897163334928`*^9, 3.8763897554627647`*^9}, {3.8763897972813215`*^9, 
  3.8763898332615395`*^9}},ExpressionUUID->"da52854a-b3c0-464a-9721-\
9cad7c50a99c"],

Cell[TextData[{
 "Euler:\t\t",
 Cell[BoxData[GridBox[{
    {"1", "0"},
    {" ", "1"}
   },
   GridBoxDividers->{
    "Columns" -> {False, {True}, False}, "Rows" -> {False, {True}, False}}]],
  ExpressionUUID->"2e91543b-2849-456b-afa3-2404d2e438dc"],
 "\t"
}], "Item",
 CellChangeTimes->{{3.876389464335832*^9, 3.876389684153989*^9}, {
  3.8763897163334928`*^9, 3.8763897554627647`*^9}, {3.8763897972813215`*^9, 
  3.876389880616624*^9}},ExpressionUUID->"c9770862-70b6-4692-8873-\
e37db4fdfece"],

Cell[TextData[{
 "For now we are not going to worry about how folks worked these out.  What \
we want to work out is how well the schemes match Taylor Series for the \
solution of \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "'"}], "=", 
    RowBox[{"f", "(", "y", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e8a79a4d-d097-48af-afa9-7f88a88d8811"],
 "\nby differentiating the ODE.  I guess the first thing to do is implement \
these solvers"
}], "Text",
 CellChangeTimes->{{3.876389895649349*^9, 3.8763900743743267`*^9}, {
  3.8763902052896776`*^9, 
  3.876390212081104*^9}},ExpressionUUID->"3d1ac892-f43a-471d-8645-\
25de843dcf8f"],

Cell[CellGroupData[{

Cell["Simple Implementations", "Subsection",
 CellChangeTimes->{{3.876390084095075*^9, 3.87639009164399*^9}, {
  3.876390217045597*^9, 
  3.876390222512591*^9}},ExpressionUUID->"0a93ca51-c73a-49d5-a36a-\
1184d47bf152"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HeunStep", "[", "f_", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "t_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K1", ",", "K2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K1", "=", 
       RowBox[{"f", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K2", " ", "=", " ", 
       RowBox[{"f", "[", 
        RowBox[{"y", "+", 
         RowBox[{
          RowBox[{"h", "/", "2"}], " ", "K1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"h", ",", 
        RowBox[{"t", "+", "h"}], ",", 
        RowBox[{"y", "+", 
         RowBox[{"h", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", "K1"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", "K2"}]}], ")"}]}]}]}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MidpointStep", "[", "f_", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"h_", ",", "t_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K1", ",", "K2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K1", "=", 
      RowBox[{"f", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", " ", "=", " ", 
      RowBox[{"f", "[", 
       RowBox[{"y", "+", 
        RowBox[{
         RowBox[{"h", "/", "2"}], " ", "K1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"h", ",", 
       RowBox[{"t", "+", "h"}], ",", 
       RowBox[{"y", "+", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0", "*", " ", "K1"}], " ", "+", " ", "K2"}], ")"}]}]}]}], 
      "}"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876390093408796*^9, 3.8763902959480495`*^9}, {
  3.876390354260756*^9, 3.876390387357157*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"e6c02f29-6ec4-4786-aff6-d808f47ee0f1"],

Cell["\<\
The Taylor Series of the error tells us how good each of these schemes is. I \
am going to take this slowly with the MidPoint Method.\
\>", "Text",
 CellChangeTimes->{{3.876390398183998*^9, 3.8763904536726446`*^9}, {
  3.8763905151011095`*^9, 3.8763905230966043`*^9}, {3.8763913069344316`*^9, 
  3.8763913168521075`*^9}},ExpressionUUID->"386a9b2a-573c-4b75-8286-\
e82dc52f676e"],

Cell[CellGroupData[{

Cell["MidPoint Error Series", "Subsubsection",
 CellChangeTimes->{{3.8763918838157196`*^9, 
  3.876391896513669*^9}},ExpressionUUID->"21a13ff9-d6cd-4697-8db9-\
de760832e3f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MidPtError", "[", "h_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MidpointStep", "[", "f", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"h", ",", "0", ",", "y0"}], "}"}], "]"}], 
    "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "-", 
   RowBox[{"y", "[", "h", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.876390478740018*^9, 3.87639053657847*^9}, {
  3.876390568166319*^9, 3.876390595667718*^9}, {3.876390810464423*^9, 
  3.876390817728401*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e22029d9-1396-4514-a796-a4589e90a4dc"],

Cell[BoxData[
 RowBox[{"y0", "+", 
  RowBox[{"h", " ", 
   RowBox[{"f", "[", 
    RowBox[{"y0", "+", 
     RowBox[{
      FractionBox["1", "2"], " ", "h", " ", 
      RowBox[{"f", "[", "y0", "]"}]}]}], "]"}]}], "-", 
  RowBox[{"y", "[", "h", "]"}]}]], "Output",
 CellChangeTimes->{{3.8763904952834654`*^9, 3.8763905056045775`*^9}, 
   3.876390540610239*^9, {3.876390576899599*^9, 3.876390604566144*^9}, 
   3.8763908183060093`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"0f5b9bd2-dd38-41c8-bd56-f461a532dc28"]
}, Open  ]],

Cell["The computer can compute a Taylor Series for us", "Text",
 CellChangeTimes->{{3.876390685444302*^9, 3.8763906963092856`*^9}, {
  3.876390787616804*^9, 
  3.8763907984277*^9}},ExpressionUUID->"4a04c392-5365-4826-8f41-650c4103836e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TS", "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"MidPtError", "[", "h", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "0", ",", " ", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8763905488825912`*^9, 3.876390555914835*^9}, 
   3.876390601778723*^9, {3.876390824257004*^9, 3.8763908389556303`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"99f4faea-1ef4-43b0-a868-ef09b1b43905"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"y0", "-", 
     RowBox[{"y", "[", "0", "]"}]}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", "[", "y0", "]"}], "-", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}]}], ")"}], " ", "h"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "y0", "]"}], " ", 
       RowBox[{
        SuperscriptBox["f", "\[Prime]",
         MultilineFunction->None], "[", "y0", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "0", "]"}]}], ")"}], " ", 
    SuperscriptBox["h", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox[
        RowBox[{"f", "[", "y0", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "y0", "]"}]}], "-", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "0", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["h", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "h", "]"}], "4"],
    SeriesData[$CellContext`h, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`h, 
   0, {$CellContext`y0 - $CellContext`y[0], $CellContext`f[$CellContext`y0] - 
    Derivative[1][$CellContext`y][0], 
    Rational[1, 2] ($CellContext`f[$CellContext`y0] 
      Derivative[1][$CellContext`f][$CellContext`y0] - Derivative[
     2][$CellContext`y][0]), 
    Rational[1, 8] $CellContext`f[$CellContext`y0]^2 
     Derivative[2][$CellContext`f][$CellContext`y0] + 
    Rational[-1, 6] Derivative[3][$CellContext`y][0]}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8763905564924617`*^9, 3.8763905815640287`*^9}, 
   3.8763906120160437`*^9, 3.8763908394630756`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"dfa4e73e-5a10-4237-a279-4585f404f38a"]
}, Open  ]],

Cell["\<\
The first term is zero because of the initial condition. The second term is \
zero because of the ODE at the initial condition. The quadratic and cubic \
terms are less obvious.  \
\>", "Text",
 CellChangeTimes->{{3.876390701126241*^9, 3.8763907171000104`*^9}, {
   3.876390862319665*^9, 3.876391178847598*^9}, 
   3.8763913354721885`*^9},ExpressionUUID->"51a7cfef-665d-4a11-8fa4-\
559031afdd35"],

Cell[TextData[{
 "Differentiating  the ODE and evaluating at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bf62ab91-1105-40a7-a892-b320dd553bf3"],
 " gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], "[", "t", "]"}], "=", 
    RowBox[{"f", "[", 
     RowBox[{"y", "[", "t", "]"}], "]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "859a2fe1-9c63-44b2-b0e6-5596e66cf81b"],
 "\t\[DoubleLongRightArrow]  \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], "[", "t", "]"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["f", "y"], "[", 
      RowBox[{"y", "[", "t", "]"}], "]"}], 
     RowBox[{
      RowBox[{"y", "'"}], "[", "t", "]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "aa22fea2-06a9-4903-888e-fbb41230757b"],
 "\t\[DoubleLongRightArrow]  \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], "[", "0", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["f", "y"], "[", 
       SubscriptBox["y", "0"], "]"}], 
      RowBox[{
       RowBox[{"y", "'"}], "[", 
       SubscriptBox["t", "0"], "]"}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["f", "y"], "[", 
       SubscriptBox["y", "0"], "]"}], 
      RowBox[{"f", "[", 
       SubscriptBox["y", "0"], "]"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "475b72cc-70fc-484e-8497-dab216386bf9"],
 "\nThe quadratic terms is zero! "
}], "Text",
 CellChangeTimes->{{3.876390701126241*^9, 3.8763907171000104`*^9}, {
  3.876390862319665*^9, 3.876391178847598*^9}, {3.8763913516403704`*^9, 
  3.876391369298348*^9}},ExpressionUUID->"6efaa5e1-39d3-4c11-bb80-\
1272ad02a8ed"],

Cell[TextData[{
 "Differentiating  the ODE again and evaluating at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "095b2688-836e-4ce0-a61f-c0d96bdbae92"],
 " gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], "[", "t", "]"}], "=", 
    RowBox[{"f", "[", 
     RowBox[{"y", "[", "t", "]"}], "]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f3104d89-9e76-4fb2-8065-9e407489d2df"],
 "\t\[DoubleLongRightArrow]  \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], "[", "t", "]"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["f", "y"], "[", 
      RowBox[{"y", "[", "t", "]"}], "]"}], 
     RowBox[{
      RowBox[{"y", "'"}], "[", "t", "]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "01621441-e0c3-4e1f-a77b-f78a066b9249"],
 "\t\[DoubleLongRightArrow]  \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'''"}], "[", "t", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["f", "yy"], "[", 
       RowBox[{"y", "[", "t", "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "*", 
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{
       SubscriptBox["f", "y"], "[", 
       RowBox[{"y", "[", "t", "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"y", "''"}], "[", "t", "]"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e2852344-2327-4789-b2f0-f27949d2be98"],
 "\nEvaluating at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2c848d7b-8b6f-4835-a95d-0931735540a0"],
 " gives\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"y", "'''"}], "[", "0", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["f", "yy"], "[", 
        SubscriptBox["y", "0"], "]"}], "*", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "0", "]"}], "*", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "0", "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["f", "y"], "[", 
        SubscriptBox["y", "0"], "]"}], "*", 
       RowBox[{
        RowBox[{"y", "''"}], "[", "0", "]"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["f", "yy"], "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{"f", "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{"f", "[", 
         SubscriptBox["y", "0"], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["f", "y"], "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{
         RowBox[{"y", "''"}], "[", "0", "]"}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["f", "yy"], "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{"f", "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{"f", "[", 
         SubscriptBox["y", "0"], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SubscriptBox["f", "y"], "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{
         SubscriptBox["f", "y"], "[", 
         SubscriptBox["y", "0"], "]"}], "*", 
        RowBox[{"f", "[", 
         SubscriptBox["y", "0"], "]"}]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8609f431-a042-43ea-aefc-7b8ad7b0ac59"],
 "\nIt looks to me as though some (but not all) of the terms in the cubic \
match.  If we plug them in we get\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"MidPtError", "[", "h", "]"}], "=", 
    RowBox[{"0", "+", 
     RowBox[{"0", "*", "h"}], "+", 
     RowBox[{"0", "*", 
      SuperscriptBox["h", "2"]}], "+", " ", 
     RowBox[{Cell[TextData[Cell[BoxData[
       FormBox[
        RowBox[{"C", "(", 
         SubscriptBox["y", "0"], ")"}], TraditionalForm]],
       FormatType->TraditionalForm,ExpressionUUID->
       "af740928-7c38-49c1-aeff-c217e9285b04"]],ExpressionUUID->
       "d1c67e3d-ee13-48b6-aaad-3a4e0b74b924"], 
      SuperscriptBox["h", "3"]}], "+", " ", 
     RowBox[{"O", "(", 
      SuperscriptBox["h", "4"], ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f14e0724-efbf-43f0-b3f8-d4ceb0d88ecd"],
 "\nThe midpoint scheme is second order because it matches the Taylor series \
up to second order with a non-zero third order error term.  We can automate \
this!"
}], "Text",
 CellChangeTimes->{{3.876390701126241*^9, 3.8763907171000104`*^9}, {
  3.876390862319665*^9, 3.876391178847598*^9}, {3.8763913516403704`*^9, 
  3.876391451669705*^9}, {3.8763914835442777`*^9, 3.876391870655455*^9}, {
  3.8763919011306763`*^9, 3.8763919108291073`*^9}, {3.876392669211787*^9, 
  3.876392696430522*^9}},ExpressionUUID->"8e0e5673-98d6-465f-8708-\
5dfb30d77442"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"ODE", ",", "Subber", ",", "f", ",", "y", ",", "t"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ODE", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"f", "[", 
     RowBox[{"y", "[", "t", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"ODE", "[", 
       RowBox[{"n", "-", "1"}], "]"}], ",", "t"}], "]"}], "]"}], "//.", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ODE", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Subber", "[", "n_", "]"}], ":=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "->", "y0"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ODE", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", "->", "0"}], ",", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], "->", "y0"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{"Subber", "[", "3", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.876391980422613*^9, 3.8763921106498575`*^9}, {
  3.876392144438398*^9, 3.876392459340718*^9}, {3.8763924934062023`*^9, 
  3.876392512643191*^9}, {3.876392796923845*^9, 3.8763927976673923`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"6aef2f5b-af2b-437b-b5b4-b2afc54fb877"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"y", "[", "0", "]"}], "\[Rule]", "y0"}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "0", "]"}], "\[Rule]", 
       RowBox[{"f", "[", "y0", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["y", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "0", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", "y0", "]"}], " ", 
        RowBox[{
         SuperscriptBox["y", "\[Prime]",
          MultilineFunction->None], "[", "0", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "0", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"f", "[", "y0", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["f", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "y0", "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["f", "\[Prime]",
           MultilineFunction->None], "[", "y0", "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "0", "]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["y", 
         TagBox[
          RowBox[{"(", "4", ")"}],
          Derivative],
         MultilineFunction->None], "[", "0", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"f", "[", "y0", "]"}], "2"], " ", 
         RowBox[{
          SuperscriptBox["f", "\[Prime]",
           MultilineFunction->None], "[", "y0", "]"}], " ", 
         RowBox[{
          SuperscriptBox["f", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "y0", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"f", "[", "y0", "]"}], "3"], " ", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", "3", ")"}],
            Derivative],
           MultilineFunction->None], "[", "y0", "]"}]}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["f", "\[Prime]",
           MultilineFunction->None], "[", "y0", "]"}], " ", 
         RowBox[{
          SuperscriptBox["y", 
           TagBox[
            RowBox[{"(", "3", ")"}],
            Derivative],
           MultilineFunction->None], "[", "0", "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8763919915320206`*^9, 3.876392023699441*^9}, {
   3.8763920900129585`*^9, 3.87639211191479*^9}, {3.8763921462921295`*^9, 
   3.876392168414915*^9}, {3.8763922061664376`*^9, 3.8763922673146048`*^9}, {
   3.8763923163509884`*^9, 3.876392460258505*^9}, 3.87639251531413*^9, 
   3.8763927982141304`*^9},
 CellLabel->
  "Out[152]//TableForm=",ExpressionUUID->"b53452ad-9466-48b3-8783-\
28ac5b377109"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"MidPtError", "[", "h", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "0", ",", " ", "3"}], "}"}]}], "]"}], "//.", 
   RowBox[{"Subber", "[", "3", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763919195902014`*^9, 3.8763919616766663`*^9}, {
  3.8763927062766604`*^9, 3.8763927807916064`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"5b8f6b48-52cd-4c74-84b3-b9db27c478fa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", "24"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f", "[", "y0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["f", "\[Prime]",
             MultilineFunction->None], "[", "y0", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"f", "[", "y0", "]"}], " ", 
          RowBox[{
           SuperscriptBox["f", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "y0", "]"}]}]}], ")"}]}], ")"}], 
     " ", 
     SuperscriptBox["h", "3"]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "h", "]"}], "4"],
    SeriesData[$CellContext`h, 0, {}, 3, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`h, 0, {
   Rational[-1, 24] $CellContext`f[$CellContext`y0] (
     4 Derivative[
        1][$CellContext`f][$CellContext`y0]^2 + \
$CellContext`f[$CellContext`y0] 
      Derivative[2][$CellContext`f][$CellContext`y0])}, 3, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.8763919686097803`*^9, {3.876392722886763*^9, 3.8763928078107934`*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"ee05b725-1e54-4d38-a8d0-fb9bd63a3fc0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error and Order Discussion", "Subsubsection",
 CellChangeTimes->{{3.8763918838157196`*^9, 3.876391896513669*^9}, {
  3.876392833477807*^9, 3.8763928419215965`*^9}, {3.8763930465284777`*^9, 
  3.876393048798332*^9}},ExpressionUUID->"567634e6-38cd-4fc1-8a6b-\
4ad5792ab380"],

Cell["\<\
If you had a second order scheme and a third order scheme which took the same \
amount of work. You would use the third order scheme. However,  in the real \
world third order schemes are more work than second order schemes!  \
\>", "Text",
 CellChangeTimes->{{3.876392855813106*^9, 3.8763929333125525`*^9}, {
  3.876392983264612*^9, 3.876393076194826*^9}, {3.876393187362602*^9, 
  3.876393262197357*^9}},ExpressionUUID->"5fed5b83-cb2a-49f2-a244-\
e6ab9a9878dc"],

Cell["\<\
There are fourth, fifth, sixth, \[Ellipsis] order schemes that were harder \
for folks to find and take more work per step than lower order schemes.  \
\>", "Text",
 CellChangeTimes->{{3.876392855813106*^9, 3.8763929333125525`*^9}, {
  3.876392983264612*^9, 3.876393076194826*^9}, {3.876393187362602*^9, 
  3.8763932470532017`*^9}, {3.876393281890532*^9, 
  3.876393311354148*^9}},ExpressionUUID->"e9df17c0-63dd-4b06-9bcf-\
6c5f966572ba"],

Cell["\<\
One common general purpose solver is the Dormand Prince RK pair
\thttps://en.wikipedia.org/wiki/Dormand%E2%80%93Prince_method
which contains an order 4 and order 5 solver using the same internal steps. \
The error is controlled by keeping the difference between the solvers small \
at each step.  This is the default solver in matlab ode45, simulink, and \
Octave.  It is the selected for moderate precision non-stiff problems by \
Mathematica\[CloseCurlyQuote]s heuristics.  \
\>", "Text",
 CellChangeTimes->{{3.876392855813106*^9, 3.8763929333125525`*^9}, {
  3.876392983264612*^9, 3.876393076194826*^9}, {3.876393187362602*^9, 
  3.8763932470532017`*^9}, {3.876393281890532*^9, 3.876393352448733*^9}, {
  3.876393403898136*^9, 
  3.8763936804411325`*^9}},ExpressionUUID->"1ff2d20f-4e4c-4d8e-8c6f-\
605b26802d45"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{"RulerBar", "EditBar"},
WindowSize->{1141, 605},
WindowMargins->{{1463.5, Automatic}, {242.5, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c7978ad3-d634-4918-817c-0f0639ca2596"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 168, 3, 98, "Title",ExpressionUUID->"cfe02285-7314-4cf7-afc8-b2cfe098c8c5"],
Cell[CellGroupData[{
Cell[773, 29, 247, 4, 69, "Chapter",ExpressionUUID->"d6141ec4-7b22-4563-abc5-619cd38f3e36"],
Cell[1023, 35, 1720, 44, 127, "Text",ExpressionUUID->"f2a5fa57-86bc-4e20-b6a0-fba8bfcb25fc"],
Cell[CellGroupData[{
Cell[2768, 83, 233, 4, 67, "Section",ExpressionUUID->"23c9e758-370c-4cea-9850-b132f79b4c73"],
Cell[3004, 89, 2248, 68, 184, "Text",ExpressionUUID->"0ca66a3b-99b1-4f4d-920c-716efb9c1d5d"],
Cell[5255, 159, 171, 3, 35, "Text",ExpressionUUID->"f2f92ad0-0aed-484f-8294-6d6d1dd5f1bc"],
Cell[CellGroupData[{
Cell[5451, 166, 1365, 37, 124, "Input",ExpressionUUID->"4a31a1d9-0a4e-46a7-9dfa-c441d332c84b"],
Cell[6819, 205, 1268, 32, 52, "Output",ExpressionUUID->"1d9b0314-3617-4acd-a5da-53a64bd38f10"],
Cell[8090, 239, 1634, 42, 243, "Output",ExpressionUUID->"c5cd2a59-bace-4917-98c0-b4fa6c390d3d"]
}, Open  ]],
Cell[9739, 284, 556, 10, 58, "Text",ExpressionUUID->"9c9f4187-b15b-4799-8fab-619916f54d62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10332, 299, 373, 6, 67, "Section",ExpressionUUID->"9f85497e-0a25-4d0c-a92f-da594f2baf02"],
Cell[10708, 307, 3222, 103, 212, "Text",ExpressionUUID->"eb40bd3e-f6f4-438e-98a8-733e39cce0b2",
 InitializationCell->True],
Cell[13933, 412, 3278, 106, 160, "Text",ExpressionUUID->"fc704761-b0a4-44f4-a061-50970a93ff5a"],
Cell[17214, 520, 221, 4, 35, "Text",ExpressionUUID->"1db8daee-738e-4496-98d8-23265f3f9fe4"],
Cell[CellGroupData[{
Cell[17460, 528, 2244, 60, 183, "Input",ExpressionUUID->"30a662e8-9a11-4978-9d11-48670079c504"],
Cell[19707, 590, 1407, 33, 52, "Output",ExpressionUUID->"5b08c54b-062a-427e-8b69-27b16d678204"],
Cell[21117, 625, 1781, 43, 243, "Output",ExpressionUUID->"28c52614-f9a2-4667-ada6-ed8b357b6f94"]
}, Open  ]],
Cell[22913, 671, 228, 5, 35, "Text",ExpressionUUID->"4f957534-85f9-4023-89d0-559413617dd5"],
Cell[CellGroupData[{
Cell[23166, 680, 1815, 48, 124, "Input",ExpressionUUID->"d6d26731-d070-44fd-94c5-1445827d06a7"],
Cell[24984, 730, 1412, 33, 52, "Output",ExpressionUUID->"313a683e-77a7-4773-9c6a-f8490e1ba130"],
Cell[26399, 765, 1792, 44, 243, "Output",ExpressionUUID->"63cbfb66-34c0-4524-8a86-c9b83d197a4d"]
}, Open  ]],
Cell[28206, 812, 2924, 93, 155, "Text",ExpressionUUID->"5b556e97-b81d-466f-bfa2-2506dde0951f"],
Cell[CellGroupData[{
Cell[31155, 909, 1101, 32, 105, "Input",ExpressionUUID->"30df905d-daeb-4f37-b818-62699b093729"],
Cell[32259, 943, 378, 10, 32, "Output",ExpressionUUID->"81daaea4-4727-4383-9405-90db4376e6ad"],
Cell[32640, 955, 904, 30, 32, "Output",ExpressionUUID->"d662b1dd-b520-40ef-8fef-d1222c38a27d"],
Cell[33547, 987, 2238, 79, 35, "Output",ExpressionUUID->"b1c6996f-964f-4f0c-8419-84f30c74da9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35822, 1071, 475, 15, 54, "Subsection",ExpressionUUID->"cf7e6ed3-505e-4b1a-b2ce-cc6ff9746232"],
Cell[36300, 1088, 648, 18, 35, "Text",ExpressionUUID->"f7b9e2be-ce26-478d-94de-1440fc33d0d4"],
Cell[CellGroupData[{
Cell[36973, 1110, 1203, 34, 124, "Input",ExpressionUUID->"a658c606-46cd-456b-86d3-b0c160996f0a"],
Cell[38179, 1146, 295, 7, 32, "Output",ExpressionUUID->"2f8b722f-9494-4ac1-9ac1-a424af173abd"],
Cell[38477, 1155, 299, 7, 32, "Output",ExpressionUUID->"260bdae1-1b4a-4cb7-98d2-68427e1b6e82"],
Cell[38779, 1164, 340, 10, 32, "Output",ExpressionUUID->"eb17ea39-4d51-40f5-a835-b9b6dee7519a"]
}, Open  ]],
Cell[39134, 1177, 1436, 41, 89, "Text",ExpressionUUID->"e69222ec-08b1-484c-a3a4-83c418a7fa5e"],
Cell[40573, 1220, 255, 6, 35, "Text",ExpressionUUID->"c1194f03-f829-47f7-a874-5782f21082be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40865, 1231, 272, 4, 54, "Subsection",ExpressionUUID->"0325c303-24d6-46ed-8a1f-2c186e94a620"],
Cell[41140, 1237, 2966, 89, 189, "Text",ExpressionUUID->"e84d5063-7e8f-41c6-be5d-d41b4f69c517"],
Cell[44109, 1328, 335, 7, 35, "Text",ExpressionUUID->"a4e3c848-7ab9-4652-9b92-c1566a7f8715"],
Cell[44447, 1337, 608, 14, 35, "Text",ExpressionUUID->"969ddba0-36d1-4173-8da6-581cfebded46"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[45104, 1357, 468, 7, 53, "Section",ExpressionUUID->"dd0fc674-a039-4fc7-8554-9f5c824cf3ff"],
Cell[45575, 1366, 2847, 81, 219, "Text",ExpressionUUID->"b51b9dec-9e10-4570-b319-a044dc621912",
 InitializationCell->True],
Cell[48425, 1449, 1479, 32, 168, "Text",ExpressionUUID->"902b5e89-ec9a-4b8b-9941-91407fcddc0b"],
Cell[49907, 1483, 1580, 42, 166, "Text",ExpressionUUID->"23938b00-75bf-4a57-b3b1-ce71161a47f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51524, 1530, 506, 7, 67, "Section",ExpressionUUID->"41d06ba9-62b7-4273-997c-bea60eadc663"],
Cell[52033, 1539, 175, 3, 35, "Text",ExpressionUUID->"91343d8c-aaaf-4fc0-a747-7f52185c16ee"],
Cell[52211, 1544, 631, 24, 70, "Item",ExpressionUUID->"dd41ce07-78dd-46b9-9b5b-d3898441d61c"],
Cell[52845, 1570, 691, 26, 70, "Item",ExpressionUUID->"9f72fb84-a132-4510-9bc2-944c3e97f2e6"],
Cell[53539, 1598, 690, 26, 70, "Item",ExpressionUUID->"5f2169a2-0f80-453a-83f5-4e4f49493d93"],
Cell[54232, 1626, 792, 27, 77, "Item",ExpressionUUID->"da52854a-b3c0-464a-9721-9cad7c50a99c"],
Cell[55027, 1655, 495, 14, 49, "Item",ExpressionUUID->"c9770862-70b6-4692-8873-e37db4fdfece"],
Cell[55525, 1671, 683, 17, 81, "Text",ExpressionUUID->"3d1ac892-f43a-471d-8645-25de843dcf8f"],
Cell[CellGroupData[{
Cell[56233, 1692, 218, 4, 54, "Subsection",ExpressionUUID->"0a93ca51-c73a-49d5-a36a-1184d47bf152"],
Cell[56454, 1698, 2141, 62, 197, "Input",ExpressionUUID->"e6c02f29-6ec4-4786-aff6-d808f47ee0f1",
 InitializationCell->True],
Cell[58598, 1762, 388, 7, 35, "Text",ExpressionUUID->"386a9b2a-573c-4b75-8286-e82dc52f676e"],
Cell[CellGroupData[{
Cell[59011, 1773, 174, 3, 45, "Subsubsection",ExpressionUUID->"21a13ff9-d6cd-4697-8db9-de760832e3f8"],
Cell[CellGroupData[{
Cell[59210, 1780, 590, 14, 28, "Input",ExpressionUUID->"e22029d9-1396-4514-a796-a4589e90a4dc"],
Cell[59803, 1796, 510, 12, 48, "Output",ExpressionUUID->"0f5b9bd2-dd38-41c8-bd56-f461a532dc28"]
}, Open  ]],
Cell[60328, 1811, 236, 3, 35, "Text",ExpressionUUID->"4a04c392-5365-4826-8f41-650c4103836e"],
Cell[CellGroupData[{
Cell[60589, 1818, 433, 9, 28, "Input",ExpressionUUID->"99f4faea-1ef4-43b0-a868-ef09b1b43905"],
Cell[61025, 1829, 2204, 62, 48, "Output",ExpressionUUID->"dfa4e73e-5a10-4237-a279-4585f404f38a"]
}, Open  ]],
Cell[63244, 1894, 406, 8, 58, "Text",ExpressionUUID->"51a7cfef-665d-4a11-8fa4-559031afdd35"],
Cell[63653, 1904, 1828, 58, 82, "Text",ExpressionUUID->"6efaa5e1-39d3-4c11-bb80-1272ad02a8ed"],
Cell[65484, 1964, 4973, 149, 177, "Text",ExpressionUUID->"8e0e5673-98d6-465f-8708-5dfb30d77442"],
Cell[CellGroupData[{
Cell[70482, 2117, 1772, 51, 105, "Input",ExpressionUUID->"6aef2f5b-af2b-437b-b5b4-b2afc54fb877"],
Cell[72257, 2170, 3422, 102, 119, "Output",ExpressionUUID->"b53452ad-9466-48b3-8783-28ac5b377109"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75716, 2277, 493, 12, 28, "Input",ExpressionUUID->"5b8f6b48-52cd-4c74-84b3-b9db27c478fa"],
Cell[76212, 2291, 1298, 38, 48, "Output",ExpressionUUID->"ee05b725-1e54-4d38-a8d0-fb9bd63a3fc0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77559, 2335, 278, 4, 45, "Subsubsection",ExpressionUUID->"567634e6-38cd-4fc1-8a6b-4ad5792ab380"],
Cell[77840, 2341, 473, 8, 58, "Text",ExpressionUUID->"5fed5b83-cb2a-49f2-a244-e6ab9a9878dc"],
Cell[78316, 2351, 448, 8, 35, "Text",ExpressionUUID->"e9df17c0-63dd-4b06-9bcf-6c5f966572ba"],
Cell[78767, 2361, 825, 14, 104, "Text",ExpressionUUID->"1ff2d20f-4e4c-4d8e-8c6f-605b26802d45"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

